# auto-generated tests from julia-repl docstrings
using Test, Gapjm
function mytest(a::String,b::String)
  omit=a[end]==';'
  a=repr(MIME("text/plain"),eval(Meta.parse(a)),context=:limit=>true)
  if omit a="nothing" end
  a=replace(a,r" *(\n|$)"s=>s"\1")
  a=replace(a,r"\n$"s=>"")
  b=replace(b,r" *(\n|$)"s=>s"\1")
  b=replace(b,r"\n$"s=>"")
  i=1
  while i<=lastindex(a) && i<=lastindex(b) && a[i]==b[i]
    i=nextind(a,i)
  end
  if a!=b print("exec=$(repr(a[i:end]))\nmanl=$(repr(b[i:end]))\n") end
  a==b
end
@testset "Chars.jl" begin
@test mytest("W=coxgroup(:A,3)","A‚ÇÉ")
@test mytest("CharTable(W)","CharTable(H(G(1,1,4)))\n    ‚îÇ1111 211 22 31  4\n‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n1111‚îÇ   1  -1  1  1 -1\n211 ‚îÇ   3  -1 -1  .  1\n22  ‚îÇ   2   .  2 -1  .\n31  ‚îÇ   3   1 -1  . -1\n4   ‚îÇ   1   1  1  1  1")
@test mytest("W=coxgroup(:G,2)","G‚ÇÇ")
@test mytest("ct=CharTable(W)","CharTable(W(G2))\n     ‚îÇA‚ÇÄ AÃÉ‚ÇÅ A‚ÇÅ G‚ÇÇ A‚ÇÇ A‚ÇÅ+AÃÉ‚ÇÅ\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nœÜ‚ÇÅ‚Äö‚ÇÄ ‚îÇ 1  1  1  1  1     1\nœÜ‚ÇÅ‚Äö‚ÇÜ ‚îÇ 1 -1 -1  1  1     1\nœÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ‚îÇ 1  1 -1 -1  1    -1\nœÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ‚îÇ 1 -1  1 -1  1    -1\nœÜ‚ÇÇ‚Äö‚ÇÅ ‚îÇ 2  .  .  1 -1    -2\nœÜ‚ÇÇ‚Äö‚ÇÇ ‚îÇ 2  .  . -1 -1     2")
@test mytest("ct.charnames","6-element Array{String,1}:\n \"\\\\phi_{1,0}\"\n \"\\\\phi_{1,6}\"\n \"\\\\phi_{1,3}'\"\n \"\\\\phi_{1,3}''\"\n \"\\\\phi_{2,1}\"\n \"\\\\phi_{2,2}\"")
@test mytest("ct.classnames","6-element Array{String,1}:\n \"A_0\"\n \"\\\\tilde A_1\"\n \"A_1\"\n \"G_2\"\n \"A_2\"\n \"A_1+\\\\tilde A_1\"")
@test mytest("Chars.fakedegree(coxgroup(:A,2),[[2,1]],Pol(:q))","Pol{Cyc{Int64}}: q¬≤+q")
@test mytest("fakedegrees(coxgroup(:A,2),Pol(:q))","3-element Array{Pol,1}:\n q¬≥\n q¬≤+q\n 1")
@test mytest("charinfo(coxgroup(:G,2))[:charparams]","6-element Array{Array{Array{Int64,1},1},1}:\n [[1, 0]]\n [[1, 6]]\n [[1, 3, 1]]\n [[1, 3, 2]]\n [[2, 1]]\n [[2, 2]]")
@test mytest("charinfo(coxgroup(:D,4))[:positionId]","13")
@test mytest("charinfo(coxgroup(:D,4))[:positionDet]","4")
@test mytest("charinfo(coxgroup(:D,4))[:extRefl]","5-element Array{Int64,1}:\n 13\n 11\n  5\n  3\n  4")
@test mytest("charinfo(coxgroup(:D,4))[:b]","13-element Array{Int64,1}:\n  6\n  6\n  7\n 12\n  4\n  3\n  6\n  2\n  2\n  4\n  1\n  2\n  0")
@test mytest("charinfo(coxgroup(:D,4))[:B]","13-element Array{Int64,1}:\n 10\n 10\n 11\n 12\n  8\n  9\n 10\n  6\n  6\n  8\n  5\n  6\n  0")
@test mytest("charinfo(coxgroup(:D,4))[:a]","13-element Array{Int64,1}:\n  6\n  6\n  7\n 12\n  3\n  3\n  6\n  2\n  2\n  3\n  1\n  2\n  0")
@test mytest("charinfo(coxgroup(:D,4))[:A]","13-element Array{Int64,1}:\n 10\n 10\n 11\n 12\n  9\n  9\n 10\n  6\n  6\n  9\n  5\n  6\n  0")
@test mytest("charinfo(ComplexReflectionGroup(22))[:opdam]","(3,5)(4,6)(11,13)(12,14)(17,18)")
@test mytest("charinfo(coxgroup(:A,2))","Dict{Symbol,Any} with 9 entries:\n  :a           => [3, 1, 0]\n  :b           => [3, 1, 0]\n  :positionId  => 3\n  :charnames   => [\"111\", \"21\", \"3\"]\n  :A           => [3, 2, 0]\n  :B           => [3, 2, 0]\n  :extRefl     => [3, 2, 1]\n  :charparams  => Array{Array{Int64,1},1}[[[1, 1, 1]], [[2, 1]], [[3]]]\n  :positionDet => 1")
@test mytest("charinfo(coxgroup(:G,2))[:spaltenstein]","6-element Array{String,1}:\n \"1\"\n \"\\\\varepsilon\"\n \"\\\\varepsilon_l\"\n \"\\\\varepsilon_c\"\n \"\\\\theta'\"\n \"\\\\theta''\"")
@test mytest("classinfo(coxgroup(:A,2))","Dict{Symbol,Any} with 5 entries:\n  :classes     => [1, 3, 2]\n  :orders      => [1, 2, 3]\n  :classtext   => Array{Int64,1}[[], [1], [1, 2]]\n  :classnames  => [\"111\", \"21\", \"3\"]\n  :classparams => Array{Int64,1}[[1, 1, 1], [2, 1], [3]]")
@test mytest("representation(ComplexReflectionGroup(24),3)","3-element Array{Array{Cyc{Rational{Int64}},2},1}:\n [1 0 0; -1 -1 0; -1 0 -1]\n [-1 0 -1; 0 -1 (1-‚àö-7)/2; 0 0 1]\n [-1 -1 0; 0 1 0; 0 (1+‚àö-7)/2 -1]")
@test mytest("representations(coxgroup(:B,2))","5-element Array{Array{Array{Int64,2},1},1}:\n [[1], [-1]]\n [[1 0; -1 -1], [1 2; 0 -1]]\n [[-1], [-1]]\n [[1], [1]]\n [[-1], [1]]")
@test mytest("W=coxgroup(:G,2)","G‚ÇÇ")
@test mytest("charnames(W;limit=true)","6-element Array{String,1}:\n \"œÜ‚ÇÅ‚Äö‚ÇÄ\"\n \"œÜ‚ÇÅ‚Äö‚ÇÜ\"\n \"œÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ\"\n \"œÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ\"\n \"œÜ‚ÇÇ‚Äö‚ÇÅ\"\n \"œÜ‚ÇÇ‚Äö‚ÇÇ\"")
@test mytest("charnames(W;TeX=true)","6-element Array{String,1}:\n \"\\\\phi_{1,0}\"\n \"\\\\phi_{1,6}\"\n \"\\\\phi_{1,3}'\"\n \"\\\\phi_{1,3}''\"\n \"\\\\phi_{2,1}\"\n \"\\\\phi_{2,2}\"")
@test mytest("charnames(W;spaltenstein=true,limit=true)","6-element Array{String,1}:\n \"1\"\n \"Œµ\"\n \"Œµ‚Çó\"\n \"Œµ_c\"\n \"Œ∏‚Ä≤\"\n \"Œ∏‚Ä≥\"")
@test mytest("charnames(W;spaltenstein=true,TeX=true)","6-element Array{String,1}:\n \"1\"\n \"\\\\varepsilon\"\n \"\\\\varepsilon_l\"\n \"\\\\varepsilon_c\"\n \"\\\\theta'\"\n \"\\\\theta''\"")
@test mytest("g=coxgroup(:G,2)","G‚ÇÇ")
@test mytest("u=reflection_subgroup(g,[1,6])","G‚ÇÇ‚Çç‚ÇÅ‚ÇÖ‚Çé=A‚ÇÇ")
@test mytest("InductionTable(u,g)","Induction Table\n     ‚îÇ111 21 3\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nœÜ‚ÇÅ‚Äö‚ÇÄ ‚îÇ  .  . 1\nœÜ‚ÇÅ‚Äö‚ÇÜ ‚îÇ  1  . .\nœÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ‚îÇ  1  . .\nœÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ‚îÇ  .  . 1\nœÜ‚ÇÇ‚Äö‚ÇÅ ‚îÇ  .  1 .\nœÜ‚ÇÇ‚Äö‚ÇÇ ‚îÇ  .  1 .")
end
@testset "Cosets.jl" begin
@test mytest("W=coxgroup(:B,2)","B‚ÇÇ")
@test mytest("W=coxgroup(:Bsym,2)","Bsym‚ÇÇ")
@test mytest("spets(W,Perm(1,2))","¬≤Bsym‚ÇÇ")
@test mytest("CharTable(W)","CharTable(H(G(2,1,2)))\n   ‚îÇ11. 1.1 .11 2. .2\n‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n11.‚îÇ  1   1   1 -1 -1\n1.1‚îÇ  2   .  -2  .  .\n.11‚îÇ  1  -1   1 -1  1\n2. ‚îÇ  1   1   1  1  1\n.2 ‚îÇ  1  -1   1  1 -1")
@test mytest("W=coxgroup(:B,2)","B‚ÇÇ")
@test mytest("twistings(W,[1])","2-element Array{Gapjm.Cosets.FCC{Int16,Int64,Gapjm.Weyl.FCSG{Int16,Int64,PRSG{Int64,Int16}}},1}:\n AÃÉ‚ÇÅŒ¶‚ÇÅ\n AÃÉ‚ÇÅŒ¶‚ÇÇ")
@test mytest("twistings(W,[2])","2-element Array{Gapjm.Cosets.FCC{Int16,Int64,Gapjm.Weyl.FCSG{Int16,Int64,PRSG{Int64,Int16}}},1}:\n A‚ÇÅŒ¶‚ÇÇ\n A‚ÇÅŒ¶‚ÇÅ")
@test mytest("W=coxgroup(:B,2)","B‚ÇÇ")
@test mytest("twistings(W,[2,4])","2-element Array{Gapjm.Cosets.FCC{Int16,Int64,Gapjm.Weyl.FCSG{Int16,Int64,PRSG{Int64,Int16}}},1}:\n (A‚ÇÅA‚ÇÅ)\n A‚ÇÅ√óA‚ÇÅ")
end
@testset "CoxGroups.jl" begin
@test mytest("W=CoxSym(4)","ùîñ ‚ÇÑ")
@test mytest("p=W(1,3,2,1,3)","Perm{UInt8}: (1,4)")
@test mytest("word(W,p)","5-element Array{Int64,1}:\n 1\n 2\n 3\n 2\n 1")
@test mytest("word(W,longest(W))","6-element Array{Int64,1}:\n 1\n 2\n 1\n 3\n 2\n 1")
@test mytest("w0=longest(W)","Perm{UInt8}: (1,4)(2,3)")
@test mytest("length(W,w0)","6")
@test mytest("map(i->word(W,reflection(W,i)),1:nref(W))","6-element Array{Array{Int64,1},1}:\n [1]\n [2]\n [3]\n [1, 2, 1]\n [2, 3, 2]\n [1, 2, 3, 2, 1]")
@test mytest("[length(elements(W,i)) for i in 0:nref(W)]","7-element Array{Int64,1}:\n 1\n 3\n 5\n 6\n 5\n 3\n 1")
@test mytest("W=coxgroup(:A,3)","A‚ÇÉ")
@test mytest("w=perm\"(1,11)(3,10)(4,9)(5,7)(6,12)\"","(1,11)(3,10)(4,9)(5,7)(6,12)")
@test mytest("w in W","true")
@test mytest("word(W,w)","5-element Array{Int64,1}:\n 1\n 2\n 3\n 2\n 1")
@test mytest("W=coxgroup(:G,2)","G‚ÇÇ")
@test mytest("H=reflection_subgroup(W,[2,6])","G‚ÇÇ‚Çç‚ÇÇ‚ÇÜ‚Çé=AÃÉ‚ÇÅ√óA‚ÇÅ")
@test mytest("word.(Ref(W),Set(reduced.(Ref(H),elements(W))))","3-element Array{Array{Int64,1},1}:\n []\n [1, 2]\n [1]")
@test mytest("W=coxgroup(:G,2)","G‚ÇÇ")
@test mytest("H=reflection_subgroup(W,[2,6])","G‚ÇÇ‚Çç‚ÇÇ‚ÇÜ‚Çé=AÃÉ‚ÇÅ√óA‚ÇÅ")
@test mytest("[word(W,w) for S in reduced(H,W) for w in S]","3-element Array{Array{Int64,1},1}:\n []\n [1]\n [1, 2]")
end
@testset "CycPols.jl" begin
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("p=CycPol(q^25-q^24-2q^23-q^2+q+2)","(q-2)Œ¶‚ÇÅŒ¶‚ÇÇŒ¶‚ÇÇ‚ÇÉ")
@test mytest("p(q)","Pol{Cyc{Int64}}: q¬≤‚Åµ-q¬≤‚Å¥-2q¬≤¬≥-q¬≤+q+2")
@test mytest("p*inv(CycPol(q^2+q+1))","(q-2)Œ¶‚ÇÅŒ¶‚ÇÇŒ¶‚ÇÉ‚Åª¬πŒ¶‚ÇÇ‚ÇÉ")
end
@testset "Cycs.jl" begin
@test mytest("E(3)+E(4)","Œ∂‚ÇÅ‚ÇÇ‚Å¥-Œ∂‚ÇÅ‚ÇÇ‚Å∑-Œ∂‚ÇÅ‚ÇÇ¬π¬π")
@test mytest("E(3,2)","Œ∂‚ÇÉ¬≤")
@test mytest("1+E(3,2)","-Œ∂‚ÇÉ")
@test mytest("a=E(4)-E(4)","0")
@test mytest("conductor(a)","1")
@test mytest("typeof(convert(Int,a))","Int64")
@test mytest("c=inv(1+E(4))","1/2-Œ∂‚ÇÑ/2")
@test mytest("typeof(c)","Cyc{Rational{Int64}}")
@test mytest("typeof(1+E(4))","Cyc{Int64}")
@test mytest("Cyc(1+im)","1+Œ∂‚ÇÑ")
@test mytest("1//(1+E(4))","1/2-Œ∂‚ÇÑ/2")
@test mytest("typeof(Cyc(1//2))","Cyc{Rational{Int64}}")
@test mytest("conj(1+E(4))","1-Œ∂‚ÇÑ")
@test mytest("c=E(9)","-Œ∂‚Çâ‚Å¥-Œ∂‚Çâ‚Å∑")
@test mytest("Root1(c)","Root1(1//9)")
@test mytest("c=Complex(E(3))","-0.4999999999999998 + 0.8660254037844387im")
@test mytest("galois(1+E(4),-1)","1-Œ∂‚ÇÑ")
@test mytest("galois(ER(5),2)==-ER(5)","true")
@test mytest("ER(-1)","Œ∂‚ÇÑ")
@test mytest("ER(3)","‚àö3")
@test mytest("Quadratic(1+E(3))","(1+‚àö-3)/2")
@test mytest("Quadratic(1+E(5))","nothing")
end
@testset "families.jl" begin
@test mytest("HasType.Family(FamilyImprimitive([[0,1],[1],[0]]))","Family(0011:3)\nlabel‚îÇeigen      1         2         3\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n1    ‚îÇ  Œ∂‚ÇÉ¬≤  ‚àö-3/3    -‚àö-3/3     ‚àö-3/3\n2    ‚îÇ    1 -‚àö-3/3 (3-‚àö-3)/6 (3+‚àö-3)/6\n3    ‚îÇ    1  ‚àö-3/3 (3+‚àö-3)/6 (3-‚àö-3)/6")
@test mytest("HasType.FamiliesClassical(HasType.BDSymbols(3,1))","6-element Array{Family,1}:\n Family(01123:[1, 3, 8])\n Family(3:[9])\n Family(013:[5, 7, 10])\n Family(0112233:[4])\n Family(112:[2])\n Family(022:[6])")
end
@testset "Garside.jl" begin
@test mytest("W=coxgroup(:A,4)","A‚ÇÑ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(A‚ÇÑ)")
@test mytest("w=B(1,2,3,4)","1234")
@test mytest("w^3","121321432.343")
@test mytest("word(W,Œ±(w^3))","9-element Array{Int64,1}:\n 1\n 2\n 1\n 3\n 2\n 1\n 4\n 3\n 2")
@test mytest("w^4","Œ¥.232432")
@test mytest("inv(w)","(1234)‚Åª¬π")
@test mytest("repr(w^-1,context=IOContext(stdout,:greedy=>true,:limit=>true))","\"Œ¥‚Åª¬π.232432\"")
@test mytest("repr(w)","\"B(1,2,3,4)\"")
@test mytest("repr(w^3)","\"B(1,2,1,3,2,1,4,3,2,3,4,3)\"")
@test mytest("repr(w^-1)","\"B(-4,-3,-2,-1)\"")
@test mytest("b=B(2,1,4,1,4)","214.14")
@test mytest("c=B(1,4,1,4,3)","14.143")
@test mytest("d=representative_operation(b,c)","(1)‚Åª¬π21321432")
@test mytest("b^d","14.143")
@test mytest("centralizer_generators(b)","3-element Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1}:\n 21.1\n 321432.213243\n 4")
@test mytest("C=conjcat(b,:ss)","category with 10 objects and 32 generating maps")
@test mytest("C.obj","10-element Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1}:\n 1214.4\n 214.14\n 124.24\n 1343.1\n 14.124\n 143.13\n 24.214\n 134.14\n 13.134\n 14.143")
@test mytest("word(W,preferred_prefix(b))","2-element Array{Int64,1}:\n 2\n 1")
@test mytest("b^B(preferred_prefix(b))","1214.4")
@test mytest("b1=b^B(preferred_prefix(b))","1214.4")
@test mytest("C=conjcat(b)","category with 2 objects and 6 generating maps")
@test mytest("C.obj","2-element Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1}:\n 1214.4\n 1343.1")
@test mytest("W=coxgroup(:A,3)","A‚ÇÉ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(A‚ÇÉ)")
@test mytest("pi=B(B.delta)^2","Œ¥¬≤")
@test mytest("root(pi,2)","Œ¥")
@test mytest("root(pi,3)","1232")
@test mytest("root(pi,4)","132")
@test mytest("W=coxgroup(:A,3)","A‚ÇÉ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(A‚ÇÉ)")
@test mytest("map(x->B.(x),Garside.left_divisors(B,W(1,3,2)))","4-element Array{Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1},1}:\n [.]\n [1, 3]\n [13]\n [132]")
@test mytest("B=DualBraidMonoid(W)","DualBraidMonoid(A‚ÇÉ,c=[1, 3, 2])")
@test mytest("map(x->B.(x),Garside.left_divisors(B,W(1,3,2)))","4-element Array{Array{Gapjm.Garside.GarsideElm{Perm{Int16},DualBraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1},1}:\n [.]\n [1, 2, 3, 4, 5, 6]\n [12, 13, 15, 25, 34, 45]\n [Œ¥]")
@test mytest("W=coxgroup(:A,3)","A‚ÇÉ")
@test mytest("B=DualBraidMonoid(W)","DualBraidMonoid(A‚ÇÉ,c=[1, 3, 2])")
@test mytest("B(2,1,2,1,1)","12.1.1.1")
@test mytest("B(-1,-2,-3,1,1)","(25.1)‚Åª¬π1.1")
@test mytest("B=BraidMonoid(coxgroup(:A,3))","BraidMonoid(A‚ÇÉ)")
@test mytest("b=B( 2, 1, -3, 1, 1)","(23)‚Åª¬π321.1.1")
@test mytest("fraction(b)","(23, 321.1.1)")
@test mytest("W=coxgroup(:A,3)","A‚ÇÉ")
@test mytest("b=BraidMonoid(W)(2,1,2,1,1)","121.1.1")
@test mytest("word(W,Œ±(b))","3-element Array{Int64,1}:\n 1\n 2\n 1")
@test mytest("B=BraidMonoid(coxgroup(:A,3))","BraidMonoid(A‚ÇÉ)")
@test mytest("b=B(2,1,2,1,1)*inv(B(2,2))","(21)‚Åª¬π1.12.21")
@test mytest("word(b)","7-element Array{Int64,1}:\n -1\n -2\n  1\n  1\n  2\n  2\n  1")
@test mytest("W=coxgroup(:A,4)","A‚ÇÑ")
@test mytest("w=BraidMonoid(W)(4,3,3,2,1)","43.321")
@test mytest("conjcat(w)","category with 2 objects and 4 generating maps")
@test mytest("conjcat(w).obj","2-element Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1}:\n 32143\n 21324")
@test mytest("conjcat(w,:ss).obj","4-element Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1}:\n 32143\n 13243\n 21432\n 21324")
@test mytest("W=coxgroup(:D,4)","D‚ÇÑ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(D‚ÇÑ)")
@test mytest("b=B(2,3,1,2,4,3);b1=B(1,4,3,2,2,2)","1432.2.2")
@test mytest("representative_operation(b,b1)","(134312.23)‚Åª¬π")
@test mytest("c=representative_operation(b,b1,:cyc)","232.2")
@test mytest("b^c","1432.2.2")
@test mytest("WF=spets(W,Perm(1,2,4))","¬≥D‚ÇÑ")
@test mytest("F=Frobenius(WF)","(::Gapjm.Cosets.var\"#f#15\"{Gapjm.Cosets.FCC{Int16,Int64,Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}}) (generic function with 2 methods)")
@test mytest("c=B(3,4,3,3,2,4)","343.324")
@test mytest("representative_operation(b,c,:sc,F)","2312")
@test mytest("^(b,B(2,3,1,2),F)","343.324")
@test mytest("W=coxgroup(:D,4)","D‚ÇÑ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(D‚ÇÑ)")
@test mytest("w=B(4,4,4)","4.4.4")
@test mytest("cc=centralizer_generators(w)","8-element Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1}:\n (31432)‚Åª¬π231432\n 1\n (2)‚Åª¬π34.432\n (1)‚Åª¬π34.431\n 34.43\n 4\n (32431)‚Åª¬π132431\n 2")
@test mytest("shrink(cc)","5-element Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1}:\n 4\n 2\n 1\n 34.43\n (3243)‚Åª¬π13243")
@test mytest("centralizer_generators(w,:cyc)","Set(Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}}[4])")
@test mytest("F=Frobenius(spets(W,Perm(1,2,4)))","(::Gapjm.Cosets.var\"#f#15\"{Gapjm.Cosets.FCC{Int16,Int64,Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}}) (generic function with 2 methods)")
@test mytest("centralizer_generators(w,:sc,F)","2-element Array{Gapjm.Garside.GarsideElm{Perm{Int16},BraidMonoid{Perm{Int16},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}},1}:\n 124\n 312343123")
@test mytest("B=BraidMonoid(CoxSym(3))","BraidMonoid(ùîñ ‚ÇÉ)")
@test mytest("b=[B(1)^3,B(2)^3,B(-2,-1,-1,2,2,2,2,1,1,2),B(1,1,1,2)]","4-element Array{Gapjm.Garside.GarsideElm{Perm{UInt8},BraidMonoid{Perm{UInt8},CoxSym{UInt8}}},1}:\n 1.1.1\n 2.2.2\n (1.12)‚Åª¬π2.2.2.21.12\n 1.1.12")
@test mytest("shrink(b)","2-element Array{Gapjm.Garside.GarsideElm{Perm{UInt8},BraidMonoid{Perm{UInt8},CoxSym{UInt8}}},1}:\n 2\n 1")
end
@testset "GLinearAlgebra.jl" begin
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("M=[q^6 q^0 q^3 q^3 q^5+q q^4+q^2; q^0 q^6 q^3 q^3 q^5+q q^4+q^2; q^3 q^3 q^6 q^0 q^4+q^2 q^5+q; q^3 q^3 q^0 q^6 q^4+q^2 q^5+q; q^5+q q^5+q q^4+q^2 q^4+q^2 q^6+q^4+q^2+1 q^5+2*q^3+q; q^4+q^2 q^4+q^2 q^5+q q^5+q q^5+2*q^3+q q^6+q^4+q^2+1]","6√ó6 Array{Pol{Int64},2}:\n q‚Å∂     1      q¬≥     q¬≥     q‚Åµ+q        q‚Å¥+q¬≤\n 1      q‚Å∂     q¬≥     q¬≥     q‚Åµ+q        q‚Å¥+q¬≤\n q¬≥     q¬≥     q‚Å∂     1      q‚Å¥+q¬≤       q‚Åµ+q\n q¬≥     q¬≥     1      q‚Å∂     q‚Å¥+q¬≤       q‚Åµ+q\n q‚Åµ+q   q‚Åµ+q   q‚Å¥+q¬≤  q‚Å¥+q¬≤  q‚Å∂+q‚Å¥+q¬≤+1  q‚Åµ+2q¬≥+q\n q‚Å¥+q¬≤  q‚Å¥+q¬≤  q‚Åµ+q   q‚Åµ+q   q‚Åµ+2q¬≥+q    q‚Å∂+q‚Å¥+q¬≤+1")
@test mytest("bb=[[2],[4],[6],[3,5],[1]];","nothing")
@test mytest("(P,L)=Ucl.BigCellDecomposition(M,bb);","nothing")
@test mytest("P","6√ó6 Array{Pol{Int64},2}:\n 1    0  0    0    0        0\n q‚Åª‚Å∂  1  q‚Åª¬≥  q‚Åª¬≥  q‚Åª¬π+q‚Åª‚Åµ  q‚Åª¬≤+q‚Åª‚Å¥\n 0    0  1    0    0        0\n q‚Åª¬≥  0  0    1    q‚Åª¬≤      q‚Åª¬π\n q‚Åª¬π  0  0    0    1        0\n q‚Åª¬≤  0  q‚Åª¬π  0    q‚Åª¬π      1")
@test mytest("L","6√ó6 Array{Pol{Int64},2}:\n q‚Å∂-q‚Å¥-1+q‚Åª¬≤  0   0            0     0            0\n 0            q‚Å∂  0            0     0            0\n 0            0   q‚Å∂-q‚Å¥-1+q‚Åª¬≤  0     0            0\n 0            0   0            q‚Å∂-1  0            0\n 0            0   0            0     q‚Å∂-q‚Å¥-1+q‚Åª¬≤  0\n 0            0   0            0     0            q‚Å∂-1")
@test mytest("M==permutedims(P)*L*P","true")
end
@testset "Groups.jl" begin
@test mytest("G=Group([Perm(1,2),Perm(1,2,3)])","Group([perm\"(1,2)\",perm\"(1,2,3)\"])")
@test mytest("gens(G)","2-element Array{Perm{Int16},1}:\n (1,2)\n (1,2,3)")
@test mytest("nbgens(G)","2")
@test mytest("G(2,1,-2)","(1,3)")
@test mytest("orbit([Perm(1,2),Perm(2,3)],1)","3-element Array{Int64,1}:\n 1\n 2\n 3")
@test mytest("G=Group([Perm(1,2),Perm(2,3)]);","nothing")
@test mytest("orbit(G,1)","3-element Array{Int64,1}:\n 1\n 2\n 3")
@test mytest("G=Group([Perm(1,2),Perm(2,3)]);","nothing")
@test mytest("transversal(G,1)","Dict{Int64,Perm{Int16}} with 3 entries:\n  2 => (1,2)\n  3 => (1,3,2)\n  1 => ()")
@test mytest("transversal(G,[1,2],action=(x,y)->x.^y)","Dict{Array{Int64,1},Perm{Int16}} with 6 entries:\n  [1, 3] => (2,3)\n  [1, 2] => ()\n  [2, 3] => (1,2,3)\n  [3, 2] => (1,3)\n  [2, 1] => (1,2)\n  [3, 1] => (1,3,2)")
@test mytest("G=Group([Perm(1,2),Perm(2,3)]);","nothing")
@test mytest("orbits(G,1:4)","2-element Array{Array{Int64,1},1}:\n [1, 2, 3]\n [4]")
@test mytest("G=Group([Perm(1,2),Perm(1,2,3)]);","nothing")
@test mytest("centralizer(G,1)","Group([perm\"(2,3)\"])")
@test mytest("G=Group([Perm(1,2),Perm(1,2,3)]);","nothing")
@test mytest("minimal_words(G)","Dict{Perm{Int16},Array{Int64,1}} with 6 entries:\n  ()      => Int64[]\n  (2,3)   => [2, 1]\n  (1,3,2) => [1, 2, 1]\n  (1,3)   => [1, 2]\n  (1,2)   => [1]\n  (1,2,3) => [2]")
end
@testset "Hecke.jl" begin
@test mytest("W=coxgroup(:A,2)","A‚ÇÇ")
@test mytest("H=hecke(W,0)","Hecke(A‚ÇÇ,0)")
@test mytest("T=Tbasis(H);","nothing")
@test mytest("el=words(W)","6-element Array{Array{Int8,1},1}:\n []\n [2]\n [1]\n [2, 1]\n [1, 2]\n [1, 2, 1]")
@test mytest("T.(el)*permutedims(T.(el))","6√ó6 Array{HeckeTElt{Perm{Int16},Int64,Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}},2}:\n T.    T‚ÇÇ     T‚ÇÅ     T‚ÇÇ‚ÇÅ    T‚ÇÅ‚ÇÇ    T‚ÇÅ‚ÇÇ‚ÇÅ\n T‚ÇÇ    -T‚ÇÇ    T‚ÇÇ‚ÇÅ    -T‚ÇÇ‚ÇÅ   T‚ÇÅ‚ÇÇ‚ÇÅ   -T‚ÇÅ‚ÇÇ‚ÇÅ\n T‚ÇÅ    T‚ÇÅ‚ÇÇ    -T‚ÇÅ    T‚ÇÅ‚ÇÇ‚ÇÅ   -T‚ÇÅ‚ÇÇ   -T‚ÇÅ‚ÇÇ‚ÇÅ\n T‚ÇÇ‚ÇÅ   T‚ÇÅ‚ÇÇ‚ÇÅ   -T‚ÇÇ‚ÇÅ   -T‚ÇÅ‚ÇÇ‚ÇÅ  -T‚ÇÅ‚ÇÇ‚ÇÅ  T‚ÇÅ‚ÇÇ‚ÇÅ\n T‚ÇÅ‚ÇÇ   -T‚ÇÅ‚ÇÇ   T‚ÇÅ‚ÇÇ‚ÇÅ   -T‚ÇÅ‚ÇÇ‚ÇÅ  -T‚ÇÅ‚ÇÇ‚ÇÅ  T‚ÇÅ‚ÇÇ‚ÇÅ\n T‚ÇÅ‚ÇÇ‚ÇÅ  -T‚ÇÅ‚ÇÇ‚ÇÅ  -T‚ÇÅ‚ÇÇ‚ÇÅ  T‚ÇÅ‚ÇÇ‚ÇÅ   T‚ÇÅ‚ÇÇ‚ÇÅ   -T‚ÇÅ‚ÇÇ‚ÇÅ")
@test mytest("W=coxgroup(:B,2)","B‚ÇÇ")
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("H=hecke(W,q)","Hecke(B‚ÇÇ,q)")
@test mytest("H.para","2-element Array{Array{Pol{Int64},1},1}:\n [q, -1]\n [q, -1]")
@test mytest("H=hecke(W,q^2,rootpara=q)","Hecke(B‚ÇÇ,q¬≤,rootpara=q)")
@test mytest("[H.para,rootpara(H)]","2-element Array{Array{T,1} where T,1}:\n Array{Pol{Int64},1}[[q¬≤, -1], [q¬≤, -1]]\n Pol{Int64}[q, q]")
@test mytest("H=hecke(W,[q^2,q^4],rootpara=[q,q^2])","Hecke(B‚ÇÇ,Pol{Int64}[q¬≤, q‚Å¥],rootpara=Pol{Int64}[q, q¬≤])")
@test mytest("[H.para,rootpara(H)]","2-element Array{Array{T,1} where T,1}:\n Array{Pol{Int64},1}[[q¬≤, -1], [q‚Å¥, -1]]\n Pol{Int64}[q, q¬≤]")
@test mytest("H=hecke(W,9,rootpara=3)","Hecke(B‚ÇÇ,9,rootpara=3)")
@test mytest("[H.para,rootpara(H)]","2-element Array{Array{T,1} where T,1}:\n Array{Int64,1}[[9, -1], [9, -1]]\n [3, 3]")
end
@testset "KL.jl" begin
@test mytest("W=coxgroup(:H,3)","H‚ÇÉ")
@test mytest("c=LeftCells(W)","22-element Array{LeftCell{Gapjm.Weyl.FCG{Int16,Cyc{Int64},PRG{Cyc{Int64},Int16}}},1}:\n LeftCell<H‚ÇÉ: duflo= character=œÜ‚ÇÅ‚Äö‚ÇÄ>\n LeftCell<H‚ÇÉ: duflo=123 character=œÜ‚ÇÅ‚Äö‚ÇÅ‚ÇÖ>\n LeftCell<H‚ÇÉ: duflo=(15) character=œÜ‚ÇÖ‚Äö‚ÇÖ>\n LeftCell<H‚ÇÉ: duflo=(10) character=œÜ‚ÇÖ‚Äö‚ÇÖ>\n LeftCell<H‚ÇÉ: duflo=(14) character=œÜ‚ÇÖ‚Äö‚ÇÖ>\n LeftCell<H‚ÇÉ: duflo=7 character=œÜ‚ÇÖ‚Äö‚ÇÖ>\n LeftCell<H‚ÇÉ: duflo=(12) character=œÜ‚ÇÖ‚Äö‚ÇÖ>\n LeftCell<H‚ÇÉ: duflo=(9,12) character=œÜ‚ÇÖ‚Äö‚ÇÇ>\n LeftCell<H‚ÇÉ: duflo=(5,11) character=œÜ‚ÇÖ‚Äö‚ÇÇ>\n LeftCell<H‚ÇÉ: duflo=13 character=œÜ‚ÇÖ‚Äö‚ÇÇ>\n ‚ãÆ\n LeftCell<H‚ÇÉ: duflo=(8,13) character=œÜ‚ÇÉ‚Äö‚ÇÜ+œÜ‚ÇÉ‚Äö‚Çà>\n LeftCell<H‚ÇÉ: duflo=(1,15) character=œÜ‚ÇÉ‚Äö‚ÇÜ+œÜ‚ÇÉ‚Äö‚Çà>\n LeftCell<H‚ÇÉ: duflo=3 character=œÜ‚ÇÉ‚Äö‚ÇÅ+œÜ‚ÇÉ‚Äö‚ÇÉ>\n LeftCell<H‚ÇÉ: duflo=2 character=œÜ‚ÇÉ‚Äö‚ÇÅ+œÜ‚ÇÉ‚Äö‚ÇÉ>\n LeftCell<H‚ÇÉ: duflo=1 character=œÜ‚ÇÉ‚Äö‚ÇÅ+œÜ‚ÇÉ‚Äö‚ÇÉ>\n LeftCell<H‚ÇÉ: duflo=6 character=œÜ‚ÇÑ‚Äö‚ÇÉ+œÜ‚ÇÑ‚Äö‚ÇÑ>\n LeftCell<H‚ÇÉ: duflo=(13) character=œÜ‚ÇÑ‚Äö‚ÇÉ+œÜ‚ÇÑ‚Äö‚ÇÑ>\n LeftCell<H‚ÇÉ: duflo=(11) character=œÜ‚ÇÑ‚Äö‚ÇÉ+œÜ‚ÇÑ‚Äö‚ÇÑ>\n LeftCell<H‚ÇÉ: duflo=9 character=œÜ‚ÇÑ‚Äö‚ÇÉ+œÜ‚ÇÑ‚Äö‚ÇÑ>")
@test mytest("W=coxgroup(:F,4)","F‚ÇÑ")
@test mytest("w=longest(W)*gens(W)[1];length(W,w)","23")
@test mytest("y=W(1:4...);length(W,y)","4")
@test mytest("cr=KL.critical_pair(W,y,w);length(W,cr)","16")
@test mytest("Pol(:x);KLPol(W,y,w)","Pol{Int64}: x¬≥+1")
@test mytest("KLPol(W,cr,w)","Pol{Int64}: x¬≥+1")
@test mytest("W=coxgroup(:B,3)","B‚ÇÉ")
@test mytest("map(i->map(x->KLPol(W,one(W),x),elements(W,i)),1:W.N)","9-element Array{Array{Pol{Int64},1},1}:\n [1, 1, 1]\n [1, 1, 1, 1, 1]\n [1, 1, 1, 1, 1, 1, 1]\n [1, 1, 1, x+1, 1, 1, 1, 1]\n [x+1, 1, 1, x+1, x+1, 1, x+1, 1]\n [1, x+1, 1, x+1, x+1, x¬≤+1, 1]\n [x+1, x+1, x¬≤+x+1, 1, 1]\n [x¬≤+1, x+1, 1]\n [1]")
@test mytest("W=coxgroup(:B,3)","B‚ÇÉ")
@test mytest("Pol(:v);H=hecke(W,v^2,rootpara=v)","Hecke(B‚ÇÉ,v¬≤,rootpara=v)")
@test mytest("C=Cpbasis(H)","(::Gapjm.KL.var\"#f#10\"{Pol{Int64},Perm{Int16},HeckeAlgebra{Pol{Int64},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}}) (generic function with 4 methods)")
@test mytest("T=Tbasis(H)","(::Gapjm.Hecke.var\"#f#25\"{Pol{Int64},Perm{Int16},HeckeAlgebra{Pol{Int64},Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}}}) (generic function with 4 methods)")
@test mytest("T(C(1,2))","v‚Åª¬≤T.+v‚Åª¬≤T‚ÇÇ+v‚Åª¬≤T‚ÇÅ+v‚Åª¬≤T‚ÇÅ‚ÇÇ")
@test mytest("c=LeftCells(coxgroup(:G,2))[3]","LeftCell<G‚ÇÇ: duflo=2 character=œÜ‚ÇÇ‚Äö‚ÇÅ+œÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ+œÜ‚ÇÇ‚Äö‚ÇÇ>")
@test mytest("KL.character(c)","3-element Array{Int64,1}:\n 3\n 5\n 6")
@test mytest("W=coxgroup(:H,3)","H‚ÇÉ")
@test mytest("c=LeftCells(W)[3]","LeftCell<H‚ÇÉ: duflo=(15) character=œÜ‚ÇÖ‚Äö‚ÇÖ>")
@test mytest("Pol(:q);H=hecke(W,q^2;rootpara=q)","Hecke(H‚ÇÉ,q¬≤,rootpara=q)")
@test mytest("representation(c,H)","3-element Array{Array{Array{Pol{Int64},1},1},1}:\n [[-1, 0, 0, q, 0], [0, -1, 0, q, q], [0, 0, -1, 0, q], [0, 0, 0, q¬≤, 0], [0, 0, 0, 0, q¬≤]]\n [[-1, 0, q, 0, 0], [0, q¬≤, 0, 0, 0], [0, 0, q¬≤, 0, 0], [0, q, 0, -1, 0], [0, q, q, 0, -1]]\n [[q¬≤, 0, 0, 0, 0], [0, -1, 0, q, 0], [q, 0, -1, 0, 0], [0, 0, 0, q¬≤, 0], [0, 0, 0, q, -1]]")
@test mytest("W=coxgroup(:G,2)","G‚ÇÇ")
@test mytest("LeftCells(W)","4-element Array{LeftCell{Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}},1}:\n LeftCell<G‚ÇÇ: duflo= character=œÜ‚ÇÅ‚Äö‚ÇÄ>\n LeftCell<G‚ÇÇ: duflo=12 character=œÜ‚ÇÅ‚Äö‚ÇÜ>\n LeftCell<G‚ÇÇ: duflo=2 character=œÜ‚ÇÇ‚Äö‚ÇÅ+œÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ+œÜ‚ÇÇ‚Äö‚ÇÇ>\n LeftCell<G‚ÇÇ: duflo=1 character=œÜ‚ÇÇ‚Äö‚ÇÅ+œÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ+œÜ‚ÇÇ‚Äö‚ÇÇ>")
@test mytest("W=coxgroup(:G,2);","nothing")
@test mytest("LeftCells(W,1)","2-element Array{LeftCell{Gapjm.Weyl.FCG{Int16,Int64,PRG{Int64,Int16}}},1}:\n LeftCell<G‚ÇÇ: duflo=2 character=œÜ‚ÇÇ‚Äö‚ÇÅ+œÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ+œÜ‚ÇÇ‚Äö‚ÇÇ>\n LeftCell<G‚ÇÇ: duflo=1 character=œÜ‚ÇÇ‚Äö‚ÇÅ+œÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ+œÜ‚ÇÇ‚Äö‚ÇÇ>")
@test mytest("W=coxgroup(:E,8)","E‚Çà")
@test mytest("LeftCell(W,W((1:8)...))","LeftCell<E‚Çà: duflo=(42,43) character=œÜ‚ÇÉ‚ÇÖ‚Äö‚ÇÇ>")
end
@testset "ModuleElts.jl" begin
@test mytest("a=ModuleElt(:xy=>1,:yx=>-1)",":xy-:yx")
@test mytest("a-a","0")
@test mytest("a*99","99:xy-99:yx")
@test mytest("push!(a,:yy=>2)",":xy-:yx+2:yy")
@test mytest("a+ModuleElt(:yx=>1)",":xy+2:yy")
@test mytest("a[:xy]","1")
@test mytest("haskey(a,:xx)","false")
@test mytest("a=ModuleElt(:yy=>1, :yx=>2, :xy=>3, :yy=>-1)",":yy+2:yx+3:xy-:yy")
@test mytest("a=ModuleElt([:yy=>1, :yx=>2, :xy=>3, :yy=>-1];check=true)","3:xy+2:yx")
@test mytest("a","3:xy+2:yx")
end
@testset "Mvps.jl" begin
@test mytest("@Mvp x,y","nothing")
@test mytest("(x+y)^3","Mvp{Int64}: x¬≥+3x¬≤y+3xy¬≤+y¬≥")
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("Mvp(q^2+q)","Mvp{Int64}: q¬≤+q")
@test mytest("degree(Mvp(1))","0")
@test mytest("(x^2-y^2)//(x-y)","Mvp{Int64}: x+y")
@test mytest("a=x^2+x*y","Mvp{Int64}: x¬≤+xy")
@test mytest("degree(a)","2")
@test mytest("degree(a,:y)","1")
@test mytest("degree(a,:x)","2")
@test mytest("a=x^2+x*y","Mvp{Int64}: x¬≤+xy")
@test mytest("valuation(a)","2")
@test mytest("valuation(a,:y)","0")
@test mytest("valuation(a,:x)","1")
@test mytest("p=(x+y+inv(y))^4","Mvp{Int64}: x‚Å¥+4x¬≥y+4x¬≥y‚Åª¬π+6x¬≤y¬≤+12x¬≤+6x¬≤y‚Åª¬≤+4xy¬≥+12xy+12xy‚Åª¬π+4xy‚Åª¬≥+y‚Å¥+4y¬≤+6+4y‚Åª¬≤+y‚Åª‚Å¥")
@test mytest("coefficients(p,:x)","Dict{Int64,Mvp{Int64}} with 5 entries:\n  0 => y‚Å¥+4y¬≤+6+4y‚Åª¬≤+y‚Åª‚Å¥\n  4 => 1\n  2 => 6y¬≤+12+6y‚Åª¬≤\n  3 => 4y+4y‚Åª¬π\n  1 => 4y¬≥+12y+12y‚Åª¬π+4y‚Åª¬≥")
@test mytest("coefficients(p,:y)","Dict{Int64,Mvp{Int64}} with 9 entries:\n  0  => x‚Å¥+12x¬≤+6\n  4  => 1\n  -4 => 1\n  -3 => 4x\n  2  => 6x¬≤+4\n  -2 => 6x¬≤+4\n  -1 => 4x¬≥+12x\n  3  => 4x\n  1  => 4x¬≥+12x")
@test mytest("variables(x+x^4+y)","2-element Array{Symbol,1}:\n :x\n :y")
@test mytest("p=-2+7x^5*inv(y)","Mvp{Int64}: 7x‚Åµy‚Åª¬π-2")
@test mytest("p(x=2)","Mvp{Int64}: -2+224y‚Åª¬π")
@test mytest("p(y=1)","Mvp{Int64}: 7x‚Åµ-2")
@test mytest("p(x=2,y=1)","Mvp{Int64}: 222")
@test mytest("p(x=y)","Mvp{Int64}: 7y‚Å¥-2")
@test mytest("p(x=y,y=x)","Mvp{Int64}: 7x‚Å¥-2")
end
@testset "PermGroups.jl" begin
@test mytest("G=Group([Perm(i,i+1) for i in 1:2])","Group([perm\"(1,2)\",perm\"(2,3)\"])")
@test mytest("collect(G)","6-element Array{Perm{Int16},1}:\n (1,2)\n (1,3,2)\n ()\n (1,2,3)\n (1,3)\n (2,3)")
@test mytest("degree(G)","3")
@test mytest("Perm(1,2) in G","true")
@test mytest("Perm(1,2,4) in G","false")
@test mytest("base(G)","2-element Array{Int16,1}:\n 1\n 2")
@test mytest("centralizers(G)","2-element Array{PermGroup{Int16},1}:\n Group([perm\"(1,2)\",perm\"(2,3)\"])\n Group([perm\"(2,3)\"])")
@test mytest("transversals(G)","2-element Array{Dict{Int16,Perm{Int16}},1}:\n Dict(2 => (1,2),3 => (1,3,2),1 => ())\n Dict(2 => (),3 => (2,3))")
end
@testset "Perms.jl" begin
@test mytest("a=Perm(1,2,3)","(1,2,3)")
@test mytest("vec(a)","3-element Array{Int16,1}:\n 2\n 3\n 1")
@test mytest("a==Perm(vec(a))","true")
@test mytest("b=Perm(1,2,3,4)","(1,2,3,4)")
@test mytest("a*b","(1,3,2,4)")
@test mytest("inv(a)","(1,3,2)")
@test mytest("a/b","(3,4)")
@test mytest("a\\b","(1,4)")
@test mytest("a^b","(2,3,4)")
@test mytest("b^2","(1,3)(2,4)")
@test mytest("1^a","2")
@test mytest("one(a)","()")
@test mytest("sign(a)","1")
@test mytest("order(a)","3")
@test mytest("largest_moved_point(a)","3")
@test mytest("smallest_moved_point(a)","1")
@test mytest("Perm{Int8}(a)","Perm{Int8}: (1,2,3)")
@test mytest("Matrix(b)","4√ó4 Array{Bool,2}:\n 0  1  0  0\n 0  0  1  0\n 0  0  0  1\n 1  0  0  0")
@test mytest("orbits(Perm(1,2)*Perm(4,5),1:5)","3-element Array{Array{Int16,1},1}:\n [1, 2]\n [3]\n [4, 5]")
@test mytest("cycles(Perm(1,2)*Perm(4,5))","2-element Array{Array{Int16,1},1}:\n [1, 2]\n [4, 5]")
@test mytest("cycletype(Perm(1,2)*Perm(3,4))","1-element Array{Pair{Tuple{Int64,Int64},Int64},1}:\n (2, 1) => 2")
@test mytest("permuted([5,4,6,1,7,5], Perm(1,3,5,6,4))","6-element Array{Int64,1}:\n 1\n 4\n 5\n 5\n 6\n 7")
end
@testset "Pols.jl" begin
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("Pol([1,2],0)","Pol{Int64}: 2q+1")
@test mytest("p=Pol([1,2],-1)","Pol{Int64}: 2+q‚Åª¬π")
@test mytest("valuation(p)","-1")
@test mytest("p=(q+1)^2","Pol{Int64}: q¬≤+2q+1")
@test mytest("degree(p)","2")
@test mytest("p(1//2)","9//4")
@test mytest("p[0], p[1], p[-1]","(1, 2, 0)")
@test mytest("divrem(q^3+1,q+2)","(1.0q¬≤-2.0q+4.0, -7.0)")
@test mytest("divrem1(q^3+1,q+2)","(q¬≤-2q+4, -7)")
@test mytest("cyclotomic_polynomial(24)","Pol{Int64}: q‚Å∏-q‚Å¥+1")
@test mytest("gcd(q+1,q^2-1)","Pol{Float64}: 1.0q+1.0")
@test mytest("gcd(q+1//1,q^2-1//1)","Pol{Rational{Int64}}: (1//1)q+1//1")
end
@testset "Posets.jl" begin
@test mytest("p=Poset(coxgroup(:A,2))","<1,2<21,12<121")
@test mytest("hasse(p)","6-element Array{Array{Int64,1},1}:\n [2, 3]\n [4, 5]\n [4, 5]\n [6]\n [6]\n []")
@test mytest("incidence(p)","6√ó6 Array{Bool,2}:\n 1  1  1  1  1  1\n 0  1  0  1  1  1\n 0  0  1  1  1  1\n 0  0  0  1  0  1\n 0  0  0  0  1  1\n 0  0  0  0  0  1")
@test mytest("lcm_partitions([[1,2],[3,4],[5,6]],[[1],[2,5],[3],[4],[6]])","2-element Array{Array{Int64,1},1}:\n [1, 2, 5, 6]\n [3, 4]")
@test mytest("gcd_partitions([[1,2],[3,4],[5,6]],[[1],[2,5],[3],[4],[6]])","6-element Array{Array{Int64,1},1}:\n [1]\n [2]\n [3]\n [4]\n [5]\n [6]")
@test mytest("m=[j-i in [0,1] for i in 1:5, j in 1:5]","5√ó5 Array{Bool,2}:\n 1  1  0  0  0\n 0  1  1  0  0\n 0  0  1  1  0\n 0  0  0  1  1\n 0  0  0  0  1")
@test mytest("transitive_closure(m)","5√ó5 Array{Bool,2}:\n 1  1  1  1  1\n 0  1  1  1  1\n 0  0  1  1  1\n 0  0  0  1  1\n 0  0  0  0  1")
@test mytest("p=Poset([j%i==0 for i in 1:5, j in 1:5])","1<3,5\n1<2<4")
@test mytest("linear_extension(p)","5-element Array{Int64,1}:\n 1\n 2\n 3\n 5\n 4")
@test mytest("p=Poset([j%i==0 for i in 1:5, j in 1:5])","1<3,5\n1<2<4")
@test mytest("hasse(p)","5-element Array{Array{Int64,1},1}:\n [2, 3, 5]\n [4]\n []\n []\n []")
@test mytest("p=Poset(push!([[i+1] for i in 1:5],Int[]))","1<2<3<4<5<6")
@test mytest("incidence(p)","6√ó6 Array{Bool,2}:\n 1  1  1  1  1  1\n 0  1  1  1  1  1\n 0  0  1  1  1  1\n 0  0  0  1  1  1\n 0  0  0  0  1  1\n 0  0  0  0  0  1")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("reverse(p)","3,7<2,6<1,5<4,8")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("partition(p)","4-element Array{Array{Int64,1},1}:\n [4, 8]\n [2, 6]\n [3, 7]\n [1, 5]")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("restricted(p,2:6)","3<4<1,5<2")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("is_join_lattice(p)","false")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("is_meet_lattice(p)","false")
@test mytest("W=coxgroup(:A,2)","A‚ÇÇ")
@test mytest("Poset(W)","<1,2<21,12<121")
@test mytest("W=coxgroup(:A,3)","A‚ÇÉ")
@test mytest("Poset(W,W(1,3))","<3,1<13")
end
@testset "SPerms.jl" begin
@test mytest("SPerm([-2,-1,-3])","SPerm{Int64}: (1,-2)(3,-3)")
@test mytest("p=SPerm(-1)","(1,-1)")
@test mytest("q=SPerm(1,2)","(1,2)")
@test mytest("elements(Group([p,q]))","8-element Array{SPerm{Int16},1}:\n ()\n (1,-1)(2,-2)\n (1,-2,-1,2)\n (1,-2)\n (1,2)\n (1,2,-1,-2)\n (2,-2)\n (1,-1)")
@test mytest("SPerm([-2,-1,-3])==SPerm([-2,-1,-3,4])","true")
@test mytest("p=SPerm([-2,-1,-3])","SPerm{Int64}: (1,-2)(3,-3)")
@test mytest("permuted([20,30,40],p)","3-element Array{Int64,1}:\n -30\n -20\n -40")
@test mytest("Matrix(SPerm([-2,-1,-3]))","3√ó3 Array{Int64,2}:\n  0  -1   0\n -1   0   0\n  0   0  -1")
end
@testset "Symbols.jl" begin
@test mytest("shiftŒ≤([4,5],3)","5-element Array{Int64,1}:\n 0\n 1\n 2\n 7\n 8")
@test mytest("shiftŒ≤([0,1,4,5],-2)","2-element Array{Int64,1}:\n 2\n 3")
@test mytest("Œ≤set([3,3,1])","3-element Array{Int64,1}:\n 1\n 4\n 5")
@test mytest("partŒ≤([0,4,5])","2-element Array{Int64,1}:\n 3\n 3")
@test mytest("symbol_partition_tuple([[1,2],[1]],1)","2-element Array{Array{Int64,1},1}:\n [2, 2]\n [1]")
@test mytest("symbol_partition_tuple([[1,2],[1]],0)","2-element Array{Array{Int64,1},1}:\n [2, 2]\n [0, 2]")
@test mytest("symbol_partition_tuple([[1,2],[1]],-1)","2-element Array{Array{Int64,1},1}:\n [2, 2]\n [0, 1, 3]")
@test mytest("ranksymbol([[1,2],[1,5,6]])","11")
@test mytest("stringsymbol.(symbols(3,2,1))","14-element Array{String,1}:\n \"(12,0,0)\"\n \"(02,1,0)\"\n \"(02,0,1)\"\n \"(012,12,01)\"\n \"(01,1,1)\"\n \"(012,01,12)\"\n \"(2,,)\"\n \"(01,2,0)\"\n \"(01,0,2)\"\n \"(1,012,012)\"\n \"(,02,01)\"\n \"(,01,02)\"\n \"(0,,012)\"\n \"(0,012,)\"")
@test mytest("stringsymbol.(symbols(3,3,0))","10-element Array{String,1}:\n \"(1,1,1)\"\n \"(01,12,02)\"\n \"(01,02,12)\"\n \"(012,012,123)\"\n \"(0,1,2)\"\n \"(0,2,1)\"\n \"(01,01,13)\"\n \"(0,0,3)\"\n \"(012,,)\"\n \"(012,012,)\"")
@test mytest("fegsymbol([[1,5,6],[1,2]])","q¬π‚Å∂Œ¶‚ÇÖŒ¶‚ÇáŒ¶‚ÇàŒ¶‚ÇâŒ¶‚ÇÅ‚ÇÄŒ¶‚ÇÅ‚ÇÅŒ¶‚ÇÅ‚ÇÑŒ¶‚ÇÅ‚ÇÜŒ¶‚ÇÅ‚ÇàŒ¶‚ÇÇ‚ÇÄŒ¶‚ÇÇ‚ÇÇ")
end
@testset "Uch.jl" begin
@test mytest("W=coxgroup(:G,2)","G‚ÇÇ")
@test mytest("uc=UnipotentCharacters(W)","UnipotentCharacters(G‚ÇÇ)\n      Œ≥‚îÇ      Deg(Œ≥)  Feg Fr(Œ≥)    label\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nœÜ‚ÇÅ‚Äö‚ÇÄ   ‚îÇ           1    1     1\nœÜ‚ÇÅ‚Äö‚ÇÜ   ‚îÇ          q‚Å∂   q‚Å∂     1\nœÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ  ‚îÇ  (1/3)qŒ¶‚ÇÉŒ¶‚ÇÜ   q¬≥     1    (1,œÅ)\nœÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ  ‚îÇ  (1/3)qŒ¶‚ÇÉŒ¶‚ÇÜ   q¬≥     1   (g‚ÇÉ,1)\nœÜ‚ÇÇ‚Äö‚ÇÅ   ‚îÇ (1/6)qŒ¶‚ÇÇ¬≤Œ¶‚ÇÉ  qŒ¶‚Çà     1    (1,1)\nœÜ‚ÇÇ‚Äö‚ÇÇ   ‚îÇ (1/2)qŒ¶‚ÇÇ¬≤Œ¶‚ÇÜ q¬≤Œ¶‚ÇÑ     1   (g‚ÇÇ,1)\nG‚ÇÇ[-1] ‚îÇ (1/2)qŒ¶‚ÇÅ¬≤Œ¶‚ÇÉ    0    -1   (g‚ÇÇ,Œµ)\nG‚ÇÇ[1]  ‚îÇ (1/6)qŒ¶‚ÇÅ¬≤Œ¶‚ÇÜ    0     1    (1,Œµ)\nG‚ÇÇ[Œ∂‚ÇÉ] ‚îÇ(1/3)qŒ¶‚ÇÅ¬≤Œ¶‚ÇÇ¬≤    0    Œ∂‚ÇÉ  (g‚ÇÉ,Œ∂‚ÇÉ)\nG‚ÇÇ[Œ∂‚ÇÉ¬≤]‚îÇ(1/3)qŒ¶‚ÇÅ¬≤Œ¶‚ÇÇ¬≤    0   Œ∂‚ÇÉ¬≤ (g‚ÇÉ,Œ∂‚ÇÉ¬≤)")
@test mytest("uc.families[1]","Family(D(S‚ÇÉ):[5, 6, 4, 3, 8, 7, 9, 10])\n   label‚îÇeigen\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n(1,1)   ‚îÇ    1 1//6  1//2  1//3  1//3  1//6  1//2  1//3  1//3\n(g‚ÇÇ,1)  ‚îÇ    1 1//2  1//2  0//1  0//1 -1//2 -1//2  0//1  0//1\n(g‚ÇÉ,1)  ‚îÇ    1 1//3  0//1  2//3 -1//3  1//3  0//1 -1//3 -1//3\n(1,œÅ)   ‚îÇ    1 1//3  0//1 -1//3  2//3  1//3  0//1 -1//3 -1//3\n(1,Œµ)   ‚îÇ    1 1//6 -1//2  1//3  1//3  1//6 -1//2  1//3  1//3\n(g‚ÇÇ,Œµ)  ‚îÇ   -1 1//2 -1//2  0//1  0//1 -1//2  1//2  0//1  0//1\n(g‚ÇÉ,Œ∂‚ÇÉ) ‚îÇ   Œ∂‚ÇÉ 1//3  0//1 -1//3 -1//3  1//3  0//1  2//3 -1//3\n(g‚ÇÉ,Œ∂‚ÇÉ¬≤)‚îÇ  Œ∂‚ÇÉ¬≤ 1//3  0//1 -1//3 -1//3  1//3  0//1 -1//3  2//3")
@test mytest("UnipotentCharacters(ComplexReflectionGroup(4))","UnipotentCharacters(G‚ÇÑ)\n    Œ≥‚îÇ              Deg(Œ≥)    Feg Fr(Œ≥)   label\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nœÜ‚ÇÅ‚Äö‚ÇÄ ‚îÇ                   1      1     1\nœÜ‚ÇÅ‚Äö‚ÇÑ ‚îÇ  (-‚àö-3/6)q‚Å¥Œ¶‚Ä≥‚ÇÉŒ¶‚ÇÑŒ¶‚Ä≥‚ÇÜ     q‚Å¥     1  1‚àß-Œ∂‚ÇÉ¬≤\nœÜ‚ÇÅ‚Äö‚Çà ‚îÇ   (‚àö-3/6)q‚Å¥Œ¶‚Ä≤‚ÇÉŒ¶‚ÇÑŒ¶‚Ä≤‚ÇÜ     q‚Å∏     1  -1‚àßŒ∂‚ÇÉ¬≤\nœÜ‚ÇÇ‚Äö‚ÇÖ ‚îÇ        (1/2)q‚Å¥Œ¶‚ÇÇ¬≤Œ¶‚ÇÜ   q‚ÅµŒ¶‚ÇÑ     1   1‚àßŒ∂‚ÇÉ¬≤\nœÜ‚ÇÇ‚Äö‚ÇÉ ‚îÇ((3+‚àö-3)/6)qŒ¶‚Ä≥‚ÇÉŒ¶‚ÇÑŒ¶‚Ä≤‚ÇÜ   q¬≥Œ¶‚ÇÑ     1   1‚àßŒ∂‚ÇÉ¬≤\nœÜ‚ÇÇ‚Äö‚ÇÅ ‚îÇ((3-‚àö-3)/6)qŒ¶‚Ä≤‚ÇÉŒ¶‚ÇÑŒ¶‚Ä≥‚ÇÜ    qŒ¶‚ÇÑ     1    1‚àßŒ∂‚ÇÉ\nœÜ‚ÇÉ‚Äö‚ÇÇ ‚îÇ              q¬≤Œ¶‚ÇÉŒ¶‚ÇÜ q¬≤Œ¶‚ÇÉŒ¶‚ÇÜ     1\nZ‚ÇÉ:2 ‚îÇ     (-‚àö-3/3)qŒ¶‚ÇÅŒ¶‚ÇÇŒ¶‚ÇÑ      0   Œ∂‚ÇÉ¬≤  Œ∂‚ÇÉ‚àßŒ∂‚ÇÉ¬≤\nZ‚ÇÉ:11‚îÇ    (-‚àö-3/3)q‚Å¥Œ¶‚ÇÅŒ¶‚ÇÇŒ¶‚ÇÑ      0   Œ∂‚ÇÉ¬≤  Œ∂‚ÇÉ‚àß-Œ∂‚ÇÉ\nG‚ÇÑ   ‚îÇ       (-1/2)q‚Å¥Œ¶‚ÇÅ¬≤Œ¶‚ÇÉ      0    -1 -Œ∂‚ÇÉ¬≤‚àß-1")
@test mytest("W=coxgroup(:B,2)","B‚ÇÇ")
@test mytest("uc=UnipotentCharacters(W)","UnipotentCharacters(B‚ÇÇ)\n  Œ≥‚îÇ   Deg(Œ≥) Feg Fr(Œ≥) label\n‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n11.‚îÇ (1/2)qŒ¶‚ÇÑ  q¬≤     1   +,-\n1.1‚îÇ(1/2)qŒ¶‚ÇÇ¬≤ qŒ¶‚ÇÑ     1   +,+\n.11‚îÇ       q‚Å¥  q‚Å¥     1\n2. ‚îÇ        1   1     1\n.2 ‚îÇ (1/2)qŒ¶‚ÇÑ  q¬≤     1   -,+\nB‚ÇÇ ‚îÇ(1/2)qŒ¶‚ÇÅ¬≤   0    -1   -,-")
end
@testset "Ucl.jl" begin
@test mytest("UnipotentClasses(rootdatum(:sl,4))","UnipotentClasses(A‚ÇÉ)\n1111<211<22<31<4\n   u‚îÇD-R dBu B-C     C(u) A‚ÇÉ(A‚ÇÉ‚Çç‚Çé) A‚ÇÅ(A‚ÇÉ‚Çç‚ÇÅ‚ÇÉ‚Çé=A‚ÇÅ√óA‚ÇÅ)/-1 .(A‚ÇÉ)/Œ∂‚ÇÑ .(A‚ÇÉ)/-Œ∂‚ÇÑ\n‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n4   ‚îÇ222   0 222    q¬≥.Z‚ÇÑ      1:4                -1:2    Œ∂‚ÇÑ:Id    -Œ∂‚ÇÑ:Id\n31  ‚îÇ202   1 22.      q‚Å¥.    Id:31\n22  ‚îÇ020   2 2.2 q‚Å¥.A‚ÇÅ.Z‚ÇÇ     2:22               11:11\n211 ‚îÇ101   3 2..    q‚Åµ.A‚ÇÅ   Id:211\n1111‚îÇ000   6 ...      .A‚ÇÉ  Id:1111")
@test mytest("UnipotentClasses(coxgroup(:A,3))","UnipotentClasses(A‚ÇÉ)\n1111<211<22<31<4\n   u‚îÇD-R dBu B-C  C(u) A‚ÇÉ(A‚ÇÉ‚Çç‚Çé)\n‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n4   ‚îÇ222   0 222    q¬≥     Id:4\n31  ‚îÇ202   1 22.   q‚Å¥.    Id:31\n22  ‚îÇ020   2 2.2 q‚Å¥.A‚ÇÅ    Id:22\n211 ‚îÇ101   3 2.. q‚Åµ.A‚ÇÅ   Id:211\n1111‚îÇ000   6 ...   .A‚ÇÉ  Id:1111")
@test mytest("UnipotentClasses(coxgroup(:G,2))","UnipotentClasses(G‚ÇÇ)\n1<A‚ÇÅ<AÃÉ‚ÇÅ<G‚ÇÇ(a‚ÇÅ)<G‚ÇÇ\n     u‚îÇD-R dBu B-C  C(u)        G‚ÇÇ(G‚ÇÇ‚Çç‚Çé)  .(G‚ÇÇ)\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nG‚ÇÇ    ‚îÇ 22   0  22    q¬≤         Id:œÜ‚ÇÅ‚Äö‚ÇÄ\nG‚ÇÇ(a‚ÇÅ)‚îÇ 20   1  20 q‚Å¥.S‚ÇÉ 21:œÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ 3:œÜ‚ÇÇ‚Äö‚ÇÅ 111:Id\nAÃÉ‚ÇÅ    ‚îÇ 01   2  .2 q¬≥.A‚ÇÅ         Id:œÜ‚ÇÇ‚Äö‚ÇÇ\nA‚ÇÅ    ‚îÇ 10   3  2. q‚Åµ.A‚ÇÅ        Id:œÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ\n1     ‚îÇ 00   6  ..   .G‚ÇÇ         Id:œÜ‚ÇÅ‚Äö‚ÇÜ")
@test mytest("UnipotentClasses(coxgroup(:G,2),3)","UnipotentClasses(G‚ÇÇ)\n1<A‚ÇÅ,(AÃÉ‚ÇÅ)‚ÇÉ<AÃÉ‚ÇÅ<G‚ÇÇ(a‚ÇÅ)<G‚ÇÇ\n     u‚îÇdBu B-C  C(u) G‚ÇÇ(G‚ÇÇ‚Çç‚Çé) .(G‚ÇÇ) .(G‚ÇÇ)  .(G‚ÇÇ)\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nG‚ÇÇ    ‚îÇ  0  22 q¬≤.Z‚ÇÉ   1:œÜ‚ÇÅ‚Äö‚ÇÄ       Œ∂‚ÇÉ:Id Œ∂‚ÇÉ¬≤:Id\nG‚ÇÇ(a‚ÇÅ)‚îÇ  1  20 q‚Å¥.Z‚ÇÇ   2:œÜ‚ÇÇ‚Äö‚ÇÅ 11:Id\nAÃÉ‚ÇÅ    ‚îÇ  2  .2    q‚Å∂  Id:œÜ‚ÇÇ‚Äö‚ÇÇ\nA‚ÇÅ    ‚îÇ  3  2. q‚Åµ.A‚ÇÅ Id:œÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ\n(AÃÉ‚ÇÅ)‚ÇÉ ‚îÇ  3  ?? q‚Åµ.A‚ÇÅ Id:œÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ\n1     ‚îÇ  6  ..   .G‚ÇÇ  Id:œÜ‚ÇÅ‚Äö‚ÇÜ")
@test mytest("uc=UnipotentClasses(coxgroup(:G,2));","nothing")
@test mytest("t=ICCTable(uc)","Coefficients of X_œÜ on Y_œà for G‚ÇÇ\n      ‚îÇG‚ÇÇ G‚ÇÇ(a‚ÇÅ)‚ÅΩ¬≤¬π‚Åæ G‚ÇÇ(a‚ÇÅ) AÃÉ‚ÇÅ A‚ÇÅ  1\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nXœÜ‚ÇÅ‚Äö‚ÇÄ ‚îÇ 1          0      1  1  1  1\nXœÜ‚Ä≤‚ÇÅ‚Äö‚ÇÉ‚îÇ 0          1      0  1  0 q¬≤\nXœÜ‚ÇÇ‚Äö‚ÇÅ ‚îÇ 0          0      1  1  1 Œ¶‚Çà\nXœÜ‚ÇÇ‚Äö‚ÇÇ ‚îÇ 0          0      0  1  1 Œ¶‚ÇÑ\nXœÜ‚Ä≥‚ÇÅ‚Äö‚ÇÉ‚îÇ 0          0      0  0  1  1\nXœÜ‚ÇÅ‚Äö‚ÇÜ ‚îÇ 0          0      0  0  0  1")
@test mytest("W=coxgroup(:F,4)","F‚ÇÑ")
@test mytest("H=reflection_subgroup(W,[1,3])","F‚ÇÑ‚Çç‚ÇÅ‚ÇÉ‚Çé=A‚ÇÅ√óAÃÉ‚ÇÅ")
@test mytest("Ucl.InducedLinearForm(W,H,[2,2])","4-element Array{Int64,1}:\n 0\n 1\n 0\n 0")
@test mytest("uc=UnipotentClasses(W);","nothing")
@test mytest("uc.classes[4].prop","Dict{Symbol,Any} with 7 entries:\n  :dynkin     => [0, 1, 0, 0]\n  :dimred     => 6\n  :red        => A‚ÇÅ√óA‚ÇÅ\n  :Au         => .\n  :balacarter => [1, 3]\n  :dimunip    => 18\n  :AuAction   => Extended(coxgroup(:A,1)*coxgroup(:A,1),Array{Int64,2}[[1 0; 0 ‚Ä¶")
@test mytest("uc.classes[4]","UnipotentClass(A‚ÇÅ+AÃÉ‚ÇÅ)")
@test mytest("W=rootdatum(:sl,4)","A‚ÇÉ")
@test mytest("uc=UnipotentClasses(W);","nothing")
@test mytest("uc.classes","5-element Array{Gapjm.Ucl.UnipotentClass,1}:\n UnipotentClass(1111)\n UnipotentClass(211)\n UnipotentClass(22)\n UnipotentClass(31)\n UnipotentClass(4)")
@test mytest("t=ICCTable(uc)","Coefficients of X_œÜ on Y_œà for A‚ÇÉ\n     ‚îÇ4 31 22 211 1111\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nX4   ‚îÇ1  1  1   1    1\nX31  ‚îÇ0  1  1  Œ¶‚ÇÇ   Œ¶‚ÇÉ\nX22  ‚îÇ0  0  1   1   Œ¶‚ÇÑ\nX211 ‚îÇ0  0  0   1   Œ¶‚ÇÉ\nX1111‚îÇ0  0  0   0    1")
end
@testset "Weyl.jl" begin
@test mytest("W=coxgroup(:D,4)","D‚ÇÑ")
@test mytest("cartan(W)","4√ó4 Array{Int64,2}:\n  2   0  -1   0\n  0   2  -1   0\n -1  -1   2  -1\n  0   0  -1   2")
@test mytest("W=coxgroup(:A,2)*coxgroup(:B,2)","A‚ÇÇ√óB‚ÇÇ")
@test mytest("cartan(W)","4√ó4 Array{Int64,2}:\n  2  -1   0   0\n -1   2   0   0\n  0   0   2  -2\n  0   0  -1   2")
@test mytest("W=coxgroup(:D,4)","D‚ÇÑ")
@test mytest("p=W(1,3,2,1,3)","(1,14,13,2)(3,17,8,18)(4,12)(5,20,6,15)(7,10,11,9)(16,24)(19,22,23,21)")
@test mytest("word(W,p)","5-element Array{Int64,1}:\n 1\n 3\n 1\n 2\n 3")
@test mytest("cartan(:A,4)","4√ó4 Array{Int64,2}:\n  2  -1   0   0\n -1   2  -1   0\n  0  -1   2  -1\n  0   0  -1   2")
@test mytest("Weyl.two_tree(cartan(:A,4))","4-element Array{Int64,1}:\n 1\n 2\n 3\n 4")
@test mytest("Weyl.two_tree(cartan(:E,8))","(4, [2], [3, 1], [5, 6, 7, 8])")
@test mytest("W=coxgroup(:G,2)","G‚ÇÇ")
@test mytest("Diagram(W)","O‚áõ O\n1  2")
@test mytest("H=reflection_subgroup(W,[2,6])","G‚ÇÇ‚Çç‚ÇÇ‚ÇÜ‚Çé=AÃÉ‚ÇÅ√óA‚ÇÅ")
@test mytest("Diagram(H)","O\n1\nO\n2")
@test mytest("inclusion(H)","4-element Array{Int64,1}:\n  2\n  6\n  8\n 12")
@test mytest("restriction(H)","12-element Array{Int64,1}:\n 0\n 1\n 0\n 0\n 0\n 2\n 0\n 3\n 0\n 0\n 0\n 4")
@test mytest("word(W,H(2))","5-element Array{Int64,1}:\n 1\n 2\n 1\n 2\n 1")
@test mytest("elH=word.(Ref(H),elements(H))","4-element Array{Array{Int64,1},1}:\n []\n [2]\n [1]\n [1, 2]")
@test mytest("elW=word.(Ref(W),elements(H))","4-element Array{Array{Int64,1},1}:\n []\n [1, 2, 1, 2, 1]\n [2]\n [1, 2, 1, 2, 1, 2]")
@test mytest("map(w->H(w...),elH)==map(w->W(w...),elW)","true")
end
