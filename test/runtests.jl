# auto-generated tests from julia-repl docstrings
using Test, Gapjm
#include("../tools/Gap4.jl")
function mytest(a::String,b::String)
  omit=a[end]==';'
  a=replace(a,"\\\\"=>"\\")
  a=repr(MIME("text/plain"),eval(Meta.parse(a)),context=:limit=>true)
  if omit a="nothing" end
  a=replace(a,r" *(\n|$)"s=>s"\1")
  a=replace(a,r"\n$"s=>"")
  b=replace(b,r" *(\n|$)"s=>s"\1")
  b=replace(b,r"\n$"s=>"")
  i=1
  while i<=lastindex(a) && i<=lastindex(b) && a[i]==b[i]
    i=nextind(a,i)
  end
  if a!=b print("exec=$(repr(a[i:end]))\nmanl=$(repr(b[i:end]))\n") end
  a==b
end
@testset verbose = true "Gapjm" begin
@testset "Chars.jl" begin
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("CharTable(W)","CharTable(Aâ‚ƒ)\n    â”‚1111 211 22 31  4\nâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1111â”‚   1  -1  1  1 -1\n211 â”‚   3  -1 -1  .  1\n22  â”‚   2   .  2 -1  .\n31  â”‚   3   1 -1  . -1\n4   â”‚   1   1  1  1  1")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("ct=CharTable(W)","CharTable(Gâ‚‚)\n     â”‚Aâ‚€ AÌƒâ‚ Aâ‚ Gâ‚‚ Aâ‚‚ Aâ‚+AÌƒâ‚\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nÏ†â‚â€šâ‚€ â”‚ 1  1  1  1  1     1\nÏ†â‚â€šâ‚† â”‚ 1 -1 -1  1  1     1\nÏ†â€²â‚â€šâ‚ƒâ”‚ 1  1 -1 -1  1    -1\nÏ†â€³â‚â€šâ‚ƒâ”‚ 1 -1  1 -1  1    -1\nÏ†â‚‚â€šâ‚ â”‚ 2  .  .  1 -1    -2\nÏ†â‚‚â€šâ‚‚ â”‚ 2  .  . -1 -1     2")
@test mytest("ct.charnames","6-element Vector{String}:\n \"\\\\phi_{1,0}\"\n \"\\\\phi_{1,6}\"\n \"\\\\phi_{1,3}'\"\n \"\\\\phi_{1,3}''\"\n \"\\\\phi_{2,1}\"\n \"\\\\phi_{2,2}\"")
@test mytest("ct.classnames","6-element Vector{String}:\n \"A_0\"\n \"\\\\tilde A_1\"\n \"A_1\"\n \"G_2\"\n \"A_2\"\n \"A_1+\\\\tilde A_1\"")
@test mytest("Chars.fakedegree(coxgroup(:A,2),[[2,1]],Pol(:q))","Pol{Cyc{Int64}}: qÂ²+q")
@test mytest("fakedegrees(coxgroup(:A,2),Pol(:q))","3-element Vector{Pol{Int64}}:\n qÂ³\n qÂ²+q\n 1")
@test mytest("charinfo(coxgroup(:G,2))[:charparams]","6-element Vector{Vector{Vector{Int64}}}:\n [[1, 0]]\n [[1, 6]]\n [[1, 3, 1]]\n [[1, 3, 2]]\n [[2, 1]]\n [[2, 2]]")
@test mytest("charinfo(coxgroup(:D,4))[:positionId]","13")
@test mytest("charinfo(coxgroup(:D,4))[:positionDet]","4")
@test mytest("charinfo(coxgroup(:D,4))[:extRefl]","5-element Vector{Int64}:\n 13\n 11\n  5\n  3\n  4")
@test mytest("charinfo(coxgroup(:D,4))[:b]","13-element Vector{Int64}:\n  6\n  6\n  7\n 12\n  4\n  3\n  6\n  2\n  2\n  4\n  1\n  2\n  0")
@test mytest("charinfo(coxgroup(:D,4))[:B]","13-element Vector{Int64}:\n 10\n 10\n 11\n 12\n  8\n  9\n 10\n  6\n  6\n  8\n  5\n  6\n  0")
@test mytest("charinfo(coxgroup(:D,4))[:a]","13-element Vector{Int64}:\n  6\n  6\n  7\n 12\n  3\n  3\n  6\n  2\n  2\n  3\n  1\n  2\n  0")
@test mytest("charinfo(coxgroup(:D,4))[:A]","13-element Vector{Int64}:\n 10\n 10\n 11\n 12\n  9\n  9\n 10\n  6\n  6\n  9\n  5\n  6\n  0")
@test mytest("charinfo(ComplexReflectionGroup(22))[:opdam]","(3,5)(4,6)(11,13)(12,14)(17,18)")
@test mytest("charinfo(coxgroup(:A,2))","Dict{Symbol, Any} with 9 entries:\n  :a           => [3, 1, 0]\n  :b           => [3, 1, 0]\n  :positionId  => 3\n  :charnames   => [\"111\", \"21\", \"3\"]\n  :A           => [3, 2, 0]\n  :B           => [3, 2, 0]\n  :extRefl     => [3, 2, 1]\n  :charparams  => [[[1, 1, 1]], [[2, 1]], [[3]]]\n  :positionDet => 1")
@test mytest("charinfo(coxgroup(:G,2))[:spaltenstein]","6-element Vector{String}:\n \"1\"\n \"\\\\varepsilon\"\n \"\\\\varepsilon_l\"\n \"\\\\varepsilon_c\"\n \"\\\\theta'\"\n \"\\\\theta''\"")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("detPerm(W)","(1,8)(2,9)(3,11)(4,13)(7,12)")
@test mytest("classinfo(coxgroup(:A,2))","Dict{Symbol, Any} with 5 entries:\n  :classes     => [1, 3, 2]\n  :orders      => [1, 2, 3]\n  :classtext   => [Int64[], [1], [1, 2]]\n  :classnames  => [\"111\", \"21\", \"3\"]\n  :classparams => [[1, 1, 1], [2, 1], [3]]")
@test mytest("W=spets(coxgroup(:D,4),Perm(1,2,4))","Â³Dâ‚„")
@test mytest("CharTable(W)","CharTable(Â³Dâ‚„)\n     â”‚Câ‚ƒ AÌƒâ‚‚ Câ‚ƒ+Aâ‚ AÌƒâ‚‚+Aâ‚ Fâ‚„ AÌƒâ‚‚+Aâ‚‚ Fâ‚„(aâ‚)\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n.4   â”‚ 1  1     1     1  1     1      1\n.1111â”‚-1  1     1    -1  1     1      1\n.22  â”‚ .  2     2     . -1    -1     -1\n11.2 â”‚ .  .     .     . -1     3      3\n1.3  â”‚ 1  1    -1    -1  .    -2      2\n1.111â”‚-1  1    -1     1  .    -2      2\n1.21 â”‚ .  2    -2     .  .     2     -2")
@test mytest("WF=rootdatum(\"3D4\")","Â³Dâ‚„")
@test mytest("on_chars(Group(WF),WF.phi)","(1,2,7)(8,9,12)")
@test mytest("representation(ComplexReflectionGroup(24),3)","3-element Vector{Matrix{Cyc{Int64}}}:\n [1 0 0; -1 -1 0; -1 0 -1]\n [-1 0 -1; 0 -1 (1-âˆš-7)/2; 0 0 1]\n [-1 -1 0; 0 1 0; 0 (1+âˆš-7)/2 -1]")
@test mytest("representations(coxgroup(:B,2))","5-element Vector{Vector{Matrix{Int64}}}:\n [[1], [-1]]\n [[1 0; -1 -1], [1 2; 0 -1]]\n [[-1], [-1]]\n [[1], [1]]\n [[-1], [1]]")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("charnames(W;limit=true)","6-element Vector{String}:\n \"Ï†â‚â€šâ‚€\"\n \"Ï†â‚â€šâ‚†\"\n \"Ï†â€²â‚â€šâ‚ƒ\"\n \"Ï†â€³â‚â€šâ‚ƒ\"\n \"Ï†â‚‚â€šâ‚\"\n \"Ï†â‚‚â€šâ‚‚\"")
@test mytest("charnames(W;TeX=true)","6-element Vector{String}:\n \"\\\\phi_{1,0}\"\n \"\\\\phi_{1,6}\"\n \"\\\\phi_{1,3}'\"\n \"\\\\phi_{1,3}''\"\n \"\\\\phi_{2,1}\"\n \"\\\\phi_{2,2}\"")
@test mytest("charnames(W;spaltenstein=true,limit=true)","6-element Vector{String}:\n \"1\"\n \"Îµ\"\n \"Îµâ‚—\"\n \"Îµ_c\"\n \"Î¸â€²\"\n \"Î¸â€³\"")
@test mytest("charnames(W;spaltenstein=true,TeX=true)","6-element Vector{String}:\n \"1\"\n \"\\\\varepsilon\"\n \"\\\\varepsilon_l\"\n \"\\\\varepsilon_c\"\n \"\\\\theta'\"\n \"\\\\theta''\"")
@test mytest("g=coxgroup(:G,2)","Gâ‚‚")
@test mytest("u=reflection_subgroup(g,[1,6])","Gâ‚‚â‚â‚â‚…â‚=Aâ‚‚")
@test mytest("t=InductionTable(u,g)","Induction Table from Gâ‚‚â‚â‚â‚…â‚=Aâ‚‚ to Gâ‚‚\n     â”‚111 21 3\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€\nÏ†â‚â€šâ‚€ â”‚  .  . 1\nÏ†â‚â€šâ‚† â”‚  1  . .\nÏ†â€²â‚â€šâ‚ƒâ”‚  1  . .\nÏ†â€³â‚â€šâ‚ƒâ”‚  .  . 1\nÏ†â‚‚â€šâ‚ â”‚  .  1 .\nÏ†â‚‚â€šâ‚‚ â”‚  .  1 .")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("H=reflection_subgroup(W,[1,3])","Dâ‚„â‚â‚â‚ƒâ‚=Aâ‚‚Î¦â‚Â²")
@test mytest("jInductionTable(H,W)","j-Induction Table from Dâ‚„â‚â‚â‚ƒâ‚=Aâ‚‚Î¦â‚Â² to Dâ‚„\n     â”‚111 21 3\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€\n11+  â”‚  .  . .\n11-  â”‚  .  . .\n1.111â”‚  .  . .\n.1111â”‚  .  . .\n11.2 â”‚  .  . .\n1.21 â”‚  1  . .\n.211 â”‚  .  . .\n2+   â”‚  .  . .\n2-   â”‚  .  . .\n.22  â”‚  .  . .\n1.3  â”‚  .  1 .\n.31  â”‚  .  . .\n.4   â”‚  .  . 1")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("H=reflection_subgroup(W,[1,3])","Dâ‚„â‚â‚â‚ƒâ‚=Aâ‚‚Î¦â‚Â²")
@test mytest("JInductionTable(H,W)","J-Induction Table from Dâ‚„â‚â‚â‚ƒâ‚=Aâ‚‚Î¦â‚Â² to Dâ‚„\n     â”‚111 21 3\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€\n11+  â”‚  .  . .\n11-  â”‚  .  . .\n1.111â”‚  .  . .\n.1111â”‚  .  . .\n11.2 â”‚  1  . .\n1.21 â”‚  1  . .\n.211 â”‚  .  . .\n2+   â”‚  .  . .\n2-   â”‚  .  . .\n.22  â”‚  .  . .\n1.3  â”‚  .  1 .\n.31  â”‚  .  . .\n.4   â”‚  .  . 1")
end
@testset "Combinat.jl" begin
@test mytest("groupby(iseven,1:10)","Dict{Bool, Vector{Int64}} with 2 entries:\n  0 => [1, 3, 5, 7, 9]\n  1 => [2, 4, 6, 8, 10]")
@test mytest("tally(\"a tally test\")","7-element Vector{Pair{Char, Int64}}:\n ' ' => 2\n 'a' => 2\n 'e' => 1\n 'l' => 2\n 's' => 1\n 't' => 3\n 'y' => 1")
@test mytest("l=[:Jan,:Feb,:Mar,:Apr,:May,:Jun,:Jul,:Aug,:Sep,:Oct,:Nov,:Dec];","nothing")
@test mytest("collectby(x->first(string(x)),l)","8-element Vector{Vector{Symbol}}:\n [:Apr, :Aug]\n [:Dec]\n [:Feb]\n [:Jan, :Jun, :Jul]\n [:Mar, :May]\n [:Nov]\n [:Oct]\n [:Sep]")
@test mytest("collectby(\"JFMAMJJASOND\",l)","8-element Vector{Vector{Symbol}}:\n [:Apr, :Aug]\n [:Dec]\n [:Feb]\n [:Jan, :Jun, :Jul]\n [:Mar, :May]\n [:Nov]\n [:Oct]\n [:Sep]")
@test mytest("ncombinations([1,2,2,3])","12")
@test mytest("combinations([1,2,2,3])","12-element Vector{Vector{Int64}}:\n []\n [1]\n [2]\n [3]\n [1, 2]\n [1, 3]\n [2, 2]\n [2, 3]\n [1, 2, 2]\n [1, 2, 3]\n [2, 2, 3]\n [1, 2, 2, 3]")
@test mytest("narrangements(collect(\"settle\"),4)","102")
@test mytest("narrangements(collect(\"settle\"))","523")
@test mytest("String.(arrangements(collect(\"settle\"),2))","14-element Vector{String}:\n \"ee\"\n \"el\"\n \"es\"\n \"et\"\n \"le\"\n \"ls\"\n \"lt\"\n \"se\"\n \"sl\"\n \"st\"\n \"te\"\n \"tl\"\n \"ts\"\n \"tt\"")
@test mytest("npartitions(7)","15")
@test mytest("partitions(7)","15-element Vector{Vector{Int64}}:\n [1, 1, 1, 1, 1, 1, 1]\n [2, 1, 1, 1, 1, 1]\n [2, 2, 1, 1, 1]\n [2, 2, 2, 1]\n [3, 1, 1, 1, 1]\n [3, 2, 1, 1]\n [3, 2, 2]\n [3, 3, 1]\n [4, 1, 1, 1]\n [4, 2, 1]\n [4, 3]\n [5, 1, 1]\n [5, 2]\n [6, 1]\n [7]")
@test mytest("npartitions(7,3)","4")
@test mytest("partitions(7,3)","4-element Vector{Vector{Int64}}:\n [3, 2, 2]\n [3, 3, 1]\n [4, 2, 1]\n [5, 1, 1]")
@test mytest("conjugate_partition([4,2,1])","4-element Vector{Int64}:\n 3\n 2\n 1\n 1")
@test mytest("conjugate_partition([6])","6-element Vector{Int64}:\n 1\n 1\n 1\n 1\n 1\n 1")
@test mytest("dominates([5,4],[4,4,1])","true")
@test mytest("npartition_tuples(3,2)","10")
@test mytest("partition_tuples(3,2)","10-element Vector{Vector{Vector{Int64}}}:\n [[1, 1, 1], []]\n [[1, 1], [1]]\n [[1], [1, 1]]\n [[], [1, 1, 1]]\n [[2, 1], []]\n [[1], [2]]\n [[2], [1]]\n [[], [2, 1]]\n [[3], []]\n [[], [3]]")
@test mytest("compositions(4)","8-element Vector{Vector{Int64}}:\n [1, 1, 1, 1]\n [2, 1, 1]\n [1, 2, 1]\n [3, 1]\n [1, 1, 2]\n [2, 2]\n [1, 3]\n [4]")
@test mytest("compositions(4,2)","3-element Vector{Vector{Int64}}:\n [3, 1]\n [2, 2]\n [1, 3]")
@test mytest("compositions(4,2;start=0)","5-element Vector{Vector{Int64}}:\n [4, 0]\n [3, 1]\n [2, 2]\n [1, 3]\n [0, 4]")
@test mytest("submultisets(1:4,3)","20-element Vector{Vector{Int64}}:\n [1, 1, 1]\n [1, 1, 2]\n [1, 1, 3]\n [1, 1, 4]\n [1, 2, 2]\n [1, 2, 3]\n [1, 2, 4]\n [1, 3, 3]\n [1, 3, 4]\n [1, 4, 4]\n [2, 2, 2]\n [2, 2, 3]\n [2, 2, 4]\n [2, 3, 3]\n [2, 3, 4]\n [2, 4, 4]\n [3, 3, 3]\n [3, 3, 4]\n [3, 4, 4]\n [4, 4, 4]")
@test mytest("npartitions_set(1:3)","5")
@test mytest("partitions_set(1:3)","5-element Vector{Vector{Vector{Int64}}}:\n [[1], [2], [3]]\n [[1], [2, 3]]\n [[1, 2], [3]]\n [[1, 2, 3]]\n [[1, 3], [2]]")
@test mytest("npartitions_set(1:4,2)","7")
@test mytest("partitions_set(1:4,2)","7-element Vector{Vector{Vector{Int64}}}:\n [[1], [2, 3, 4]]\n [[1, 2], [3, 4]]\n [[1, 2, 3], [4]]\n [[1, 2, 4], [3]]\n [[1, 3], [2, 4]]\n [[1, 3, 4], [2]]\n [[1, 4], [2, 3]]")
@test mytest("lcm_partitions([[1,2],[3,4],[5,6]],[[1],[2,5],[3],[4],[6]])","2-element Vector{Vector{Int64}}:\n [1, 2, 5, 6]\n [3, 4]")
@test mytest("gcd_partitions([[1,2],[3,4],[5,6]],[[1],[2,5],[3],[4],[6]])","6-element Vector{Vector{Int64}}:\n [1]\n [2]\n [3]\n [4]\n [5]\n [6]")
@test mytest("bell.(0:6)","7-element Vector{Int64}:\n   1\n   1\n   2\n   5\n  15\n  52\n 203")
@test mytest("bell(14)","190899322")
@test mytest("stirling2.(4,0:4)","5-element Vector{Int64}:\n 0\n 1\n 7\n 6\n 1")
@test mytest("[stirling2(i,j) for i in 0:6, j in 0:6]","7Ã—7 Matrix{Int64}:\n 1  0   0   0   0   0  0\n 0  1   0   0   0   0  0\n 0  1   1   0   0   0  0\n 0  1   3   1   0   0  0\n 0  1   7   6   1   0  0\n 0  1  15  25  10   1  0\n 0  1  31  90  65  15  1")
@test mytest("stirling2(50,big(10))","26154716515862881292012777396577993781727011")
end
@testset "ComplexR.jl" begin
@test mytest("G=ComplexReflectionGroup(4)","Gâ‚„")
@test mytest("degrees(G)","2-element Vector{Int64}:\n 4\n 6")
@test mytest("length(G)","24")
@test mytest("fakedegrees(G,Pol(:q))","7-element Vector{Pol{Int64}}:\n 1\n qâ´\n qâ¸\n qâ·+qâµ\n qâµ+qÂ³\n qÂ³+q\n qâ¶+qâ´+qÂ²")
@test mytest("ComplexReflectionGroup(2,1,6)","Bâ‚†")
@test mytest("W=ComplexReflectionGroup(30)","Hâ‚„")
@test mytest("degrees(W)","4-element Vector{Int64}:\n  2\n 12\n 20\n 30")
@test mytest("length(W)","14400")
@test mytest("W=coxgroup(:E,6)","Eâ‚†")
@test mytest("WF=spets(W)","Eâ‚†")
@test mytest("phi=W(6,5,4,2,3,1,4,3,5,4,2,6,5,4,3,1);","nothing")
@test mytest("HF=subspets(WF,2:5,phi)","Eâ‚†â‚â‚‚â‚ƒâ‚„â‚…â‚=Â³Dâ‚„Î¦â‚ƒ")
@test mytest("Diagram(HF)","Ï• acts as (1,2,4) on the component below\n  O 2\n  ï¿¨\nOâ€”Oâ€”O\n1 3 4")
@test mytest("degrees(HF)","6-element Vector{Tuple{Int64, Cyc{Int64}}}:\n (1, Î¶â‚ƒ)\n (1, Î¶â‚ƒÂ²)\n (2, 1)\n (4, Î¶â‚ƒ)\n (6, 1)\n (4, Î¶â‚ƒÂ²)")
@test mytest("W=ComplexReflectionGroup(4)","Gâ‚„")
@test mytest("codegrees(W)","2-element Vector{Int64}:\n 0\n 2")
end
@testset "Cosets.jl" begin
@test mytest("W=ComplexReflectionGroup(14)","Gâ‚â‚„")
@test mytest("R=reflection_subgroup(W,[2,4])","Gâ‚â‚„â‚â‚‚â‚„â‚=Gâ‚…")
@test mytest("RF=spets(R,W(1))","Gâ‚â‚„â‚â‚‚â‚„â‚=Â²Gâ‚…")
@test mytest("degrees(RF)","2-element Vector{Tuple{Int64, Cyc}}:\n (6, 1)\n (12, -1)")
@test mytest("W=coxgroup(:B,2)","Bâ‚‚")
@test mytest("W=coxgroup(:Bsym,2)","Bsymâ‚‚")
@test mytest("WF=spets(W,Perm(1,2))","Â²Bsymâ‚‚")
@test mytest("CharTable(WF)","CharTable(Â²Bsymâ‚‚)\n   â”‚    1 121\nâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n2. â”‚1   1   1\n.11â”‚1  -1  -1\n1.1â”‚. -âˆš2  âˆš2")
@test mytest("W=coxgroup(:Bsym,2)","Bsymâ‚‚")
@test mytest("WF=spets(W,Perm(1,2))","Â²Bsymâ‚‚")
@test mytest("subspets(WF,Int[],W(1))","Bsymâ‚‚â‚â‚=Î¦â€´â‚ˆ")
@test mytest("W=coxgroup(:B,2)","Bâ‚‚")
@test mytest("twistings(W,[1])","2-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Bâ‚‚â‚â‚â‚=AÌƒâ‚Î¦â‚\n Bâ‚‚â‚â‚â‚=AÌƒâ‚Î¦â‚‚")
@test mytest("twistings(W,[2])","2-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Bâ‚‚â‚â‚‚â‚=Aâ‚Î¦â‚‚\n Bâ‚‚â‚â‚‚â‚=Aâ‚Î¦â‚")
@test mytest("W=coxgroup(:B,2)","Bâ‚‚")
@test mytest("twistings(W,[2,4])","2-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Bâ‚‚â‚â‚‚â‚„â‚=(Aâ‚Aâ‚)\n Bâ‚‚â‚â‚‚â‚„â‚=Aâ‚Ã—Aâ‚")
@test mytest("W=coxgroup(:E,6)","Eâ‚†")
@test mytest("WF=spets(W,Perm(1,6)*Perm(3,5))","Â²Eâ‚†")
@test mytest("twistings(W,2:5)","3-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Eâ‚†â‚â‚‚â‚…â‚„â‚ƒâ‚=Â²Dâ‚„â‚â‚â‚„â‚ƒâ‚‚â‚Î¦â‚Î¦â‚‚\n Eâ‚†â‚â‚‚â‚ƒâ‚„â‚…â‚=Â³Dâ‚„Î¦â‚ƒ\n Eâ‚†â‚â‚‚â‚ƒâ‚„â‚…â‚=Dâ‚„Î¦â‚Â²")
@test mytest("twistings(WF,2:5)","3-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Eâ‚†â‚â‚ƒâ‚…â‚„â‚‚â‚=Â²Dâ‚„â‚â‚‚â‚„â‚ƒâ‚â‚Î¦â‚Î¦â‚‚\n Eâ‚†â‚â‚‚â‚ƒâ‚„â‚…â‚=Dâ‚„Î¦â‚‚Â²\n Eâ‚†â‚â‚‚â‚ƒâ‚„â‚…â‚=Â³Dâ‚„Î¦â‚†")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("Cosets.graph_automorphisms(refltype(W*W))","Group([(1,5)(2,6)(3,7)(4,8),(1,2),(1,4)])")
@test mytest("twistings(coxgroup(:A,3)*coxgroup(:A,3))","8-element Vector{Spets{FiniteCoxeterGroup{Perm{Int16},Int64}}}:\n (Aâ‚ƒAâ‚ƒ)\n Â²(Aâ‚ƒAâ‚ƒ)\n Â²(Aâ‚ƒAâ‚ƒ)â‚â‚â‚‚â‚ƒâ‚†â‚…â‚„â‚\n (Aâ‚ƒAâ‚ƒ)â‚â‚â‚‚â‚ƒâ‚†â‚…â‚„â‚\n Â²Aâ‚ƒÃ—Aâ‚ƒ\n Â²Aâ‚ƒÃ—Â²Aâ‚ƒ\n Aâ‚ƒÃ—Aâ‚ƒ\n Aâ‚ƒÃ—Â²Aâ‚ƒ")
@test mytest("twistings(coxgroup(:D,4))","6-element Vector{Spets{FiniteCoxeterGroup{Perm{Int16},Int64}}}:\n Â³Dâ‚„â‚â‚â‚„â‚ƒâ‚‚â‚\n Â²Dâ‚„â‚â‚â‚„â‚ƒâ‚‚â‚\n Â³Dâ‚„\n Â²Dâ‚„\n Â²Dâ‚„â‚â‚‚â‚„â‚ƒâ‚â‚\n Dâ‚„")
@test mytest("W=rootdatum(:so,8)","Dâ‚„")
@test mytest("twistings(W)","2-element Vector{Spets{FiniteCoxeterGroup{Perm{Int16},Int64}}}:\n Â²Dâ‚„\n Dâ‚„")
@test mytest("W=rootdatum(:gl,3)","Aâ‚‚Î¦â‚")
@test mytest("gu3=spets(W,-reflrep(W,W()))","Â²Aâ‚‚Î¦â‚‚")
@test mytest("F4=coxgroup(:F,4);D4=reflection_subgroup(F4,[1,2,16,48])","Fâ‚„â‚â‚‰â€šâ‚‚â€šâ‚â€šâ‚â‚†â‚=Dâ‚„â‚â‚ƒâ‚‚â‚â‚„â‚")
@test mytest("spets(D4,[1 0 0 0;0 1 2 0;0 0 0 1;0 0 -1 -1])","Fâ‚„â‚â‚‰â€šâ‚â‚†â€šâ‚â€šâ‚‚â‚=Â³Dâ‚„â‚â‚ƒâ‚„â‚â‚‚â‚")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("spets(W,Perm(1,3))","Â²Aâ‚ƒ")
@test mytest("torus([0 -1;1 -1])","Î¦â‚ƒ")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("twistings(W,Int[])","5-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Aâ‚ƒâ‚â‚=Î¦â‚Â³\n Aâ‚ƒâ‚â‚=Î¦â‚Â²Î¦â‚‚\n Aâ‚ƒâ‚â‚=Î¦â‚Î¦â‚‚Â²\n Aâ‚ƒâ‚â‚=Î¦â‚Î¦â‚ƒ\n Aâ‚ƒâ‚â‚=Î¦â‚‚Î¦â‚„")
@test mytest("torus(W,2)","Aâ‚ƒâ‚â‚=Î¦â‚Â²Î¦â‚‚")
@test mytest("WF=spets(W,Perm(1,3))","Â²Aâ‚ƒ")
@test mytest("twistings(WF,Int[])","5-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Aâ‚ƒâ‚â‚=Î¦â‚‚Â³\n Aâ‚ƒâ‚â‚=Î¦â‚Î¦â‚‚Â²\n Aâ‚ƒâ‚â‚=Î¦â‚Â²Î¦â‚‚\n Aâ‚ƒâ‚â‚=Î¦â‚‚Î¦â‚†\n Aâ‚ƒâ‚â‚=Î¦â‚Î¦â‚„")
@test mytest("torus(WF,2)","Aâ‚ƒâ‚â‚=Î¦â‚Î¦â‚‚Â²")
@test mytest("WF=spets(coxgroup(:F,4))","Fâ‚„")
@test mytest("w=transporting_elt(Group(WF),[1,2,9,16],[1,9,16,2],action=(s,g)->s.^g);","nothing")
@test mytest("LF=subspets(WF,[1,2,9,16],w)","Fâ‚„â‚â‚‰â€šâ‚â‚†â€šâ‚â€šâ‚‚â‚=Â³Dâ‚„â‚â‚ƒâ‚„â‚â‚‚â‚")
@test mytest("Diagram(LF)","Ï• acts as (2,3,4) on the component below\n  O 4\n  ï¿¨\nOâ€”Oâ€”O\n3 1 2")
@test mytest("spets(\"3G422\")","Â³Gâ‚„â€šâ‚‚â€šâ‚‚")
@test mytest("spets(\"2G5\")","Â²Gâ‚…")
@test mytest("spets(\"3G333\")","Gâ‚ƒâ€šâ‚ƒâ€šâ‚ƒâ‚â‚â€šâ‚‚â€šâ‚ƒâ€šâ‚„â‚„â‚=Â³Gâ‚ƒâ€šâ‚ƒâ€šâ‚ƒâ‚â‚â€šâ‚‚â€šâ‚ƒâ€šâ‚„â‚„â‚")
@test mytest("spets(\"3pG333\")","Gâ‚ƒâ€šâ‚ƒâ€šâ‚ƒâ‚â‚â€šâ‚‚â€šâ‚ƒâ€šâ‚„â‚„â‚=Â³Gâ‚ƒâ€šâ‚ƒâ€šâ‚ƒâ‚â‚â€šâ‚‚â€šâ‚ƒâ€šâ‚„â‚„â‚")
@test mytest("spets(\"4G333\")","Gâ‚ƒâ€šâ‚ƒâ€šâ‚ƒâ‚â‚â€šâ‚‚â€šâ‚ƒâ€šâ‚â‚‚â‚=â´Gâ‚ƒâ€šâ‚ƒâ€šâ‚ƒâ‚â‚â€šâ‚‚â€šâ‚ƒâ€šâ‚â‚‚â‚")
end
@testset "CoxGroups.jl" begin
@test mytest("W=CoxSym(4)","ğ”– â‚„")
@test mytest("p=W(1,3,2,1,3)","Perm{UInt8}: (1,4)")
@test mytest("word(W,p)","5-element Vector{Int64}:\n 1\n 2\n 3\n 2\n 1")
@test mytest("word(W,longest(W))","6-element Vector{Int64}:\n 1\n 2\n 1\n 3\n 2\n 1")
@test mytest("w0=longest(W)","Perm{UInt8}: (1,4)(2,3)")
@test mytest("length(W,w0)","6")
@test mytest("map(i->word(W,reflection(W,i)),1:nref(W))","6-element Vector{Vector{Int64}}:\n [1]\n [2]\n [3]\n [1, 2, 1]\n [2, 3, 2]\n [1, 2, 3, 2, 1]")
@test mytest("[length(elements(W,i)) for i in 0:nref(W)]","7-element Vector{Int64}:\n 1\n 3\n 5\n 6\n 5\n 3\n 1")
@test mytest("W=CoxSym(3)","ğ”– â‚ƒ")
@test mytest("firstleftdescent(W,Perm(2,3))","2")
@test mytest("W=CoxSym(3)","ğ”– â‚ƒ")
@test mytest("leftdescents(W,Perm(1,3))","2-element Vector{Int64}:\n 1\n 2")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("w=perm\"(1,11)(3,10)(4,9)(5,7)(6,12)\"","(1,11)(3,10)(4,9)(5,7)(6,12)")
@test mytest("w in W","true")
@test mytest("word(W,w)","5-element Vector{Int64}:\n 1\n 2\n 3\n 2\n 1")
@test mytest("W=CoxSym(4)","ğ”– â‚„")
@test mytest("p=W(1,2,3,1,2,3)","Perm{UInt8}: (1,3)(2,4)")
@test mytest("length(W,p)","4")
@test mytest("word(W,p)","4-element Vector{Int64}:\n 2\n 1\n 3\n 2")
@test mytest("longest(CoxSym(4))","Perm{UInt8}: (1,4)(2,3)")
@test mytest("longest(CoxSym(4))","Perm{UInt8}: (1,4)(2,3)")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("H=reflection_subgroup(W,[2,6])","Gâ‚‚â‚â‚‚â‚†â‚=AÌƒâ‚Ã—Aâ‚")
@test mytest("word.(Ref(W),unique(reduced.(Ref(H),elements(W))))","3-element Vector{Vector{Int64}}:\n []\n [1]\n [1, 2]")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("H=reflection_subgroup(W,[2,6])","Gâ‚‚â‚â‚‚â‚†â‚=AÌƒâ‚Ã—Aâ‚")
@test mytest("[word(W,w) for S in reduced(H,W) for w in S]","3-element Vector{Vector{Int64}}:\n []\n [1]\n [1, 2]")
@test mytest("W=coxgroup(:H,3)","Hâ‚ƒ")
@test mytest("w=W(1,2,1,3);","nothing")
@test mytest("b=filter(x->bruhatless(W,x,w),elements(W));","nothing")
@test mytest("word.(Ref(W),b)","12-element Vector{Vector{Int64}}:\n []\n [3]\n [2]\n [1]\n [2, 3]\n [1, 3]\n [2, 1]\n [1, 2]\n [2, 1, 3]\n [1, 2, 3]\n [1, 2, 1]\n [1, 2, 1, 3]")
@test mytest("W=CoxSym(3)","ğ”– â‚ƒ")
@test mytest("bruhatless(W,Perm(1,3))","4-element Vector{Vector{Perm{Int16}}}:\n [()]\n [(1,2), (2,3)]\n [(1,2,3), (1,3,2)]\n [(1,3)]")
@test mytest("W=coxgroup(:A,2)","Aâ‚‚")
@test mytest("Poset(W)",".<1,2<21,12<121")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("Poset(W,W(1,3))",".<3,1<13")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("words(W,longest(W))","16-element Vector{Vector{Int64}}:\n [1, 2, 1, 3, 2, 1]\n [1, 2, 3, 1, 2, 1]\n [1, 2, 3, 2, 1, 2]\n [1, 3, 2, 1, 3, 2]\n [1, 3, 2, 3, 1, 2]\n [2, 1, 2, 3, 2, 1]\n [2, 1, 3, 2, 1, 3]\n [2, 1, 3, 2, 3, 1]\n [2, 3, 1, 2, 1, 3]\n [2, 3, 1, 2, 3, 1]\n [2, 3, 2, 1, 2, 3]\n [3, 1, 2, 1, 3, 2]\n [3, 1, 2, 3, 1, 2]\n [3, 2, 1, 2, 3, 2]\n [3, 2, 1, 3, 2, 3]\n [3, 2, 3, 1, 2, 3]")
@test mytest("CoxGroups.standard_parabolic_class(coxgroup(:E,8),[7,8])","7-element Vector{Vector{Int64}}:\n [7, 8]\n [6, 7]\n [5, 6]\n [4, 5]\n [2, 4]\n [3, 4]\n [1, 3]")
@test mytest("C=cartan(:H,3)","3Ã—3 Matrix{Cyc{Int64}}:\n       2  Î¶â‚…Â²+Î¶â‚…Â³   0\n Î¶â‚…Â²+Î¶â‚…Â³        2  -1\n       0       -1   2")
@test mytest("coxmat(C)","3Ã—3 Matrix{Int64}:\n 1  5  2\n 5  1  3\n 2  3  1")
@test mytest("W=CoxSym(4)","ğ”– â‚„")
@test mytest("coxmat(W)","3Ã—3 Matrix{Int64}:\n 1  3  2\n 3  1  3\n 2  3  1")
@test mytest("W=ComplexReflectionGroup(29)","Gâ‚‚â‚‰")
@test mytest("braid_relations(W)","7-element Vector{Vector{Vector{Int64}}}:\n [[1, 2, 1], [2, 1, 2]]\n [[2, 4, 2], [4, 2, 4]]\n [[3, 4, 3], [4, 3, 4]]\n [[2, 3, 2, 3], [3, 2, 3, 2]]\n [[1, 3], [3, 1]]\n [[1, 4], [4, 1]]\n [[4, 3, 2, 4, 3, 2], [3, 2, 4, 3, 2, 4]]")
@test mytest("W=CoxSym(3)","ğ”– â‚ƒ")
@test mytest("e=elements(W)","6-element Vector{Perm{UInt8}}:\n ()\n (2,3)\n (1,2)\n (1,2,3)\n (1,3,2)\n (1,3)")
@test mytest("length.(Ref(W),e)","6-element Vector{Int64}:\n 0\n 1\n 1\n 2\n 2\n 3")
@test mytest("W=CoxSym(3)","ğ”– â‚ƒ")
@test mytest("isleftdescent(W,Perm(1,2),1)","true")
@test mytest("W=GenCox([2 -2;-2 2])","GenCox([2 -2; -2 2])")
end
@testset "CycPols.jl" begin
@test mytest("q=Pol(:q)","Pol{Int64}: q")
@test mytest("p=CycPol(q^25-q^24-2q^23-q^2+q+2)","(q-2)Î¦â‚Î¦â‚‚Î¦â‚‚â‚ƒ")
@test mytest("p(q)","Pol{Int64}: qÂ²âµ-qÂ²â´-2qÂ²Â³-qÂ²+q+2")
@test mytest("p*inv(CycPol(q^2+q+1))","(q-2)Î¦â‚Î¦â‚‚Î¦â‚ƒâ»Â¹Î¦â‚‚â‚ƒ")
@test mytest("cyclotomic_polynomial(5)","Pol{Int64}: qâ´+qÂ³+qÂ²+q+1")
@test mytest("cyclotomic_polynomial(24)","Pol{Int64}: qâ¸-qâ´+1")
@test mytest("CycPol(3*q^3-3)","3Î¦â‚Î¦â‚ƒ")
end
@testset "Cycs.jl" begin
@test mytest("E(3)+E(4)","Cyc{Int64}: Î¶â‚â‚‚â´-Î¶â‚â‚‚â·-Î¶â‚â‚‚Â¹Â¹")
@test mytest("E(3,2)","Cyc{Int64}: Î¶â‚ƒÂ²")
@test mytest("1+E(3,2)","Cyc{Int64}: -Î¶â‚ƒ")
@test mytest("a=E(4)-E(4)","Cyc{Int64}: 0")
@test mytest("conductor(a)","1")
@test mytest("typeof(convert(Int,a))","Int64")
@test mytest("inv(1+E(4))","Cyc{Rational{Int64}}: (1-Î¶â‚„)/2")
@test mytest("inv(E(5)+E(5,4))","Cyc{Int64}: -Î¶â‚…Â²-Î¶â‚…Â³")
@test mytest("Cyc(1//2+im)","Cyc{Rational{Int64}}: (1+2Î¶â‚„)/2")
@test mytest("conj(1+E(4))","Cyc{Int64}: 1-Î¶â‚„")
@test mytest("real(E(5))","Cyc{Rational{Int64}}: (-1+âˆš5)/4")
@test mytest("imag(E(5))","Cyc{Rational{Int64}}: (Î¶â‚…-Î¶â‚…â´)/2")
@test mytest("c=E(9)","Cyc{Int64}: -Î¶â‚‰â´-Î¶â‚‰â·")
@test mytest("Root1(c)","Root1: Î¶â‚‰")
@test mytest("Root1(1+E(4))","nothing")
@test mytest("Root1(4,1)","Root1: Î¶â‚„")
@test mytest("c=Root1(;r=1//4)*Root1(3,1)","Root1: Î¶â‚â‚‚â·")
@test mytest("E(c)","Cyc{Int64}: Î¶â‚â‚‚â·")
@test mytest("c=Complex{Float64}(E(3))","-0.4999999999999998 + 0.8660254037844387im")
@test mytest("-1<Cyc(0)<1","true")
@test mytest("conductor(E(9))","9")
@test mytest("conductor([E(3),1//2,E(4)])","12")
@test mytest("coefficients(E(9))","9-element Vector{Int64}:\n  0\n  0\n  0\n  0\n -1\n  0\n  0\n -1\n  0")
@test mytest("galois(1+E(4),-1)","Cyc{Int64}: 1-Î¶â‚„")
@test mytest("galois(ER(5),2)==-ER(5)","true")
@test mytest("ER(-1)","Cyc{Int64}: Î¶â‚„")
@test mytest("ER(3)","Cyc{Int64}: âˆš3")
@test mytest("r=Root1(-E(9,2)-E(9,5))","Root1: Î¶â‚‰â¸")
@test mytest("conductor(r)","9")
@test mytest("exponent(r)","8")
@test mytest("E(r)","Cyc{Int64}: -Î¶â‚‰Â²-Î¶â‚‰âµ")
@test mytest("Root1(-E(9,4)-E(9,5))","nothing")
@test mytest("Quadratic(1+E(3))","(1+âˆš-3)/2")
@test mytest("Quadratic(1+E(5))","nothing")
@test mytest("root(-1)","Cyc{Int64}: Î¶â‚„")
@test mytest("root(E(4))","Cyc{Int64}: Î¶â‚ˆ")
@test mytest("root(27,6)","Cyc{Int64}: âˆš3")
end
@testset "Eigenspaces.jl" begin
@test mytest("W=coxgroup(:E,8)","Eâ‚ˆ")
@test mytest("relative_degrees(W,4)","4-element Vector{Int64}:\n  8\n 12\n 20\n 24")
@test mytest("regular_eigenvalues(coxgroup(:G,2))","6-element Vector{Root1}:\n   1\n  -1\n  Î¶â‚ƒ\n Î¶â‚ƒÂ²\n  Î¶â‚†\n Î¶â‚†âµ")
@test mytest("W=ComplexReflectionGroup(6)","Gâ‚†")
@test mytest("L=twistings(W,[2])[4]","Gâ‚†â‚â‚‚â‚=Gâ‚ƒâ€šâ‚â€šâ‚[Î¶â‚„]Î¦â€²â‚„")
@test mytest("regular_eigenvalues(L)","3-element Vector{Root1}:\n    Î¶â‚„\n  Î¶â‚â‚‚â·\n Î¶â‚â‚‚Â¹Â¹")
@test mytest("W=coxgroup(:E,8)","Eâ‚ˆ")
@test mytest("position_regular_class(W,30)","65")
@test mytest("W=ComplexReflectionGroup(6)","Gâ‚†")
@test mytest("L=twistings(W,[2])[4]","Gâ‚†â‚â‚‚â‚=Gâ‚ƒâ€šâ‚â€šâ‚[Î¶â‚„]Î¦â€²â‚„")
@test mytest("position_regular_class(L,7//12)","2")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("w=W(1:3...)","(1,12,3,2)(4,11,10,5)(6,9,8,7)")
@test mytest("p=eigenspace_projector(W,w,1//4)","3Ã—3 Matrix{Cyc{Rational{Int64}}}:\n  (1+Î¶â‚„)/4   Î¶â‚„/2  (-1+Î¶â‚„)/4\n  (1-Î¶â‚„)/4    1/2   (1+Î¶â‚„)/4\n (-1-Î¶â‚„)/4  -Î¶â‚„/2   (1-Î¶â‚„)/4")
@test mytest("GLinearAlgebra.rank(p)","1")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("split_levis(W,4)","2-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Aâ‚ƒ\n Aâ‚ƒâ‚â‚=Î¦â‚‚Î¦â‚„")
@test mytest("W=spets(coxgroup(:D,4),Perm(1,2,4))","Â³Dâ‚„")
@test mytest("split_levis(W,3)","3-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Â³Dâ‚„\n Dâ‚„â‚â‚â‚ƒâ‚=Aâ‚‚Î¦â‚ƒ\n Dâ‚„â‚â‚=Î¦â‚ƒÂ²")
@test mytest("W=coxgroup(:E,8)","Eâ‚ˆ")
@test mytest("split_levis(W,4,2)","3-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Eâ‚ˆâ‚â‚ƒâ‚‚â‚„â‚…â‚=Dâ‚„â‚â‚â‚ƒâ‚‚â‚„â‚Î¦â‚„Â²\n Eâ‚ˆâ‚â‚…â‚‡â‚‚â‚ƒâ‚=(Aâ‚Aâ‚)Ã—(Aâ‚Aâ‚)Î¦â‚„Â²\n Eâ‚ˆâ‚â‚ƒâ‚â‚…â‚†â‚=Â²(Aâ‚‚Aâ‚‚)â‚â‚â‚„â‚‚â‚ƒâ‚Î¦â‚„Â²")
@test mytest("split_levis(ComplexReflectionGroup(5))","4-element Vector{Spets{PRSG{Cyc{Rational{Int64}}, Int16}}}:\n Gâ‚…\n Gâ‚…â‚â‚â‚=Gâ‚ƒâ€šâ‚â€šâ‚Î¦â‚\n Gâ‚…â‚â‚‚â‚=Gâ‚ƒâ€šâ‚â€šâ‚Î¦â‚\n Gâ‚…â‚â‚=Î¦â‚Â²")
end
@testset "FFields.jl" begin
@test mytest("a=Mod{19}(5)","Mod{19}(5)")
@test mytest("a^2","Mod{19}(6)")
@test mytest("inv(a)","Mod{19}(4)")
@test mytest("a*inv(a)","Mod{19}(1)")
@test mytest("a+2","Mod{19}(7)")
@test mytest("a*2","Mod{19}(10)")
@test mytest("a+1//2","Mod{19}(15)")
@test mytest("Int(a)","5")
@test mytest("order(a)","9")
@test mytest("a=Z(64)","Zâ‚†â‚„")
@test mytest("a^9","Zâ‚ˆ")
@test mytest("a^21","Zâ‚„")
@test mytest("a+1","Zâ‚†â‚„âµâ¶")
@test mytest("a=Z(19)+3","Zâ‚â‚‰Â¹â¶")
@test mytest("Mod{19}(a)","Mod{19}(5)")
@test mytest("order(a)","9")
@test mytest("a=Z(8)^5","Zâ‚ˆâµ")
@test mytest("F=field(a)","FF(2^3)")
@test mytest("F.p","2")
@test mytest("F.n","3")
@test mytest("F.q","8")
@test mytest("log(a)","5")
@test mytest("FFE{19}(2)","Zâ‚â‚‰")
@test mytest("FFE{19}(Mod{19}(2))","Zâ‚â‚‰")
end
@testset "Families.jl" begin
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("uc=UnipotentCharacters(W);","nothing")
@test mytest("uc.families","3-element Vector{Family}:\n Family(D(ğ”– â‚ƒ),[5, 6, 4, 3, 8, 7, 9, 10])\n Family(Câ‚,[1])\n Family(Câ‚,[2])")
@test mytest("uc.families[1]","Family(D(ğ”– â‚ƒ),[5, 6, 4, 3, 8, 7, 9, 10])\nDrinfeld double of ğ”– â‚ƒ, Lusztigâ€²s version\n   labelâ”‚eigen\nâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n(1,1)   â”‚    1 1//6  1//2  1//3  1//3  1//6  1//2  1//3  1//3\n(gâ‚‚,1)  â”‚    1 1//2  1//2  0//1  0//1 -1//2 -1//2  0//1  0//1\n(gâ‚ƒ,1)  â”‚    1 1//3  0//1  2//3 -1//3  1//3  0//1 -1//3 -1//3\n(1,Ï)   â”‚    1 1//3  0//1 -1//3  2//3  1//3  0//1 -1//3 -1//3\n(1,Îµ)   â”‚    1 1//6 -1//2  1//3  1//3  1//6 -1//2  1//3  1//3\n(gâ‚‚,Îµ)  â”‚   -1 1//2 -1//2  0//1  0//1 -1//2  1//2  0//1  0//1\n(gâ‚ƒ,Î¶â‚ƒ) â”‚   Î¶â‚ƒ 1//3  0//1 -1//3 -1//3  1//3  0//1  2//3 -1//3\n(gâ‚ƒ,Î¶â‚ƒÂ²)â”‚  Î¶â‚ƒÂ² 1//3  0//1 -1//3 -1//3  1//3  0//1 -1//3  2//3")
@test mytest("charnames(uc)[uc.families[1].charNumbers]","8-element Vector{String}:\n \"phi2,1\"\n \"phi2,2\"\n \"phi1,3''\"\n \"phi1,3'\"\n \"G2[1]\"\n \"G2[-1]\"\n \"G2[E3]\"\n \"G2[E3^2]\"")
@test mytest("Family(\"C2\")","Family(Câ‚‚,4)\nDrinfeldDouble(Z/2)\n labelâ”‚eigen\nâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n(1,1) â”‚    1 1//2  1//2  1//2  1//2\n(gâ‚‚,1)â”‚    1 1//2  1//2 -1//2 -1//2\n(1,Îµ) â”‚    1 1//2 -1//2  1//2 -1//2\n(gâ‚‚,Îµ)â”‚   -1 1//2 -1//2 -1//2  1//2")
@test mytest("Family(\"C2\",4:7,Dict(:signs=>[1,-1,1,-1]))","Family(Câ‚‚,4:7)\nDrinfeldDouble(Z/2)\n labelâ”‚eigen signs\nâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n(1,1) â”‚    1     1  1//2 -1//2 1//2 -1//2\n(gâ‚‚,1)â”‚    1    -1 -1//2  1//2 1//2 -1//2\n(1,Îµ) â”‚    1     1  1//2  1//2 1//2  1//2\n(gâ‚‚,Îµ)â”‚   -1    -1 -1//2 -1//2 1//2  1//2")
@test mytest("f=UnipotentCharacters(ComplexReflectionGroup(3,1,1)).families[2]","Family(0011,[4, 3, 2])\nclassical family\nlabelâ”‚eigen      1        2        3\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1    â”‚  Î¶â‚ƒÂ²  âˆš-3/3    âˆš-3/3   -âˆš-3/3\n2    â”‚    1  âˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3 -Î¶â‚ƒâˆš-3/3\n3    â”‚    1 -âˆš-3/3 -Î¶â‚ƒâˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3")
@test mytest("galois(f,-1)","Family(overline 0011,[4, 3, 2])\nComplexConjugate(classical family)\nlabelâ”‚eigen      1        2        3\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1    â”‚   Î¶â‚ƒ -âˆš-3/3   -âˆš-3/3    âˆš-3/3\n2    â”‚    1 -âˆš-3/3 -Î¶â‚ƒâˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3\n3    â”‚    1  âˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3 -Î¶â‚ƒâˆš-3/3")
@test mytest("f=UnipotentCharacters(ComplexReflectionGroup(3,1,1)).families[2]","Family(0011,[4, 3, 2])\nclassical family\nlabelâ”‚eigen      1        2        3\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1    â”‚  Î¶â‚ƒÂ²  âˆš-3/3    âˆš-3/3   -âˆš-3/3\n2    â”‚    1  âˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3 -Î¶â‚ƒâˆš-3/3\n3    â”‚    1 -âˆš-3/3 -Î¶â‚ƒâˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3")
@test mytest("f^Perm(1,2,3)","Family(0011,[2, 4, 3])\nPermuted((1,2,3),classical family)\nlabelâ”‚eigen        3      1        2\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n3    â”‚    1 Î¶â‚ƒÂ²âˆš-3/3 -âˆš-3/3 -Î¶â‚ƒâˆš-3/3\n1    â”‚  Î¶â‚ƒÂ²   -âˆš-3/3  âˆš-3/3    âˆš-3/3\n2    â”‚    1 -Î¶â‚ƒâˆš-3/3  âˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3")
@test mytest("Families.ndrinfeld_double(ComplexReflectionGroup(5))","378")
@test mytest("Family(family_imprimitive([[0,1],[1],[0]]))","Family(0011,3)\nclassical family\nlabelâ”‚eigen      1        2        3\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1    â”‚  Î¶â‚ƒÂ²  âˆš-3/3   -âˆš-3/3    âˆš-3/3\n2    â”‚    1 -âˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3 -Î¶â‚ƒâˆš-3/3\n3    â”‚    1  âˆš-3/3 -Î¶â‚ƒâˆš-3/3 Î¶â‚ƒÂ²âˆš-3/3")
@test mytest("FamiliesClassical(symbols(2,3,1))","6-element Vector{Family}:\n Family(0112233,[4])\n Family(3,[9])\n Family(013,[5, 7, 10, 12])\n Family(112,[2])\n Family(022,[6])\n Family(01123,[1, 3, 8, 11])")
@test mytest("W=ComplexReflectionGroup(4)","Gâ‚„")
@test mytest("uc=UnipotentCharacters(W);f=uc.families[4];","nothing")
@test mytest("A=fusion_algebra(fourier(f),1)","Fusion Algebra dim.5")
@test mytest("b=basis(A)","5-element Vector{AlgebraElt{Gapjm.Families.FusionAlgebra, Int64}}:\n Bâ‚\n Bâ‚‚\n Bâ‚ƒ\n Bâ‚„\n Bâ‚…")
@test mytest("b*permutedims(b)","5Ã—5 Matrix{AlgebraElt{Gapjm.Families.FusionAlgebra, Int64}}:\n Bâ‚  Bâ‚‚      Bâ‚ƒ      Bâ‚„        Bâ‚…\n Bâ‚‚  -Bâ‚„+Bâ‚…  Bâ‚+Bâ‚„   Bâ‚‚-Bâ‚ƒ     Bâ‚ƒ\n Bâ‚ƒ  Bâ‚+Bâ‚„   -Bâ‚„+Bâ‚…  -Bâ‚‚+Bâ‚ƒ    Bâ‚‚\n Bâ‚„  Bâ‚‚-Bâ‚ƒ   -Bâ‚‚+Bâ‚ƒ  Bâ‚+Bâ‚„-Bâ‚…  -Bâ‚„\n Bâ‚…  Bâ‚ƒ      Bâ‚‚      -Bâ‚„       Bâ‚")
@test mytest("CharTable(A)","CharTable(Fusion Algebra dim.5)\n â”‚1    2    3  4  5\nâ”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1â”‚1  âˆš-3 -âˆš-3  2 -1\n2â”‚1    1    1  .  1\n3â”‚1   -1   -1  .  1\n4â”‚1    .    . -1 -1\n5â”‚1 -âˆš-3  âˆš-3  2 -1")
end
@testset "GLinearAlgebra.jl" begin
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("M=[q^6 q^0 q^3 q^3 q^5+q q^4+q^2; q^0 q^6 q^3 q^3 q^5+q q^4+q^2; q^3 q^3 q^6 q^0 q^4+q^2 q^5+q; q^3 q^3 q^0 q^6 q^4+q^2 q^5+q; q^5+q q^5+q q^4+q^2 q^4+q^2 q^6+q^4+q^2+1 q^5+2*q^3+q; q^4+q^2 q^4+q^2 q^5+q q^5+q q^5+2*q^3+q q^6+q^4+q^2+1]","6Ã—6 Matrix{Pol{Int64}}:\n qâ¶     1      qÂ³     qÂ³     qâµ+q        qâ´+qÂ²\n 1      qâ¶     qÂ³     qÂ³     qâµ+q        qâ´+qÂ²\n qÂ³     qÂ³     qâ¶     1      qâ´+qÂ²       qâµ+q\n qÂ³     qÂ³     1      qâ¶     qâ´+qÂ²       qâµ+q\n qâµ+q   qâµ+q   qâ´+qÂ²  qâ´+qÂ²  qâ¶+qâ´+qÂ²+1  qâµ+2qÂ³+q\n qâ´+qÂ²  qâ´+qÂ²  qâµ+q   qâµ+q   qâµ+2qÂ³+q    qâ¶+qâ´+qÂ²+1")
@test mytest("bb=[[2],[4],[6],[3,5],[1]];","nothing")
@test mytest("(P,L)=bigcell_decomposition(M,bb);","nothing")
@test mytest("P","6Ã—6 Matrix{Pol{Int64}}:\n 1    0  0    0    0        0\n qâ»â¶  1  qâ»Â³  qâ»Â³  qâ»Â¹+qâ»âµ  qâ»Â²+qâ»â´\n 0    0  1    0    0        0\n qâ»Â³  0  0    1    qâ»Â²      qâ»Â¹\n qâ»Â¹  0  0    0    1        0\n qâ»Â²  0  qâ»Â¹  0    qâ»Â¹      1")
@test mytest("L","6Ã—6 Matrix{Pol{Int64}}:\n qâ¶-qâ´-1+qâ»Â²  0   0            0     0            0\n 0            qâ¶  0            0     0            0\n 0            0   qâ¶-qâ´-1+qâ»Â²  0     0            0\n 0            0   0            qâ¶-1  0            0\n 0            0   0            0     qâ¶-qâ´-1+qâ»Â²  0\n 0            0   0            0     0            qâ¶-1")
@test mytest("M==permutedims(P)*L*P","true")
@test mytest("M=[1 2 3 4;2 3 4 1;3 4 1 2;4 1 2 3]","4Ã—4 Matrix{Int64}:\n 1  2  3  4\n 2  3  4  1\n 3  4  1  2\n 4  1  2  3")
@test mytest("exterior_power(M,2)","6Ã—6 Matrix{Int64}:\n  -1   -2   -7   -1  -10  -13\n  -2   -8  -10  -10  -12    2\n  -7  -10  -13    1    2    1\n  -1  -10    1  -13    2    7\n -10  -12    2    2    8   10\n -13    2    1    7   10   -1")
@test mytest("permanent([0 1 1 1;1 0 1 1;1 1 0 1;1 1 1 0])","9")
@test mytest("permanent([1 1 0 1 0 0 0; 0 1 1 0 1 0 0;0 0 1 1 0 1 0; 0 0 0 1 1 0 1;1 0 0 0 1 1 0;0 1 0 0 0 1 1;1 0 1 0 0 0 1])","24")
@test mytest("m=[1 2;3 4]","2Ã—2 Matrix{Int64}:\n 1  2\n 3  4")
@test mytest("Int.(symmetric_power(m,2))","3Ã—3 Matrix{Int64}:\n 1   2   4\n 6  10  16\n 9  12  16")
@test mytest("m=cartan(:A,3)","3Ã—3 Matrix{Int64}:\n  2  -1   0\n -1   2  -1\n  0  -1   2")
@test mytest("schur_functor(m,[2,2])","6Ã—6 Matrix{Rational{Int64}}:\n   9//1   -6//1    4//1   3//2   -2//1    1//1\n -12//1   16//1  -16//1  -4//1    8//1   -4//1\n   4//1   -8//1   16//1   2//1   -8//1    4//1\n  12//1  -16//1   16//1  10//1  -16//1   12//1\n  -4//1    8//1  -16//1  -4//1   16//1  -12//1\n   1//1   -2//1    4//1   3//2   -6//1    9//1")
@test mytest("m=[0 0 0 1;0 0 1 0;0 1 0 0;1 0 0 0]","4Ã—4 Matrix{Int64}:\n 0  0  0  1\n 0  0  1  0\n 0  1  0  0\n 1  0  0  0")
@test mytest("diagblocks(m)","2-element Vector{Vector{Int64}}:\n [1, 4]\n [2, 3]")
@test mytest("m[[1,4],[1,4]]","2Ã—2 Matrix{Int64}:\n 0  1\n 1  0")
@test mytest("m=[1 0 0 0;0 1 0 0;1 0 1 0;0 0 0 1;0 0 1 0]","5Ã—4 Matrix{Int64}:\n 1  0  0  0\n 0  1  0  0\n 1  0  1  0\n 0  0  0  1\n 0  0  1  0")
@test mytest("blocks(m)","3-element Vector{Tuple{Vector{Int64}, Vector{Int64}}}:\n ([1, 3, 5], [1, 3])\n ([2], [2])\n ([4], [4])")
@test mytest("m[[1,3,5,2,4],[1,3,2,4]]","5Ã—4 Matrix{Int64}:\n 1  0  0  0\n 1  1  0  0\n 0  1  0  0\n 0  0  1  0\n 0  0  0  1")
@test mytest("solutionmat([2 -4 1;0 0 -4;1 -2 -1],[10, -20, -10])","3-element Vector{Rational{Int64}}:\n  5//1\n 15//4\n  0//1")
@test mytest("solutionmat([2 -4 1;0 0 -4;1 -2 -1],[10, 20, -10])","nothing")
end
@testset "Garside.jl" begin
@test mytest("W=coxgroup(:A,4)","Aâ‚„")
@test mytest("B=BraidMonoid(W)","BraidMonoid(Aâ‚„)")
@test mytest("w=B(1,2,3,4)","1234")
@test mytest("w^3","121321432.343")
@test mytest("word(Î±(w^3))","9-element Vector{Int64}:\n 1\n 2\n 1\n 3\n 2\n 1\n 4\n 3\n 2")
@test mytest("w^4","Î”.232432")
@test mytest("inv(w)","(1234)â»Â¹")
@test mytest("repr(w^-1,context=IOContext(stdout,:greedy=>true,:limit=>true))","\"Î”â»Â¹.232432\"")
@test mytest("repr(w)","\"B(1,2,3,4)\"")
@test mytest("repr(w^3)","\"B(1,2,1,3,2,1,4,3,2,3,4,3)\"")
@test mytest("repr(w^-1)","\"B(-4,-3,-2,-1)\"")
@test mytest("b=B(2,1,4,1,4)","214.14")
@test mytest("c=B(1,4,1,4,3)","14.143")
@test mytest("d=conjugating_elt(b,c)","(1)â»Â¹21321432")
@test mytest("b^d","14.143")
@test mytest("centralizer_gens(b)","3-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 321432.213243\n 21.1\n 4")
@test mytest("C=conjcat(b;ss=:ss)","category with 10 objects and 32 generating maps")
@test mytest("C.obj","10-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 1214.4\n 214.14\n 124.24\n 1343.1\n 14.124\n 143.13\n 24.214\n 134.14\n 13.134\n 14.143")
@test mytest("word(W,preferred_prefix(b))","2-element Vector{Int64}:\n 2\n 1")
@test mytest("b^B(preferred_prefix(b))","1214.4")
@test mytest("b1=b^B(preferred_prefix(b))","1214.4")
@test mytest("C=conjcat(b)","category with 2 objects and 6 generating maps")
@test mytest("C.obj","2-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 1214.4\n 1343.1")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(Aâ‚ƒ)")
@test mytest("Pi=B(B.Î´)^2","Î”Â²")
@test mytest("root(Pi,2)","Î”")
@test mytest("root(Pi,3)","1232")
@test mytest("root(Pi,4)","132")
@test mytest("B=BraidMonoid(coxgroup(:A,3))","BraidMonoid(Aâ‚ƒ)")
@test mytest("word(B,B.Î´)","6-element Vector{Int64}:\n 1\n 2\n 1\n 3\n 2\n 1")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(Aâ‚ƒ)")
@test mytest("map(x->B.(x),Garside.left_divisors(B,W(1,3,2)))","4-element Vector{Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}}:\n [.]\n [1, 3]\n [13]\n [132]")
@test mytest("B=DualBraidMonoid(W)","DualBraidMonoid(Aâ‚ƒ,c=[1, 3, 2])")
@test mytest("map(x->B.(x),Garside.left_divisors(B,W(1,3,2)))","4-element Vector{Vector{GarsideElm{Perm{Int16}, DualBraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}}:\n [.]\n [1, 2, 3, 4, 5, 6]\n [12, 13, 15, 25, 34, 45]\n [Î´]")
@test mytest("M=BraidMonoid(coxgroup(:A,2))","BraidMonoid(Aâ‚‚)")
@test mytest("elements(M,4)","12-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 12.21\n 21.12\n 1.1.1.1\n 2.2.2.2\n 1.1.12\n 1.12.2\n 12.2.2\n 2.2.21\n 21.1.1\n 2.21.1\n Î”.1\n Î”.2")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("B=DualBraidMonoid(W)","DualBraidMonoid(Aâ‚ƒ,c=[1, 3, 2])")
@test mytest("B(2,1,2,1,1)","12.1.1.1")
@test mytest("B(-1,-2,-3,1,1)","(25.1)â»Â¹1.1")
@test mytest("B=BraidMonoid(coxgroup(:A,3))","BraidMonoid(Aâ‚ƒ)")
@test mytest("b=B( 2, 1, -3, 1, 1)","(23)â»Â¹321.1.1")
@test mytest("fraction(b)","(23, 321.1.1)")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("b=BraidMonoid(W)(2,1,2,1,1)","121.1.1")
@test mytest("Î±(b)","121")
@test mytest("W=coxgroup(:A,4);B=BraidMonoid(W)","BraidMonoid(Aâ‚„)")
@test mytest("w0=B(longest(W))","Î”")
@test mytest("Î±(w0,[1,2,3])","121321")
@test mytest("B=BraidMonoid(coxgroup(:A,3))","BraidMonoid(Aâ‚ƒ)")
@test mytest("b=B(2,1,2,1,1)*inv(B(2,2))","(21)â»Â¹1.12.21")
@test mytest("word(b)","7-element Vector{Int64}:\n -1\n -2\n  1\n  1\n  2\n  2\n  1")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(Aâ‚ƒ)")
@test mytest("leftgcd(B(2,1,2)^2,B(3,2)^2;complements=true)","(2, (121.21, 32.2))")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("B=BraidMonoid(W)","BraidMonoid(Aâ‚ƒ)")
@test mytest("rightgcd(B(2,1,2)^2,B(3,2)^2;complements=true)","(2.2, (12.21, 23))")
@test mytest("B=BraidMonoid(coxgroup(:A,3))","BraidMonoid(Aâ‚ƒ)")
@test mytest("leftlcm(B(2,1,2)^2,B(3,2)^2;complements=true)","(Î”.121, (123, 23.321))")
@test mytest("B=BraidMonoid(coxgroup(:A,3))","BraidMonoid(Aâ‚ƒ)")
@test mytest("rightlcm(B(2,1,2)^2,B(3,2)^2;complements=true)","(Î”Â², (321.123, 12321.321))")
@test mytest("W=CoxSym(4)","ğ”– â‚„")
@test mytest("b=BraidMonoid(W)(2,1,2,1,1)","121.1.1")
@test mytest("p=image(b)","Perm{UInt8}: (1,3)")
@test mytest("word(W,p)","3-element Vector{Int64}:\n 1\n 2\n 1")
@test mytest("W=coxgroup(:A,4)","Aâ‚„")
@test mytest("w=BraidMonoid(W)(4,3,3,2,1)","43.321")
@test mytest("conjcat(w)","category with 2 objects and 4 generating maps")
@test mytest("conjcat(w).obj","2-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 32143\n 21324")
@test mytest("conjcat(w;ss=:ss).obj","4-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 32143\n 13243\n 21432\n 21324")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("B=BraidMonoid(W)","BraidMonoid(Dâ‚„)")
@test mytest("b=B(2,3,1,2,4,3);b1=B(1,4,3,2,2,2)","1432.2.2")
@test mytest("conjugating_elt(b,b1)","(134312.23)â»Â¹")
@test mytest("c=conjugating_elt(b,b1;ss=:cyc)","232.2")
@test mytest("b^c","1432.2.2")
@test mytest("WF=spets(W,Perm(1,2,4))","Â³Dâ‚„")
@test mytest("F=Frobenius(WF);","nothing")
@test mytest("c=B(3,4,3,1,2,3)","343123")
@test mytest("conjugating_elt(b,c,F)","124312")
@test mytest("^(b,B(1,2,4,3,1,2),F)","343123")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("B=BraidMonoid(W)","BraidMonoid(Dâ‚„)")
@test mytest("w=B(4,4,4)","4.4.4")
@test mytest("cc=centralizer_gens(w)","8-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 1\n (31432)â»Â¹231432\n (1)â»Â¹34.431\n (2)â»Â¹34.432\n (32431)â»Â¹132431\n 4\n 34.43\n 2")
@test mytest("shrink(cc)","5-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 4\n 2\n 1\n 34.43\n (3243)â»Â¹13243")
@test mytest("centralizer_gens(w;ss=:cyc)","Set{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}} with 1 element:\n  4")
@test mytest("F=Frobenius(spets(W,Perm(1,2,4)));","nothing")
@test mytest("centralizer_gens(w,F)","2-element Vector{GarsideElm{Perm{Int16}, BraidMonoid{Perm{Int16}, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n 124\n 312343123")
@test mytest("M=DualBraidMonoid(coxgroup(:A,3))","DualBraidMonoid(Aâ‚ƒ,c=[1, 3, 2])")
@test mytest("p=Presentation(M)","<< presentation with 6 gens and 15 rels of total length 62 >>")
@test mytest("B=BraidMonoid(CoxSym(3))","BraidMonoid(ğ”– â‚ƒ)")
@test mytest("b=[B(1)^3,B(2)^3,B(-2,-1,-1,2,2,2,2,1,1,2),B(1,1,1,2)]","4-element Vector{GarsideElm{Perm{UInt8}, BraidMonoid{Perm{UInt8}, CoxSym{UInt8}}}}:\n 1.1.1\n 2.2.2\n (1.12)â»Â¹2.2.2.21.12\n 1.1.12")
@test mytest("shrink(b)","2-element Vector{GarsideElm{Perm{UInt8}, BraidMonoid{Perm{UInt8}, CoxSym{UInt8}}}}:\n 2\n 1")
end
@testset "Groups.jl" begin
@test mytest("G=Group([Perm(1,2),Perm(1,2,3)])","Group([(1,2),(1,2,3)])")
@test mytest("gens(G)","2-element Vector{Perm{Int16}}:\n (1,2)\n (1,2,3)")
@test mytest("ngens(G)","2")
@test mytest("minimal_words(G)","Dict{Perm{Int16}, Vector{Int64}} with 6 entries:\n  ()      => []\n  (1,2)   => [1]\n  (1,3)   => [1, 2]\n  (1,2,3) => [2]\n  (2,3)   => [2, 1]\n  (1,3,2) => [1, 2, 1]")
@test mytest("G.prop","Dict{Symbol, Any} with 1 entry:\n  :words => Dict(()=>[], (1,2)=>[1], (1,3)=>[1, 2], (1,2,3)=>[2], (2,3)=>[2, 1]â€¦")
@test mytest("G=Group([Perm(1,2),Perm(1,2,3)])","Group([(1,2),(1,2,3)])")
@test mytest("G(2,1,-2)","(1,3)")
@test mytest("orbit([Perm(1,2),Perm(2,3)],1)","3-element Vector{Int64}:\n 1\n 2\n 3")
@test mytest("orbit([Perm(1,2),Perm(2,3)],[1,3];action=(v,g)->v.^g)","6-element Vector{Vector{Int64}}:\n [1, 3]\n [2, 3]\n [1, 2]\n [3, 2]\n [2, 1]\n [3, 1]")
@test mytest("orbit([Perm(1,2),Perm(2,3)],[1,3];action=(v,g)->sort(v.^g))","3-element Vector{Vector{Int64}}:\n [1, 3]\n [2, 3]\n [1, 2]")
@test mytest("G=Group([Perm(1,2),Perm(2,3)]);","nothing")
@test mytest("transversal(G,1)","Dict{Int64, Perm{Int16}} with 3 entries:\n  2 => (1,2)\n  3 => (1,3,2)\n  1 => ()")
@test mytest("transversal(G,[1,2],action=(x,y)->x.^y)","Dict{Vector{Int64}, Perm{Int16}} with 6 entries:\n  [3, 2] => (1,3)\n  [1, 2] => ()\n  [2, 1] => (1,2)\n  [1, 3] => (2,3)\n  [2, 3] => (1,2,3)\n  [3, 1] => (1,3,2)")
@test mytest("G=Group([Perm(1,2),Perm(2,3)]);","nothing")
@test mytest("orbits(G,1:4)","2-element Vector{Vector{Int64}}:\n [1, 2, 3]\n [4]")
@test mytest("G=Group([Perm(1,2),Perm(1,2,3)]);","nothing")
@test mytest("centralizer(G,1)","Group([(2,3)])")
@test mytest("G=Group([Perm(1,2),Perm(1,2,3,4)])","Group([(1,2),(1,2,3,4)])")
@test mytest("centralizer(G,[1,2];action=(s,g)->sort(s.^g))","Group([(3,4),(1,2),(1,2)(3,4)])")
@test mytest("stabilizer(G,[1,2])","Group([(3,4),(1,2),(1,2)(3,4)])")
@test mytest("G=Group([Perm(1,2),Perm(1,2,3)]);","nothing")
@test mytest("minimal_words(G)","Dict{Perm{Int16}, Vector{Int64}} with 6 entries:\n  ()      => []\n  (1,2)   => [1]\n  (1,3)   => [1, 2]\n  (1,2,3) => [2]\n  (2,3)   => [2, 1]\n  (1,3,2) => [1, 2, 1]")
@test mytest("g=Group(perm\"(1,2,3)(6,7)\",perm\"(3,4,5)(7,8)\")","Group([(1,2,3)(6,7),(3,4,5)(7,8)])")
@test mytest("transporting_elt(g,1,5)","(1,5,4,3,2)")
@test mytest("transporting_elt(g,1,6)","nothing")
@test mytest("transporting_elt(g,[1,2,3,4],[2,3,4,5];action=(s,g)->sort(s.^g))","(1,2,3,4,5)(6,7,8)")
@test mytest("transporting_elt(g,[1,2,3,4],[3,4,5,2];action=(s,g)->s.^g)","nothing")
@test mytest("G=Group([[-1 -1;1 0]])","Gapjm.Groups.Groupof{Matrix{Int64}}([[-1 -1; 1 0]], [1 0; 0 1], Dict{Symbol, Any}())")
@test mytest("elements(G)","3-element Vector{Matrix{Int64}}:\n [0 1; -1 -1]\n [1 0; 0 1]\n [-1 -1; 1 0]")
end
@testset "Gt.jl" begin
@test mytest("t=ClassTypes(rootdatum(:sl,3))","ClassTypes(Aâ‚‚,good characteristic)\n    C_G(s)â”‚ |C_G(s)|\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nAâ‚‚â‚â‚=Î¦â‚Â²  â”‚      Î¦â‚Â²\nAâ‚‚â‚â‚=Î¦â‚Î¦â‚‚ â”‚     Î¦â‚Î¦â‚‚\nAâ‚‚â‚â‚=Î¦â‚ƒ   â”‚       Î¦â‚ƒ\nAâ‚‚â‚â‚â‚=Aâ‚Î¦â‚â”‚   qÎ¦â‚Â²Î¦â‚‚\nAâ‚‚        â”‚qÂ³Î¦â‚Â²Î¦â‚‚Î¦â‚ƒ")
end
@testset "HasType.jl" begin
@test mytest("W=coxgroup(:F,4)","Fâ‚„")
@test mytest("r=classinfo(W)[:classtext];","nothing")
@test mytest("R=representation(W,17)","4-element Vector{Matrix{Int64}}:\n [-1 -1 0 0; 0 1 0 0; 0 0 1 0; 0 0 0 1]\n [1 0 0 0; -1 -1 -1 0; 0 0 1 0; 0 0 0 1]\n [1 0 0 0; 0 1 0 0; 0 -2 -1 -1; 0 0 0 1]\n [1 0 0 0; 0 1 0 0; 0 0 1 0; 0 0 -1 -1]")
@test mytest("traces_words_mats(R,r)==CharTable(W).irr[17,:]","true")
end
@testset "HeckeAlgebras.jl" begin
@test mytest("W=coxgroup(:A,2)","Aâ‚‚")
@test mytest("H=hecke(W,0)","hecke(Aâ‚‚,0)")
@test mytest("T=Tbasis(H);","nothing")
@test mytest("el=words(W)","6-element Vector{Vector{Int8}}:\n []\n [2]\n [1]\n [2, 1]\n [1, 2]\n [1, 2, 1]")
@test mytest("T.(el)*permutedims(T.(el))","6Ã—6 Matrix{HeckeTElt{Perm{Int16}, Int64, HeckeAlgebra{Int64, FiniteCoxeterGroup{Perm{Int16},Int64}}}}:\n T.    Tâ‚‚     Tâ‚     Tâ‚‚â‚    Tâ‚â‚‚    Tâ‚â‚‚â‚\n Tâ‚‚    -Tâ‚‚    Tâ‚‚â‚    -Tâ‚‚â‚   Tâ‚â‚‚â‚   -Tâ‚â‚‚â‚\n Tâ‚    Tâ‚â‚‚    -Tâ‚    Tâ‚â‚‚â‚   -Tâ‚â‚‚   -Tâ‚â‚‚â‚\n Tâ‚‚â‚   Tâ‚â‚‚â‚   -Tâ‚‚â‚   -Tâ‚â‚‚â‚  -Tâ‚â‚‚â‚  Tâ‚â‚‚â‚\n Tâ‚â‚‚   -Tâ‚â‚‚   Tâ‚â‚‚â‚   -Tâ‚â‚‚â‚  -Tâ‚â‚‚â‚  Tâ‚â‚‚â‚\n Tâ‚â‚‚â‚  -Tâ‚â‚‚â‚  -Tâ‚â‚‚â‚  Tâ‚â‚‚â‚   Tâ‚â‚‚â‚   -Tâ‚â‚‚â‚")
@test mytest("W=coxgroup(:B,2)","Bâ‚‚")
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("H=hecke(W,q)","hecke(Bâ‚‚,q)")
@test mytest("H.para","2-element Vector{Vector{Pol{Int64}}}:\n [q, -1]\n [q, -1]")
@test mytest("H=hecke(W,q^2,rootpara=q)","hecke(Bâ‚‚,qÂ²,rootpara=q)")
@test mytest("H.para,rootpara(H)","(Vector{Pol{Int64}}[[qÂ², -1], [qÂ², -1]], Pol{Int64}[q, q])")
@test mytest("H=hecke(W,[q^2,q^4],rootpara=[q,q^2])","hecke(Bâ‚‚,Pol{Int64}[qÂ², qâ´],rootpara=Pol{Int64}[q, qÂ²])")
@test mytest("H.para,rootpara(H)","(Vector{Pol{Int64}}[[qÂ², -1], [qâ´, -1]], Pol{Int64}[q, qÂ²])")
@test mytest("H=hecke(W,9,rootpara=3)","hecke(Bâ‚‚,9,rootpara=3)")
@test mytest("H.para,rootpara(H)","([[9, -1], [9, -1]], [3, 3])")
@test mytest("H=hecke(coxgroup(:F,4))","hecke(Fâ‚„,1)")
@test mytest("isrepresentation(H,reflrep(H))","true")
@test mytest("isrepresentation(H,Tbasis(H).(1:4))","true")
@test mytest("Pol(:q);W=coxgroup(:B,2);H=hecke(W,q)","hecke(Bâ‚‚,q)")
@test mytest("reflrep(H)","2-element Vector{Matrix{Pol}}:\n [-1 0; -q q]\n [q -2; 0 -1]")
@test mytest("H=hecke(coxgroup(:H,3))","hecke(Hâ‚ƒ,1)")
@test mytest("reflrep(H)","3-element Vector{Matrix{Cyc{Rational{Int64}}}}:\n [-1 0 0; -1 1 0; 0 0 1]\n [1 (-3-âˆš5)/2 0; 0 -1 0; 0 -1 1]\n [1 0 0; 0 1 -1; 0 0 -1]")
@test mytest("H=hecke(coxgroup(:H,3),Pol(:q))","hecke(Hâ‚ƒ,q)")
@test mytest("central_monomials(H)","10-element Vector{Pol{Cyc{Int64}}}:\n 1\n qÂ³â°\n qÂ¹Â²\n qÂ¹â¸\n qÂ¹â°\n qÂ¹â°\n qÂ²â°\n qÂ²â°\n qÂ¹âµ\n qÂ¹âµ")
@test mytest("W=coxgroup(:G,2);Pol(:q);H=hecke(W,q)","hecke(Gâ‚‚,q)")
@test mytest("T=Tbasis(H);h=T(1,2)*T(2,1)","qÂ²T.+(qÂ²-q)Tâ‚+(q-1)Tâ‚â‚‚â‚")
@test mytest("alt(h)","qâ»Â²T.+(qâ»Â²-qâ»Â³)Tâ‚+(qâ»Â³-qâ»â´)Tâ‚â‚‚â‚")
@test mytest("W=CoxSym(4)","ğ”– â‚„")
@test mytest("H=hecke(W,Pol(:q))","hecke(ğ”– â‚„,q)")
@test mytest("h=Tbasis(H)(longest(W))","Tâ‚â‚‚â‚â‚ƒâ‚‚â‚")
@test mytest("p=class_polynomials(h)","5-element Vector{Pol{Int64}}:\n 0\n 0\n qÂ²\n qÂ³-2qÂ²+q\n qÂ³-qÂ²+q-1")
@test mytest("W=coxgroup(:B,2)","Bâ‚‚")
@test mytest("H=hecke(W,q^2;rootpara=q)","hecke(Bâ‚‚,qÂ²,rootpara=q)")
@test mytest("char_values(Cpbasis(H)(1,2,1))","5-element Vector{Pol{Int64}}:\n -q-qâ»Â¹\n q+qâ»Â¹\n 0\n qÂ³+2q+2qâ»Â¹+qâ»Â³\n 0")
@test mytest("H=hecke(ComplexReflectionGroup(4),Pol(:q))","hecke(Gâ‚„,q)")
@test mytest("s=schur_elements(H)","7-element Vector{Pol{Cyc{Rational{Int64}}}}:\n qâ¸+2qâ·+3qâ¶+4qâµ+4qâ´+4qÂ³+3qÂ²+2q+1\n 2âˆš-3+(6+4âˆš-3)qâ»Â¹+12qâ»Â²+(6-4âˆš-3)qâ»Â³-2âˆš-3qâ»â´\n -2âˆš-3+(6-4âˆš-3)qâ»Â¹+12qâ»Â²+(6+4âˆš-3)qâ»Â³+2âˆš-3qâ»â´\n 2+2qâ»Â¹+4qâ»Â²+2qâ»Â³+2qâ»â´\n Î¶â‚ƒÂ²âˆš-3qÂ³+(3-âˆš-3)qÂ²+3q+3+âˆš-3-Î¶â‚ƒâˆš-3qâ»Â¹\n -Î¶â‚ƒâˆš-3qÂ³+(3+âˆš-3)qÂ²+3q+3-âˆš-3+Î¶â‚ƒÂ²âˆš-3qâ»Â¹\n qÂ²+2q+2+2qâ»Â¹+qâ»Â²")
@test mytest("CycPol.(s)","7-element Vector{CycPol{Cyc{Rational{Int64}}}}:\n Î¦â‚‚Â²Î¦â‚ƒÎ¦â‚„Î¦â‚†\n 2âˆš-3qâ»â´Î¦â‚‚Â²Î¦â€²â‚ƒÎ¦â€²â‚†\n -2âˆš-3qâ»â´Î¦â‚‚Â²Î¦â€³â‚ƒÎ¦â€³â‚†\n 2qâ»â´Î¦â‚ƒÎ¦â‚„\n Î¶â‚ƒÂ²âˆš-3qâ»Â¹Î¦â‚‚Â²Î¦â€²â‚ƒÎ¦â€³â‚†\n -Î¶â‚ƒâˆš-3qâ»Â¹Î¦â‚‚Â²Î¦â€³â‚ƒÎ¦â€²â‚†\n qâ»Â²Î¦â‚‚Â²Î¦â‚„")
@test mytest("W=ComplexReflectionGroup(4)","Gâ‚„")
@test mytest("@Mvp x,y; H=hecke(W,[[1,x,y]])","hecke(Gâ‚„,Mvp{Int64, Int64}[1, x, y])")
@test mytest("FactorizedSchurElement(H,[[2,5]])","-xâ»Â¹yÎ¦â‚‚(xy)Î¦â‚(x)Î¦â‚†(xyâ»Â¹)Î¦â‚(y)")
@test mytest("W=ComplexReflectionGroup(4)","Gâ‚„")
@test mytest("@Mvp x,y; H=hecke(W,[[1,x,y]])","hecke(Gâ‚„,Mvp{Int64, Int64}[1, x, y])")
@test mytest("FactorizedSchurElements(H)","7-element Vector{Gapjm.HeckeAlgebras.FactSchur}:\n xâ»â´yâ»â´Î¦â‚‚(xy)Î¦â‚Î¦â‚†(x)Î¦â‚Î¦â‚†(y)\n Î¦â‚‚(xÂ²yâ»Â¹)Î¦â‚Î¦â‚†(x)Î¦â‚Î¦â‚†(xyâ»Â¹)\n -xâ»â´yâµÎ¦â‚Î¦â‚†(xyâ»Â¹)Î¦â‚‚(xyâ»Â²)Î¦â‚Î¦â‚†(y)\n -xâ»Â¹yÎ¦â‚‚(xy)Î¦â‚(x)Î¦â‚†(xyâ»Â¹)Î¦â‚(y)\n -xâ»â´yÎ¦â‚‚(xÂ²yâ»Â¹)Î¦â‚(x)Î¦â‚(xyâ»Â¹)Î¦â‚†(y)\n xâ»Â¹yâ»Â¹Î¦â‚†(x)Î¦â‚(xyâ»Â¹)Î¦â‚‚(xyâ»Â²)Î¦â‚(y)\n xâ»Â²yÎ¦â‚‚(xÂ²yâ»Â¹)Î¦â‚‚(xy)Î¦â‚‚(xyâ»Â²)")
end
@testset "KL.jl" begin
@test mytest("W=coxgroup(:H,3)","Hâ‚ƒ")
@test mytest("c=LeftCells(W)","22-element Vector{LeftCell{FiniteCoxeterGroup{Perm{Int16},Cyc{Int64}}}}:\n LeftCell<Hâ‚ƒ: duflo= character=Ï†â‚â€šâ‚€>\n LeftCell<Hâ‚ƒ: duflo=123 character=Ï†â‚â€šâ‚â‚…>\n LeftCell<Hâ‚ƒ: duflo=(15) character=Ï†â‚…â€šâ‚…>\n LeftCell<Hâ‚ƒ: duflo=(10) character=Ï†â‚…â€šâ‚…>\n LeftCell<Hâ‚ƒ: duflo=(14) character=Ï†â‚…â€šâ‚…>\n LeftCell<Hâ‚ƒ: duflo=7 character=Ï†â‚…â€šâ‚…>\n LeftCell<Hâ‚ƒ: duflo=(12) character=Ï†â‚…â€šâ‚…>\n LeftCell<Hâ‚ƒ: duflo=(9,12) character=Ï†â‚…â€šâ‚‚>\n LeftCell<Hâ‚ƒ: duflo=(5,11) character=Ï†â‚…â€šâ‚‚>\n LeftCell<Hâ‚ƒ: duflo=13 character=Ï†â‚…â€šâ‚‚>\n â‹®\n LeftCell<Hâ‚ƒ: duflo=(8,13) character=Ï†â‚ƒâ€šâ‚†+Ï†â‚ƒâ€šâ‚ˆ>\n LeftCell<Hâ‚ƒ: duflo=(1,15) character=Ï†â‚ƒâ€šâ‚†+Ï†â‚ƒâ€šâ‚ˆ>\n LeftCell<Hâ‚ƒ: duflo=3 character=Ï†â‚ƒâ€šâ‚+Ï†â‚ƒâ€šâ‚ƒ>\n LeftCell<Hâ‚ƒ: duflo=2 character=Ï†â‚ƒâ€šâ‚+Ï†â‚ƒâ€šâ‚ƒ>\n LeftCell<Hâ‚ƒ: duflo=1 character=Ï†â‚ƒâ€šâ‚+Ï†â‚ƒâ€šâ‚ƒ>\n LeftCell<Hâ‚ƒ: duflo=6 character=Ï†â‚„â€šâ‚ƒ+Ï†â‚„â€šâ‚„>\n LeftCell<Hâ‚ƒ: duflo=(13) character=Ï†â‚„â€šâ‚ƒ+Ï†â‚„â€šâ‚„>\n LeftCell<Hâ‚ƒ: duflo=(11) character=Ï†â‚„â€šâ‚ƒ+Ï†â‚„â€šâ‚„>\n LeftCell<Hâ‚ƒ: duflo=9 character=Ï†â‚„â€šâ‚ƒ+Ï†â‚„â€šâ‚„>")
@test mytest("W=coxgroup(:F,4)","Fâ‚„")
@test mytest("w=longest(W)*gens(W)[1];length(W,w)","23")
@test mytest("y=W(1:4...);length(W,y)","4")
@test mytest("cr=KL.critical_pair(W,y,w);length(W,cr)","16")
@test mytest("Pol(:x);KLPol(W,y,w)","Pol{Int64}: xÂ³+1")
@test mytest("KLPol(W,cr,w)","Pol{Int64}: xÂ³+1")
@test mytest("W=coxgroup(:B,3)","Bâ‚ƒ")
@test mytest("map(i->map(x->KLPol(W,one(W),x),elements(W,i)),1:W.N)","9-element Vector{Vector{Pol{Int64}}}:\n [1, 1, 1]\n [1, 1, 1, 1, 1]\n [1, 1, 1, 1, 1, 1, 1]\n [1, 1, 1, x+1, 1, 1, 1, 1]\n [x+1, 1, 1, x+1, x+1, 1, x+1, 1]\n [1, x+1, 1, x+1, x+1, xÂ²+1, 1]\n [x+1, x+1, xÂ²+x+1, 1, 1]\n [xÂ²+1, x+1, 1]\n [1]")
@test mytest("W=coxgroup(:B,2);Pol(:v);H=hecke(W,[v^4,v^2])","hecke(Bâ‚‚,Pol{Int64}[vâ´, vÂ²])")
@test mytest("Cp=Cpbasis(H);h=Cp(1)^2","(vÂ²+vâ»Â²)Câ€²â‚")
@test mytest("k=Tbasis(H)(h)","(1+vâ»â´)T.+(1+vâ»â´)Tâ‚")
@test mytest("Cp(k)","(vÂ²+vâ»Â²)Câ€²â‚")
@test mytest("W=coxgroup(:B,3);Pol(:v);H=hecke(W,v^2)","hecke(Bâ‚ƒ,vÂ²)")
@test mytest("T=Tbasis(H);C=Cbasis(H);T(C(1))","-vT.+vâ»Â¹Tâ‚")
@test mytest("C(T(1))","vÂ²C.+vCâ‚")
@test mytest("ref=reflrep(H)","3-element Vector{Matrix{Pol}}:\n [-1 0 0; -vÂ² vÂ² 0; 0 0 vÂ²]\n [vÂ² -2 0; 0 -1 0; 0 -vÂ² vÂ²]\n [vÂ² 0 0; 0 vÂ² -1; 0 0 -1]")
@test mytest("W=coxgroup(:B,3)","Bâ‚ƒ")
@test mytest("Pol(:v);H=hecke(W,v^2,rootpara=v)","hecke(Bâ‚ƒ,vÂ²,rootpara=v)")
@test mytest("C=Cpbasis(H);","nothing")
@test mytest("T=Tbasis(H);","nothing")
@test mytest("T(C(1,2))","vâ»Â²T.+vâ»Â²Tâ‚‚+vâ»Â²Tâ‚+vâ»Â²Tâ‚â‚‚")
@test mytest("c=LeftCells(coxgroup(:G,2))[3]","LeftCell<Gâ‚‚: duflo=2 character=Ï†â‚‚â€šâ‚+Ï†â€²â‚â€šâ‚ƒ+Ï†â‚‚â€šâ‚‚>")
@test mytest("character(c)","3-element Vector{Int64}:\n 3\n 5\n 6")
@test mytest("W=coxgroup(:H,3)","Hâ‚ƒ")
@test mytest("c=LeftCells(W)[3]","LeftCell<Hâ‚ƒ: duflo=(15) character=Ï†â‚…â€šâ‚…>")
@test mytest("@Mvp q;H=hecke(W,q)","hecke(Hâ‚ƒ,q)")
@test mytest("representation(c,H)","3-element Vector{Matrix{Mvp{Int64, Rational{Int64}}}}:\n [-1 0 â€¦ 0 0; 0 -1 â€¦ 0 qÂ½; â€¦ ; 0 0 â€¦ q 0; 0 0 â€¦ 0 q]\n [-1 qÂ½ â€¦ 0 0; 0 q â€¦ 0 0; â€¦ ; 0 0 â€¦ -1 0; 0 qÂ½ â€¦ 0 -1]\n [q 0 â€¦ 0 0; qÂ½ -1 â€¦ 0 0; â€¦ ; 0 0 â€¦ q 0; 0 0 â€¦ 0 -1]")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("LeftCells(W)","4-element Vector{LeftCell{FiniteCoxeterGroup{Perm{Int16},Int64}}}:\n LeftCell<Gâ‚‚: duflo= character=Ï†â‚â€šâ‚€>\n LeftCell<Gâ‚‚: duflo=12 character=Ï†â‚â€šâ‚†>\n LeftCell<Gâ‚‚: duflo=2 character=Ï†â‚‚â€šâ‚+Ï†â€²â‚â€šâ‚ƒ+Ï†â‚‚â€šâ‚‚>\n LeftCell<Gâ‚‚: duflo=1 character=Ï†â‚‚â€šâ‚+Ï†â€³â‚â€šâ‚ƒ+Ï†â‚‚â€šâ‚‚>")
@test mytest("W=coxgroup(:G,2);","nothing")
@test mytest("LeftCells(W,1)","2-element Vector{LeftCell{FiniteCoxeterGroup{Perm{Int16},Int64}}}:\n LeftCell<Gâ‚‚: duflo=2 character=Ï†â‚‚â€šâ‚+Ï†â€²â‚â€šâ‚ƒ+Ï†â‚‚â€šâ‚‚>\n LeftCell<Gâ‚‚: duflo=1 character=Ï†â‚‚â€šâ‚+Ï†â€³â‚â€šâ‚ƒ+Ï†â‚‚â€šâ‚‚>")
@test mytest("W=coxgroup(:E,8)","Eâ‚ˆ")
@test mytest("LeftCell(W,W((1:8)...))","LeftCell<Eâ‚ˆ: duflo=(42,43) character=Ï†â‚ƒâ‚…â€šâ‚‚>")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("l=Lusztigaw(W,W(1))","6-element Vector{Int64}:\n 0\n 0\n 1\n 0\n 1\n 1")
@test mytest("sum(l.*map(i->almostChar(W,i),eachindex(l)))","[Gâ‚‚]:<Ï†â€²â‚â€šâ‚ƒ>+<Ï†â‚‚â€šâ‚>+<Ï†â‚‚â€šâ‚‚>")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("l=LusztigAw(W,W(1))","6-element Vector{Int64}:\n 0\n 0\n 0\n 1\n 1\n 1")
@test mytest("sum(l.*map(i->almostChar(W,i),eachindex(l)))","[Gâ‚‚]:<Ï†â€³â‚â€šâ‚ƒ>+<Ï†â‚‚â€šâ‚>+<Ï†â‚‚â€šâ‚‚>")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("A=AsymptoticAlgebra(W,1)","Asymptotic Algebra dim.10")
@test mytest("b=basis(A)","10-element Vector{AlgebraElt{AsymptoticAlgebra, Int64}}:\n tâ‚‚\n tâ‚â‚‚\n tâ‚‚â‚â‚‚\n tâ‚â‚‚â‚â‚‚\n tâ‚‚â‚â‚‚â‚â‚‚\n tâ‚\n tâ‚‚â‚\n tâ‚â‚‚â‚\n tâ‚‚â‚â‚‚â‚\n tâ‚â‚‚â‚â‚‚â‚")
@test mytest("b*permutedims(b)","10Ã—10 Matrix{AlgebraElt{AsymptoticAlgebra, Int64}}:\n tâ‚‚      0            tâ‚‚â‚â‚‚            â€¦  0               tâ‚‚â‚â‚‚â‚        0\n tâ‚â‚‚     0            tâ‚â‚‚+tâ‚â‚‚â‚â‚‚          0               tâ‚â‚‚â‚+tâ‚â‚‚â‚â‚‚â‚  0\n tâ‚‚â‚â‚‚    0            tâ‚‚+tâ‚‚â‚â‚‚+tâ‚‚â‚â‚‚â‚â‚‚     0               tâ‚‚â‚+tâ‚‚â‚â‚‚â‚    0\n tâ‚â‚‚â‚â‚‚   0            tâ‚â‚‚+tâ‚â‚‚â‚â‚‚          0               tâ‚+tâ‚â‚‚â‚      0\n tâ‚‚â‚â‚‚â‚â‚‚  0            tâ‚‚â‚â‚‚               0               tâ‚‚â‚          0\n 0       tâ‚â‚‚          0               â€¦  tâ‚â‚‚â‚            0            tâ‚â‚‚â‚â‚‚â‚\n 0       tâ‚‚+tâ‚‚â‚â‚‚      0                  tâ‚‚â‚+tâ‚‚â‚â‚‚â‚       0            tâ‚‚â‚â‚‚â‚\n 0       tâ‚â‚‚+tâ‚â‚‚â‚â‚‚    0                  tâ‚+tâ‚â‚‚â‚+tâ‚â‚‚â‚â‚‚â‚  0            tâ‚â‚‚â‚\n 0       tâ‚‚â‚â‚‚+tâ‚‚â‚â‚‚â‚â‚‚  0                  tâ‚‚â‚+tâ‚‚â‚â‚‚â‚       0            tâ‚‚â‚\n 0       tâ‚â‚‚â‚â‚‚        0                  tâ‚â‚‚â‚            0            tâ‚")
@test mytest("CharTable(A)","CharTable(Asymptotic Algebra dim.10)\n     â”‚2 12 212 1212 21212 1 21 121 2121 12121\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nÏ†â€²â‚â€šâ‚ƒâ”‚.  .   .    .     . 1  .  -1    .     1\nÏ†â‚‚â€šâ‚ â”‚1  .   2    .     1 1  .   2    .     1\nÏ†â‚‚â€šâ‚‚ â”‚1  .   .    .    -1 1  .   .    .    -1\nÏ†â€³â‚â€šâ‚ƒâ”‚1  .  -1    .     1 .  .   .    .     .")
end
@testset "Lusztig.jl" begin
@test mytest("W=coxgroup(:B,3)","Bâ‚ƒ")
@test mytest("t=twistings(W,[1,3])","2-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Bâ‚ƒâ‚â‚â‚ƒâ‚=AÌƒâ‚Ã—Aâ‚Î¦â‚\n Bâ‚ƒâ‚â‚â‚ƒâ‚=AÌƒâ‚Ã—Aâ‚Î¦â‚‚")
@test mytest("LusztigInductionTable(t[2],W)","Lusztig Induction from Bâ‚ƒâ‚â‚â‚ƒâ‚=AÌƒâ‚Ã—Aâ‚Î¦â‚‚ to Bâ‚ƒ\n     â”‚11âŠ— 11 11âŠ— 2 2âŠ— 11 2âŠ— 2\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n111. â”‚     1    -1    -1    .\n11.1 â”‚    -1     .     1   -1\n1.11 â”‚     .     .    -1    .\n.111 â”‚    -1     .     .    .\n21.  â”‚     .     .     .    .\n1.2  â”‚     1    -1     .    1\n2.1  â”‚     .     1     .    .\n.21  â”‚     .     .     .    .\n3.   â”‚     .     .     .    1\n.3   â”‚     .     1     1   -1\nBâ‚‚:2 â”‚     .     .     1   -1\nBâ‚‚:11â”‚     1    -1     .    .")
end
@testset "MatInt.jl" begin
@test mytest("MatInt.Gcdex(123,66)","(gcd = 3, coeff1 = 7, coeff2 = -13, coeff3 = -22, coeff4 = 41)")
@test mytest("MatInt.Gcdex(0,-3)","(gcd = 3, coeff1 = 0, coeff2 = -1, coeff3 = 1, coeff4 = 0)")
@test mytest("MatInt.Gcdex(0,0)","(gcd = 0, coeff1 = 1, coeff2 = 0, coeff3 = 0, coeff4 = 1)")
@test mytest("m=[[1,15,28],[4,5,6],[7,8,9]]","3-element Vector{Vector{Int64}}:\n [1, 15, 28]\n [4, 5, 6]\n [7, 8, 9]")
@test mytest("MatInt.NormalFormIntMat(m,6)","Dict{Symbol, Any} with 6 entries:\n  :rowQ     => [[-2, 62, -35], [1, -30, 17], [-3, 97, -55]]\n  :normal   => [[1, 0, 1], [0, 1, 1], [0, 0, 3]]\n  :rowC     => [[1, 0, 0], [0, 1, 0], [0, 0, 1]]\n  :rank     => 3\n  :signdet  => 1\n  :rowtrans => [[-2, 62, -35], [1, -30, 17], [-3, 97, -55]]")
@test mytest("r=MatInt.NormalFormIntMat(m,13)","Dict{Symbol, Any} with 9 entries:\n  :rowQ     => [[-2, 62, -35], [1, -30, 17], [-3, 97, -55]]\n  :normal   => [[1, 0, 0], [0, 1, 0], [0, 0, 3]]\n  :colQ     => [[1, 0, -1], [0, 1, -1], [0, 0, 1]]\n  :coltrans => [[1, 0, -1], [0, 1, -1], [0, 0, 1]]\n  :rowC     => [[1, 0, 0], [0, 1, 0], [0, 0, 1]]\n  :rank     => 3\n  :colC     => [[1, 0, 0], [0, 1, 0], [0, 0, 1]]\n  :signdet  => 1\n  :rowtrans => [[-2, 62, -35], [1, -30, 17], [-3, 97, -55]]")
@test mytest("toM(r[:rowtrans])*toM(m)*toM(r[:coltrans])","3Ã—3 Matrix{Int64}:\n 1  0  0\n 0  1  0\n 0  0  3")
@test mytest("mat=[[1,2,7],[4,5,6],[10,11,19]]","3-element Vector{Vector{Int64}}:\n [1, 2, 7]\n [4, 5, 6]\n [10, 11, 19]")
@test mytest("BaseIntMat(mat)","3-element Vector{Vector{Int64}}:\n [1, 2, 7]\n [0, 3, 7]\n [0, 0, 15]")
@test mytest("nat=[[5,7,2],[4,2,5],[7,1,4]]","3-element Vector{Vector{Int64}}:\n [5, 7, 2]\n [4, 2, 5]\n [7, 1, 4]")
@test mytest("MatInt.BaseIntersectionIntMats(mat,nat)","3-element Vector{Vector{Int64}}:\n [1, 5, 509]\n [0, 6, 869]\n [0, 0, 960]")
@test mytest("m=MatInt.IdentityMat(3)","3-element Vector{Vector{Int64}}:\n [1, 0, 0]\n [0, 1, 0]\n [0, 0, 1]")
@test mytest("n=[[1,2,3],[4,5,6]]","2-element Vector{Vector{Int64}}:\n [1, 2, 3]\n [4, 5, 6]")
@test mytest("ComplementIntMat(m,n)","Dict{Symbol, Vector{T} where T} with 3 entries:\n  :moduli     => [1, 3]\n  :sub        => [[1, 2, 3], [0, 3, 6]]\n  :complement => [[0, 0, 1]]")
@test mytest("mat=[[1,2,7],[4,5,6],[7,8,9],[10,11,19],[5,7,12]]","5-element Vector{Vector{Int64}}:\n [1, 2, 7]\n [4, 5, 6]\n [7, 8, 9]\n [10, 11, 19]\n [5, 7, 12]")
@test mytest("NullspaceIntMat(mat)","2-element Vector{Vector{Int64}}:\n [1, 18, -9, 2, -6]\n [0, 24, -13, 3, -7]")
@test mytest("mat=[[1,2,7],[4,5,6],[7,8,9],[10,11,19],[5,7,12]]","5-element Vector{Vector{Int64}}:\n [1, 2, 7]\n [4, 5, 6]\n [7, 8, 9]\n [10, 11, 19]\n [5, 7, 12]")
@test mytest("solutionmat(toM(mat),[95,115,182])","5-element Vector{Rational{Int64}}:\n  47//4\n -17//2\n  67//4\n   0//1\n   0//1")
@test mytest("SolutionIntMat(mat,[95,115,182])","5-element view(::Matrix{Int64}, 1, :) with eltype Int64:\n  2285\n -5854\n  4888\n -1299\n     0")
@test mytest("DiaconisGraham([[3,0],[4,1]],[10,5])","Dict{Symbol, Any} with 2 entries:\n  :normal   => [[1, 0], [0, 2]]\n  :rowtrans => [[-13, 10], [4, -3]]")
end
@testset "ModuleElts.jl" begin
@test mytest("a=ModuleElt(:xy=>1,:yx=>-1)",":xy-:yx")
@test mytest("a-a","0")
@test mytest("a*99","99:xy-99:yx")
@test mytest("a+ModuleElt(:yx=>1)",":xy")
@test mytest("a[:xy]","1")
@test mytest("a[:xx]","0")
@test mytest("haskey(a,:xx)","false")
@test mytest("first(a)",":xy => 1")
@test mytest("collect(a)","2-element Vector{Pair{Symbol, Int64}}:\n :xy => 1\n :yx => -1")
@test mytest("keys(a)","2-element Vector{Symbol}:\n :xy\n :yx")
@test mytest("values(a)","2-element Vector{Int64}:\n  1\n -1")
@test mytest("length(a)","2")
@test mytest("eltype(a)","Pair{Symbol, Int64}")
@test mytest("a=ModuleElt(:yy=>1, :yx=>2, :xy=>3, :yy=>-1;check=false)",":yy+2:yx+3:xy-:yy")
@test mytest("a=ModuleElt(:yy=>1, :yx=>2, :xy=>3, :yy=>-1)","3:xy+2:yx")
@test mytest("a+ModuleElt([:z=>1.0])","3.0:xy+2.0:yx+1.0:z")
end
@testset "Mvps.jl" begin
@test mytest("@Mvp x,y","nothing")
@test mytest("(x+y)^3","Mvp{Int64}: xÂ³+3xÂ²y+3xyÂ²+yÂ³")
@test mytest("degree(Mvp(1))","0")
@test mytest("(x^2-y^2)//(x-y)","Mvp{Int64}: x+y")
@test mytest("(4x)^(1//2)","Mvp{Int64,Rational{Int64}}: 2xÂ½")
@test mytest("(2.0x)^(1//2)","Mvp{Float64,Rational{Int64}}: 1.4142135623730951xÂ½")
@test mytest("root(2.0x)","Mvp{Float64,Rational{Int64}}: 1.4142135623730951xÂ½")
@test mytest("@Mvp x;conj(im*x+1)","Mvp{Complex{Int64}}: (0 - 1im)x+1 + 0im")
@test mytest("a=x^2+x*y","Mvp{Int64}: xÂ²+xy")
@test mytest("degree(a)","2")
@test mytest("degree(a,:y)","1")
@test mytest("degree(a,:x)","2")
@test mytest("a=x^2+x*y","Mvp{Int64}: xÂ²+xy")
@test mytest("valuation(a)","2")
@test mytest("valuation(a,:y)","0")
@test mytest("valuation(a,:x)","1")
@test mytest("@Mvp x,y;p=(x-y)^3","Mvp{Int64}: xÂ³-3xÂ²y+3xyÂ²-yÂ³")
@test mytest("coefficient(p,Monomial(:x,:x,:y))","-3")
@test mytest("coefficient(p,Monomial())","0")
@test mytest("p=(x+y+inv(y))^4","Mvp{Int64}: xâ´+4xÂ³y+4xÂ³yâ»Â¹+6xÂ²yÂ²+12xÂ²+6xÂ²yâ»Â²+4xyÂ³+12xy+12xyâ»Â¹+4xyâ»Â³+yâ´+4yÂ²+6+4yâ»Â²+yâ»â´")
@test mytest("coefficients(p,:x)","Dict{Int64, Mvp{Int64, Int64}} with 5 entries:\n  0 => yâ´+4yÂ²+6+4yâ»Â²+yâ»â´\n  4 => 1\n  2 => 6yÂ²+12+6yâ»Â²\n  3 => 4y+4yâ»Â¹\n  1 => 4yÂ³+12y+12yâ»Â¹+4yâ»Â³")
@test mytest("coefficients(p,:y)","Dict{Int64, Mvp{Int64, Int64}} with 9 entries:\n  0  => xâ´+12xÂ²+6\n  4  => 1\n  -1 => 4xÂ³+12x\n  2  => 6xÂ²+4\n  -3 => 4x\n  -2 => 6xÂ²+4\n  -4 => 1\n  3  => 4x\n  1  => 4xÂ³+12x")
@test mytest("@Mvp x,y,z","nothing")
@test mytest("variables(x+y+1,z)","3-element Vector{Symbol}:\n :x\n :y\n :z")
@test mytest("p=Mvp(:x)+1","Mvp{Int64}: x+1")
@test mytest("w=p(x=4)","Mvp{Int64}: 5")
@test mytest("scal(w)","5")
@test mytest("typeof(scal(w))","Int64")
@test mytest("p=-2+7x^5*inv(y)","Mvp{Int64}: 7xâµyâ»Â¹-2")
@test mytest("p(x=2)","Mvp{Int64}: -2+224yâ»Â¹")
@test mytest("p(y=1)","Mvp{Int64}: 7xâµ-2")
@test mytest("p(x=2,y=1)","Mvp{Int64}: 222")
@test mytest("p(x=y)","Mvp{Int64}: 7yâ´-2")
@test mytest("p(x=y,y=x)","Mvp{Int64}: -2+7xâ»Â¹yâµ")
@test mytest("p=x^(1//2)*y^(1//3)","Mvp{Int64,Rational{Int64}}: xÂ½yâ…“")
@test mytest("p(;x=y)","Mvp{Int64,Rational{Int64}}: yâµâ„â‚†")
@test mytest("p(;x=4)","Mvp{Int64,Rational{Int64}}: 2yâ…“")
@test mytest("p(;y=2.0)","Mvp{Float64,Rational{Int64}}: 1.2599210498948732xÂ½")
@test mytest("@Mvp x,y","nothing")
@test mytest("(x+y)^[1 2;3 1]","Mvp{Int64}: 3x+4y")
@test mytest("@Mvp x,y;p=7x^5*y^-1-2","Mvp{Int64}: 7xâµyâ»Â¹-2")
@test mytest("derivative(p,:x)","Mvp{Int64}: 35xâ´yâ»Â¹")
@test mytest("derivative(p,:y)","Mvp{Int64}: -7xâµyâ»Â²")
@test mytest("derivative(p)","Mvp{Int64}: 35xâ´yâ»Â¹")
@test mytest("p=x^(1//2)*y^(1//3)","Mvp{Int64,Rational{Int64}}: xÂ½yâ…“")
@test mytest("derivative(p,:x)","Mvp{Rational{Int64},Rational{Int64}}: (1//2)xâ»Â½yâ…“")
@test mytest("derivative(p,:y)","Mvp{Rational{Int64},Rational{Int64}}: (1//3)xÂ½yâ»Â²â„â‚ƒ")
@test mytest("derivative(p,:z)","Mvp{Rational{Int64},Rational{Int64}}: 0")
@test mytest("laurent_denominator(x^-1,y^-2+x^4)","Monomial{Int64}:xyÂ²")
@test mytest("p=E(3)x+E(5)","Mvp{Cyc{Int64}}: Î¶â‚ƒx+Î¶â‚…")
@test mytest("q=convert(Mvp{ComplexF64,Int},p)","Mvp{ComplexF64}: (-0.4999999999999998 + 0.8660254037844387im)x+0.30901699437494745 + 0.9510565162951535im")
@test mytest("conj(q)","Mvp{ComplexF64}: (-0.4999999999999998 - 0.8660254037844387im)x+0.30901699437494745 - 0.9510565162951535im")
end
@testset "PermGroups.jl" begin
@test mytest("G=Group([Perm(i,i+1) for i in 1:2])","Group([(1,2),(2,3)])")
@test mytest("collect(G)","6-element Vector{Perm{Int16}}:\n (1,2)\n (1,3,2)\n ()\n (1,2,3)\n (1,3)\n (2,3)")
@test mytest("degree(G)","3")
@test mytest("Perm(1,2) in G","true")
@test mytest("Perm(1,2,4) in G","false")
@test mytest("base(G)","2-element Vector{Int16}:\n 1\n 2")
@test mytest("centralizers(G)","2-element Vector{PermGroup{Int16}}:\n Group([(1,2),(2,3)])\n Group([(2,3)])")
@test mytest("transversals(G)","2-element Vector{Dict{Int16, Perm{Int16}}}:\n Dict(2 => (1,2), 3 => (1,3,2), 1 => ())\n Dict(2 => (), 3 => (2,3))")
@test mytest("WF=rootdatum(\"3D4\")","Â³Dâ‚„")
@test mytest("on_classes(Group(WF),WF.phi)","Perm{Int64}: (2,8,7)(5,13,12)")
@test mytest("uc=UnipotentCharacters(ComplexReflectionGroup(34));","nothing")
@test mytest("stab_onmats(fourier(uc.families[20]))","Group([(7,38),(39,44)(40,43)(41,42)])")
@test mytest("m=cartan(:D,12);","nothing")
@test mytest("n=^(m,Perm(1,5,2,8,12,4,7)*Perm(3,9,11,6);dims=(1,2));","nothing")
@test mytest("Perm_onmats(m,n)","(1,5,2,8,12,4,7)(3,9,11,6)")
end
@testset "PermRoot.jl" begin
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("cartan(W)","3Ã—3 Matrix{Int64}:\n  2  -1   0\n -1   2  -1\n  0  -1   2")
@test mytest("rank(ComplexReflectionGroup(31))","4")
@test mytest("W=coxgroup(:B,2)","Bâ‚‚")
@test mytest("hyperplane_orbits(W)","2-element Vector{NamedTuple{(:s, :cl_s, :order, :N_s, :det_s), Tuple{Int64, Vector{Int64}, Int64, Int64, Vector{Int64}}}}:\n (s = 1, cl_s = [2], order = 2, N_s = 2, det_s = [5])\n (s = 2, cl_s = [4], order = 2, N_s = 2, det_s = [1])")
@test mytest("bipartite_decomposition(coxgroup(:E,8))","([1, 4, 6, 8], [3, 2, 5, 7])")
@test mytest("reflchar(coxgroup(:A,3))","5-element Vector{Int64}:\n  3\n  1\n -1\n  0\n -1")
@test mytest("refleigen(coxgroup(:B,2))","5-element Vector{Vector{Root1}}:\n [1, 1]\n [1, -1]\n [-1, -1]\n [1, -1]\n [Î¶â‚„, Î¶â‚„Â³]")
@test mytest("W=coxgroup(:A,4)","Aâ‚„")
@test mytest("reflength(W,longest(W))","2")
@test mytest("reflength(W,W(1,2,3,4))","4")
@test mytest("W=reflection_subgroup(coxgroup(:A,3),[1,3])","Aâ‚ƒâ‚â‚â‚ƒâ‚=Aâ‚Ã—Aâ‚Î¦â‚")
@test mytest("semisimplerank(W)","2")
@test mytest("rank(W)","3")
@test mytest("W=reflection_subgroup(rootdatum(\"E7sc\"),1:6)","Eâ‚‡â‚â‚â‚‚â‚ƒâ‚„â‚…â‚†â‚=Eâ‚†Î¦â‚")
@test mytest("PermX(W,reflrep(W,longest(W)))==longest(W)","true")
@test mytest("parabolic_reps(coxgroup(:A,4))","7-element Vector{Vector{Int64}}:\n []\n [1]\n [1, 2]\n [1, 3]\n [1, 2, 3]\n [1, 2, 4]\n [1, 2, 3, 4]")
@test mytest("parabolic_reps(coxgroup(:A,4),2)","2-element Vector{Vector{Int64}}:\n [1, 2]\n [1, 3]")
@test mytest("W=reflection_subgroup(rootdatum(\"E7sc\"),1:6)","Eâ‚‡â‚â‚â‚‚â‚ƒâ‚„â‚…â‚†â‚=Eâ‚†Î¦â‚")
@test mytest("reflrep(W,longest(W))","7Ã—7 Matrix{Int64}:\n  0   0   0   0   0  -1  2\n  0  -1   0   0   0   0  2\n  0   0   0   0  -1   0  3\n  0   0   0  -1   0   0  4\n  0   0  -1   0   0   0  3\n -1   0   0   0   0   0  2\n  0   0   0   0   0   0  1")
@test mytest("W=ComplexReflectionGroup(7)","Gâ‚‡")
@test mytest("is_parabolic(reflection_subgroup(W,[1,2]))","false")
@test mytest("is_parabolic(reflection_subgroup(W,[1]))","true")
@test mytest("W=ComplexReflectionGroup(7)","Gâ‚‡")
@test mytest("parabolic_closure(W,[1])","1-element Vector{Int64}:\n 1")
@test mytest("parabolic_closure(W,[1,2])","3-element Vector{Int64}:\n 1\n 2\n 3")
@test mytest("catalan(8)","1430")
@test mytest("catalan(coxgroup(:A,7))","1430")
@test mytest("catalan(ComplexReflectionGroup(7),2)","16//1")
@test mytest("catalan(ComplexReflectionGroup(7),2,q)","Pol{Int64}: qâ·Â²+2qâ¶â°+3qâ´â¸+4qÂ³â¶+3qÂ²â´+2qÂ¹Â²+1")
@test mytest("reflection([-1 0 0;1 1 0;0 0 1])","(root = [2, 0, 0], coroot = Rational{Int64}[1//1, -1//2, 0//1], eig = -1, isOrthogonal = false)")
@test mytest("reflection([-1 0 0;1 1 0;0 0 1],[1,0,0])","(root = [1, 0, 0], coroot = Rational{Int64}[2//1, -1//1, 0//1], eig = -1, isOrthogonal = false)")
@test mytest("W=ComplexReflectionGroup(4)","Gâ‚„")
@test mytest("invariant_form(W)","2Ã—2 Matrix{Int64}:\n 1  0\n 0  2")
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("PermRoot.generic_order(ComplexReflectionGroup(4),q)","Pol{Int64}: qÂ¹â´-qÂ¹â°-qâ¸+qâ´")
@test mytest("W=coxgroup(:A,2)","Aâ‚‚")
@test mytest("@Mvp x,y,z","nothing")
@test mytest("i=invariants(W);","nothing")
@test mytest("i[1](x,y)","Mvp{Int64}: -2xÂ²+2xy-2yÂ²")
@test mytest("i[2](x,y)","Mvp{Int64}: 6xÂ²y-6xyÂ²")
@test mytest("W=ComplexReflectionGroup(24)","Gâ‚‚â‚„")
@test mytest("i=invariants(W)[1];","nothing")
@test mytest("p=i(x,y,z)","Mvp{Rational{Int64}}: (14//1)xâ´+(-12//1)xÂ²yÂ²+(-42//1)xÂ²yz+(21//2)xÂ²zÂ²+(18//7)yâ´+(-6//1)yÂ³z+(-9//2)yÂ²zÂ²+(-21//8)zâ´")
@test mytest("p^reflrep(W,1)-p","Mvp{Cyc{Rational{Int64}}}: 0")
end
@testset "Perms.jl" begin
@test mytest("a=Perm(1,2,3)","(1,2,3)")
@test mytest("vec(a)","3-element Vector{Int16}:\n 2\n 3\n 1")
@test mytest("a==Perm(vec(a))","true")
@test mytest("b=Perm(1,2,3,4)","(1,2,3,4)")
@test mytest("a*b","(1,3,2,4)")
@test mytest("inv(a)","(1,3,2)")
@test mytest("a/b","(3,4)")
@test mytest("a\\\\b","(1,4)")
@test mytest("a^b","(2,3,4)")
@test mytest("b^2","(1,3)(2,4)")
@test mytest("1^a","2")
@test mytest("one(a)","()")
@test mytest("sign(a)","1")
@test mytest("order(a)","3")
@test mytest("largest_moved_point(a)","3")
@test mytest("smallest_moved_point(a)","1")
@test mytest("Perm{Int8}(a)","Perm{Int8}: (1,2,3)")
@test mytest("Matrix(b)","4Ã—4 Matrix{Bool}:\n 0  1  0  0\n 0  0  1  0\n 0  0  0  1\n 1  0  0  0")
@test mytest("Perm([0,2,4],[4,0,2])","(1,3,2)")
@test mytest("Matrix(Perm(2,3,4),5)","5Ã—5 Matrix{Bool}:\n 1  0  0  0  0\n 0  0  1  0  0\n 0  0  0  1  0\n 0  1  0  0  0\n 0  0  0  0  1")
@test mytest("[5,4,6,1,7,5]^Perm(1,3,5,6,4)","6-element Vector{Int64}:\n 1\n 4\n 5\n 5\n 6\n 7")
@test mytest("m=[3*i+j for i in 0:2,j in 1:3]","3Ã—3 Matrix{Int64}:\n 1  2  3\n 4  5  6\n 7  8  9")
@test mytest("p=Perm(1,2,3)","(1,2,3)")
@test mytest("m^p","3Ã—3 Matrix{Int64}:\n 7  8  9\n 1  2  3\n 4  5  6")
@test mytest("^(m,p;dims=2)","3Ã—3 Matrix{Int64}:\n 3  1  2\n 6  4  5\n 9  7  8")
@test mytest("^(m,p;dims=(1,2))","3Ã—3 Matrix{Int64}:\n 9  7  8\n 3  1  2\n 6  4  5")
@test mytest("orbits(Perm(1,2)*Perm(4,5),1:5)","3-element Vector{Vector{Int16}}:\n [1, 2]\n [3]\n [4, 5]")
@test mytest("cycles(Perm(1,2)*Perm(4,5))","2-element Vector{Vector{Int16}}:\n [1, 2]\n [4, 5]")
@test mytest("cycletype(Perm(1,2)*Perm(3,4))","1-element Vector{Pair{Int64, Int64}}:\n 2 => 2")
@test mytest("restricted(Perm(1,2)*Perm(3,4),3:4)","(3,4)")
@test mytest("mappingPerm([1,2,5,3],[2,3,4,6])","(1,2,3,6,5,4)")
end
@testset "Pols.jl" begin
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("Pol([1,2])","Pol{Int64}: 2q+1")
@test mytest("2q+1","Pol{Int64}: 2q+1")
@test mytest("p=Pol([1,2],-1)","Pol{Int64}: 2+qâ»Â¹")
@test mytest("Pol()","Pol{Int64}: q")
@test mytest("valuation(p),degree(p)","(-1, 0)")
@test mytest("derivative(p)","Pol{Int64}: -qâ»Â²")
@test mytest("p=(q+1)^2","Pol{Int64}: qÂ²+2q+1")
@test mytest("valuation(p),degree(p)","(0, 2)")
@test mytest("p(1//2)","9//4")
@test mytest("p[0], p[1], p[-1]","(1, 2, 0)")
@test mytest("p[-1:1]","3-element Vector{Int64}:\n 0\n 1\n 2")
@test mytest("divrem(q^3+1,2q+1)","(0.5qÂ²-0.25q+0.125, 0.875)")
@test mytest("divrem(q^3+1,2q+1//1)","((1//2)qÂ²+(-1//4)q+1//8, 7//8)")
@test mytest("divrem(q^3+1,q+2)","(qÂ²-2q+4, -7)")
@test mytest("gcd(2q+2,q^2-1)","Pol{Float64}: 1.0q+1.0")
@test mytest("gcd(q+1//1,q^2-1//1)","Pol{Rational{Int64}}: (1//1)q+1//1")
end
@testset "Posets.jl" begin
@test mytest("p=Poset(coxgroup(:A,2))",".<1,2<21,12<121")
@test mytest("length(p)","6")
@test mytest("p.labels=\"abcdef\"; p","a<b,c<d,e<f")
@test mytest("hasse(p)","6-element Vector{Vector{Int64}}:\n [2, 3]\n [4, 5]\n [4, 5]\n [6]\n [6]\n []")
@test mytest("incidence(p)","6Ã—6 Matrix{Bool}:\n 1  1  1  1  1  1\n 0  1  0  1  1  1\n 0  0  1  1  1  1\n 0  0  0  1  0  1\n 0  0  0  0  1  1\n 0  0  0  0  0  1")
@test mytest("m=[j-i in [0,1] for i in 1:5, j in 1:5]","5Ã—5 Matrix{Bool}:\n 1  1  0  0  0\n 0  1  1  0  0\n 0  0  1  1  0\n 0  0  0  1  1\n 0  0  0  0  1")
@test mytest("transitive_closure(m)","5Ã—5 Matrix{Bool}:\n 1  1  1  1  1\n 0  1  1  1  1\n 0  0  1  1  1\n 0  0  0  1  1\n 0  0  0  0  1")
@test mytest("Poset(Bool[1 1 1 1 1;0 1 0 1 1;0 0 1 1 1;0 0 0 1 0;0 0 0 0 1])","1<2,3<4,5")
@test mytest("Poset([[2,3],[4,5],[4,5],Int[],Int[]])","1<2,3<4,5")
@test mytest("p=Poset([j%i==0 for i in 1:6, j in 1:6])","1<5\n1<2<4\n1<3<6\n2<6")
@test mytest("linear_extension(p)","6-element Vector{Int64}:\n 1\n 2\n 3\n 5\n 4\n 6")
@test mytest("p=Poset([j%i==0 for i in 1:5, j in 1:5])","1<3,5\n1<2<4")
@test mytest("hasse(p)","5-element Vector{Vector{Int64}}:\n [2, 3, 5]\n [4]\n []\n []\n []")
@test mytest("p=Poset(push!([[i+1] for i in 1:5],Int[]))","1<2<3<4<5<6")
@test mytest("incidence(p)","6Ã—6 Matrix{Bool}:\n 1  1  1  1  1  1\n 0  1  1  1  1  1\n 0  0  1  1  1  1\n 0  0  0  1  1  1\n 0  0  0  0  1  1\n 0  0  0  0  0  1")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("reverse(p)","3,7<2,6<1,5<4,8")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("partition(p)","4-element Vector{Vector{Int64}}:\n [4, 8]\n [2, 6]\n [3, 7]\n [1, 5]")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("restricted(p,2:6)","3<4<1,5<2")
@test mytest("p.labels=1:8; restricted(p,2:6)","4<5<2,6<3")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("is_join_lattice(p)","false")
@test mytest("p=Poset([i==j || i%4<j%4 for i in 1:8, j in 1:8])","4,8<1,5<2,6<3,7")
@test mytest("is_meet_lattice(p)","false")
end
@testset "Presentations.jl" begin
@test mytest("@AbsWord a,b","nothing")
@test mytest("F=FpGroup([a,b])","FreeGroup(a,b)")
@test mytest("G=F/[a^2,b^7,comm(a,a^b),comm(a,a^(b^2))*inv(b^a)]","FreeGroup(a,b)/[aÂ²,bâ·,aâ»Â¹bâ»Â¹aâ»Â¹babâ»Â¹ab,aâ»Â¹bâ»Â²aâ»Â¹bÂ²abâ»Â²abÂ²aâ»Â¹bâ»Â¹a]")
@test mytest("P=Presentation(G)","<< presentation with 2 gens and 4 rels of total length 30 >>")
@test mytest("F=FpGroup(:a,:b,:c)","FreeGroup(a,b,c)")
@test mytest("Presentations.TietzeWord(comm(F(1),F(2))*inv(F(3)^2*F(2)),gens(F))","5-element Vector{Int64}:\n -1\n -2\n  1\n -3\n -3")
@test mytest("AbsWord([-1,-2,1,-3,-3],AbsWord.([:a,:b,:c]))","aâ»Â¹bâ»Â¹acâ»Â²")
@test mytest("@AbsWord a,b,c,d,e,f","nothing")
@test mytest("F=FpGroup([a,b,c,d,e,f])","FreeGroup(a,b,c,d,e,f)")
@test mytest("G=F/[a^2,b^2,d*f^-1,e^2,f^2,a*b^-1*c,a*e*c^-1,b*d^-1*c,c*d*e^-1,a*f*c^-2,c^4]","FreeGroup(a,b,c,d,e,f)/[aÂ²,bÂ²,dfâ»Â¹,eÂ²,fÂ²,abâ»Â¹c,aecâ»Â¹,bdâ»Â¹c,cdeâ»Â¹,afcâ»Â²,câ´]")
@test mytest("simplify(G)","FreeGroup(a,c)/[aÂ²,acâ»Â¹acâ»Â¹,câ´]")
end
@testset "SPerms.jl" begin
@test mytest("SPerm([-2,-1,-3])","SPerm{Int64}: (1,-2)(3,-3)")
@test mytest("p=SPerm(-1)","(1,-1)")
@test mytest("q=SPerm(1,2)","(1,2)")
@test mytest("sort(elements(Group([p,q])))","8-element Vector{SPerm{Int16}}:\n (1,-2)\n (1,-2,-1,2)\n (1,-1)(2,-2)\n (1,-1)\n (2,-2)\n ()\n (1,2,-1,-2)\n (1,2)")
@test mytest("SPerm([-2,-1,-3])==SPerm([-2,-1,-3,4])","true")
@test mytest("p=SPerm([-2,-1,-3])","SPerm{Int64}: (1,-2)(3,-3)")
@test mytest("[20,30,40]^p","3-element Vector{Int64}:\n -30\n -20\n -40")
@test mytest("p=SPerm([20,30,40],[-40,-20,-30])","(1,-2,3,-1,2,-3)")
@test mytest("[20,30,40]^p","3-element Vector{Int64}:\n -40\n -20\n -30")
@test mytest("Matrix(SPerm([-2,-1,-3]))","3Ã—3 Matrix{Int64}:\n  0  -1   0\n -1   0   0\n  0   0  -1")
@test mytest("elements(CoxHyperoctaedral(2))","8-element Vector{SPerm{Int8}}:\n ()\n (1,2)\n (1,-1)\n (1,2,-1,-2)\n (1,-2,-1,2)\n (2,-2)\n (1,-2)\n (1,-1)(2,-2)")
@test mytest("uc=UnipotentCharacters(ComplexReflectionGroup(6));","nothing")
@test mytest("g=sstab_onmats(fourier(uc.families[2]))","Group([(1,18)(3,-6)(8,-21)(10,-16)(11,22)(13,15),(1,-15)(2,-19)(3,-11)(6,22)(7,-12)(13,-18),(2,19)(4,-14)(5,20)(7,12),(1,-11)(2,-19)(3,-15)(5,-20)(6,13)(8,10)(16,21)(17,-17)(18,-22),(1,-22)(2,-19)(3,-13)(5,-20)(6,15)(8,-16)(10,-21)(11,-18)(17,-17),(1,-3)(2,-19)(4,14)(6,18)(8,-10)(9,-9)(11,-15)(13,-22)(16,-21),(1,6)(2,-19)(3,-18)(4,14)(8,16)(9,-9)(10,21)(11,-13)(15,-22),(1,13)(3,22)(4,14)(5,-20)(6,-11)(8,21)(9,-9)(10,16)(15,18)(17,-17)])")
@test mytest("length(g)","32")
@test mytest("f=SubFamilyij(chevieget(:families,:X)(12),1,3,(3+ER(-3))/2);","nothing")
@test mytest("M=fourier(conj(f));","nothing")
@test mytest("uc=UnipotentCharacters(ComplexReflectionGroup(6));","nothing")
@test mytest("N=fourier(uc.families[2]);","nothing")
@test mytest("p=SPerm_onmats(M,N)","(1,3)(2,19,-2,-19)(4,-14,-4,14)(5,-5)(6,-18)(7,-7)(8,10)(11,15,-11,-15)(12,-12)(13,22)(16,21,-16,-21)")
@test mytest("^(M,p;dims=(1,2))==N","true")
end
@testset "Semisimple.jl" begin
@test mytest("W=rootdatum([-1 1 0;0 -1 1],[-1 1 0;0 -1 1])","Aâ‚‚Î¦â‚")
@test mytest("reflrep(W,W(1))","3Ã—3 Matrix{Int64}:\n 0  1  0\n 1  0  0\n 0  0  1")
@test mytest("rootdatum(:gl,3)","Aâ‚‚Î¦â‚")
@test mytest("G=rootdatum(:sl,4)","Aâ‚ƒ")
@test mytest("L=reflection_subgroup(G,[1,3])","Aâ‚ƒâ‚â‚â‚ƒâ‚=Aâ‚Ã—Aâ‚Î¦â‚")
@test mytest("C=algebraic_centre(L)","Dict{Symbol, Any} with 3 entries:\n  :descAZ => [[1, 2]]\n  :AZ     => SSGroup(SemisimpleElement{Root1}[<1,1,-1>])\n  :Z0     => SubTorus(Aâ‚ƒâ‚â‚â‚ƒâ‚=Aâ‚Ã—Aâ‚Î¦â‚,[[1, 2, 1]])")
@test mytest("T=torsion_subgroup(C[:Z0],3)","SSGroup(SemisimpleElement{Root1}[<Î¶â‚ƒ,Î¶â‚ƒÂ²,Î¶â‚ƒ>])")
@test mytest("e=sort(elements(T))","3-element Vector{SemisimpleElement{Root1}}:\n <1,1,1>\n <Î¶â‚ƒ,Î¶â‚ƒÂ²,Î¶â‚ƒ>\n <Î¶â‚ƒÂ²,Î¶â‚ƒ,Î¶â‚ƒÂ²>")
@test mytest("e[3]^G(2)","SemisimpleElement{Root1}: <Î¶â‚ƒÂ²,1,Î¶â‚ƒÂ²>")
@test mytest("orbit(G,e[3])","6-element Vector{SemisimpleElement{Root1}}:\n <Î¶â‚ƒÂ²,Î¶â‚ƒ,Î¶â‚ƒÂ²>\n <Î¶â‚ƒÂ²,1,Î¶â‚ƒÂ²>\n <Î¶â‚ƒ,1,Î¶â‚ƒÂ²>\n <Î¶â‚ƒÂ²,1,Î¶â‚ƒ>\n <Î¶â‚ƒ,1,Î¶â‚ƒ>\n <Î¶â‚ƒ,Î¶â‚ƒÂ²,Î¶â‚ƒ>")
@test mytest("G=rootdatum(:sl,4)","Aâ‚ƒ")
@test mytest("s=SemisimpleElement(G,Z(4).^[1,2,1])","SemisimpleElement{FFE{2}}: <Zâ‚„,Zâ‚„Â²,Zâ‚„>")
@test mytest("s^G(2)","SemisimpleElement{FFE{2}}: <Zâ‚„,1â‚‚,Zâ‚„>")
@test mytest("orbit(G,s)","6-element Vector{SemisimpleElement{FFE{2}}}:\n <Zâ‚„,Zâ‚„Â²,Zâ‚„>\n <Zâ‚„,1â‚‚,Zâ‚„>\n <Zâ‚„Â²,1â‚‚,Zâ‚„>\n <Zâ‚„,1â‚‚,Zâ‚„Â²>\n <Zâ‚„Â²,1â‚‚,Zâ‚„Â²>\n <Zâ‚„Â²,Zâ‚„,Zâ‚„Â²>")
@test mytest("G=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("s=SS(G,[0,1//2,0])","SemisimpleElement{Root1}: <1,-1,1>")
@test mytest("centralizer(G,s)","Aâ‚ƒâ‚â‚â‚ƒâ‚=(Aâ‚Aâ‚)Î¦â‚‚")
@test mytest("W=coxgroup(:A,4)","Aâ‚„")
@test mytest("SubTorus(W,[1 2 3 4;2 3 4 1;3 4 1 1])","SubTorus(Aâ‚„,[[1, 0, 3, -13], [0, 1, 2, 7], [0, 0, 4, -3]])")
@test mytest("G=rootdatum(:sl,4)","Aâ‚ƒ")
@test mytest("L=reflection_subgroup(G,[1,3])","Aâ‚ƒâ‚â‚â‚ƒâ‚=Aâ‚Ã—Aâ‚Î¦â‚")
@test mytest("C=algebraic_centre(L)","Dict{Symbol, Any} with 3 entries:\n  :descAZ => [[1, 2]]\n  :AZ     => SSGroup(SemisimpleElement{Root1}[<1,1,-1>])\n  :Z0     => SubTorus(Aâ‚ƒâ‚â‚â‚ƒâ‚=Aâ‚Ã—Aâ‚Î¦â‚,[[1, 2, 1]])")
@test mytest("T=torsion_subgroup(C[:Z0],3)","SSGroup(SemisimpleElement{Root1}[<Î¶â‚ƒ,Î¶â‚ƒÂ²,Î¶â‚ƒ>])")
@test mytest("sort(elements(T))","3-element Vector{SemisimpleElement{Root1}}:\n <1,1,1>\n <Î¶â‚ƒ,Î¶â‚ƒÂ²,Î¶â‚ƒ>\n <Î¶â‚ƒÂ²,Î¶â‚ƒ,Î¶â‚ƒÂ²>")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("fundamental_group(W)","Group([(1,2,3,12)])")
@test mytest("W=rootdatum(:sl,4)","Aâ‚ƒ")
@test mytest("fundamental_group(W)","Group([])")
@test mytest("G=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("s=SS(G,[0,1//2,0])","SemisimpleElement{Root1}: <1,-1,1>")
@test mytest("centralizer(G,s)","Aâ‚ƒâ‚â‚â‚ƒâ‚=(Aâ‚Aâ‚)Î¦â‚‚")
@test mytest("W=coxgroup(:E,6);l=Semisimple.QuasiIsolatedRepresentatives(W)","5-element Vector{SemisimpleElement{Root1}}:\n <1,1,1,1,1,1>\n <1,1,1,Î¶â‚ƒ,1,1>\n <1,-1,1,1,1,1>\n <1,Î¶â‚†,Î¶â‚†,1,Î¶â‚†,1>\n <Î¶â‚ƒ,1,1,1,1,Î¶â‚ƒ>")
@test mytest("map(s->is_isolated(W,s),l)","5-element Vector{Bool}:\n 1\n 1\n 1\n 0\n 0")
@test mytest("W=rootdatum(:E6sc);l=Semisimple.QuasiIsolatedRepresentatives(W)","7-element Vector{SemisimpleElement{Root1}}:\n <1,1,1,1,1,1>\n <-1,1,1,-1,1,-1>\n <Î¶â‚ƒ,1,Î¶â‚ƒÂ²,1,Î¶â‚ƒ,Î¶â‚ƒÂ²>\n <Î¶â‚ƒÂ²,1,Î¶â‚ƒ,1,Î¶â‚ƒ,Î¶â‚ƒÂ²>\n <Î¶â‚ƒÂ²,1,Î¶â‚ƒ,1,Î¶â‚ƒÂ²,Î¶â‚ƒ>\n <Î¶â‚ƒÂ²,1,Î¶â‚ƒ,1,Î¶â‚ƒÂ²,Î¶â‚†âµ>\n <Î¶â‚†âµ,1,Î¶â‚ƒÂ²,1,Î¶â‚ƒ,Î¶â‚ƒÂ²>")
@test mytest("map(s->is_isolated(W,s),l)","7-element Vector{Bool}:\n 1\n 1\n 1\n 1\n 1\n 1\n 1")
@test mytest("Semisimple.QuasiIsolatedRepresentatives(W,3)","2-element Vector{SemisimpleElement{Root1}}:\n <1,1,1,1,1,1>\n <-1,1,1,-1,1,-1>")
@test mytest("l=twistings(rootdatum(:sl,4),Int[])","5-element Vector{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}}:\n Aâ‚ƒâ‚â‚=Î¦â‚Â³\n Aâ‚ƒâ‚â‚=Î¦â‚Â²Î¦â‚‚\n Aâ‚ƒâ‚â‚=Î¦â‚Î¦â‚‚Â²\n Aâ‚ƒâ‚â‚=Î¦â‚Î¦â‚ƒ\n Aâ‚ƒâ‚â‚=Î¦â‚‚Î¦â‚„")
@test mytest("StructureRationalPointsConnectedCentre.(l,3)","5-element Vector{Vector{Int64}}:\n [2, 2, 2]\n [2, 8]\n [4, 8]\n [26]\n [40]")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("SScentralizer_reps(W)","6-element Vector{Vector{Int64}}:\n []\n [1]\n [2]\n [1, 2]\n [1, 5]\n [2, 6]")
@test mytest("reflection_subgroup.(Ref(W),SScentralizer_reps(W))","6-element Vector{FiniteCoxeterSubGroup{Perm{Int16},Int64}}:\n Gâ‚‚â‚â‚=Î¦â‚Â²\n Gâ‚‚â‚â‚â‚=Aâ‚Î¦â‚\n Gâ‚‚â‚â‚‚â‚=AÌƒâ‚Î¦â‚\n Gâ‚‚\n Gâ‚‚â‚â‚â‚…â‚=Aâ‚‚\n Gâ‚‚â‚â‚‚â‚†â‚=AÌƒâ‚Ã—Aâ‚")
@test mytest("SScentralizer_reps(W,2)","5-element Vector{Vector{Int64}}:\n []\n [1]\n [2]\n [1, 2]\n [1, 5]")
end
@testset "Sscoset.jl" begin
@test mytest("WF=rootdatum(:u,6)","Â²Aâ‚…Î¦â‚‚")
@test mytest("l=QuasiIsolatedRepresentatives(WF)","4-element Vector{SemisimpleElement{Root1}}:\n <1,1,1,1,1,1>\n <Î¶â‚„,1,1,1,1,Î¶â‚„Â³>\n <Î¶â‚„,Î¶â‚„,1,1,Î¶â‚„Â³,Î¶â‚„Â³>\n <Î¶â‚„,Î¶â‚„,Î¶â‚„,Î¶â‚„Â³,Î¶â‚„Â³,Î¶â‚„Â³>")
@test mytest("centralizer.(Ref(WF),l)","4-element Vector{ExtendedCox{FiniteCoxeterGroup{Perm{Int16},Rational{Int64}}}}:\n Extended(Câ‚ƒâ‚â‚ƒâ‚‚â‚â‚)\n Bâ‚‚Î¦â‚\n (Aâ‚Aâ‚)â‚â‚â‚ƒâ‚Ã—Aâ‚â‚â‚‚â‚\n Â²Aâ‚ƒâ‚â‚ƒâ‚â‚‚â‚")
@test mytest("is_isolated.(Ref(WF),l)","4-element BitVector:\n 1\n 0\n 1\n 1")
@test mytest("WF=rootdatum(:u,6)","Â²Aâ‚…Î¦â‚‚")
@test mytest("s=SS(Group(WF),[1//4,0,0,0,0,3//4])","SemisimpleElement{Root1}: <Î¶â‚„,1,1,1,1,Î¶â‚„Â³>")
@test mytest("centralizer(WF,s)","Bâ‚‚Î¦â‚")
@test mytest("centralizer(WF,one(s))","Extended(Câ‚ƒâ‚â‚ƒâ‚‚â‚â‚)")
@test mytest("WF=rootdatum(Symbol(\"2E6sc\"))","Â²Eâ‚†")
@test mytest("QuasiIsolatedRepresentatives(WF)","5-element Vector{SemisimpleElement{Root1}}:\n <1,1,1,1,1,1>\n <1,1,1,-1,1,1>\n <1,-1,Î¶â‚„,1,Î¶â‚„,1>\n <1,Î¶â‚ƒÂ²,1,Î¶â‚ƒ,1,1>\n <1,Î¶â‚„Â³,1,-1,1,1>")
@test mytest("QuasiIsolatedRepresentatives(WF,2)","2-element Vector{SemisimpleElement{Root1}}:\n <1,1,1,1,1,1>\n <1,Î¶â‚ƒÂ²,1,Î¶â‚ƒ,1,1>")
@test mytest("QuasiIsolatedRepresentatives(WF,3)","4-element Vector{SemisimpleElement{Root1}}:\n <1,1,1,1,1,1>\n <1,1,1,-1,1,1>\n <1,-1,Î¶â‚„,1,Î¶â‚„,1>\n <1,Î¶â‚„Â³,1,-1,1,1>")
@test mytest("WF=rootdatum(:u,6)","Â²Aâ‚…Î¦â‚‚")
@test mytest("l=QuasiIsolatedRepresentatives(WF)","4-element Vector{SemisimpleElement{Root1}}:\n <1,1,1,1,1,1>\n <Î¶â‚„,1,1,1,1,Î¶â‚„Â³>\n <Î¶â‚„,Î¶â‚„,1,1,Î¶â‚„Â³,Î¶â‚„Â³>\n <Î¶â‚„,Î¶â‚„,Î¶â‚„,Î¶â‚„Â³,Î¶â‚„Â³,Î¶â‚„Â³>")
@test mytest("is_isolated.(Ref(WF),l)","4-element BitVector:\n 1\n 0\n 1\n 1")
end
@testset "Symbols.jl" begin
@test mytest("d=partition_tuples(3,2)","10-element Vector{Vector{Vector{Int64}}}:\n [[1, 1, 1], []]\n [[1, 1], [1]]\n [[1], [1, 1]]\n [[], [1, 1, 1]]\n [[2, 1], []]\n [[1], [2]]\n [[2], [1]]\n [[], [2, 1]]\n [[3], []]\n [[], [3]]")
@test mytest("PartitionTupleToString.(d)","10-element Vector{String}:\n \"111.\"\n \"11.1\"\n \"1.11\"\n \".111\"\n \"21.\"\n \"1.2\"\n \"2.1\"\n \".21\"\n \"3.\"\n \".3\"")
@test mytest("shiftÎ²([2,3],2)","4-element Vector{Int64}:\n 0\n 1\n 4\n 5")
@test mytest("shiftÎ²([0,1,4,5],-2)","2-element Vector{Int64}:\n 2\n 3")
@test mytest("Î²set([3,3,1])","3-element Vector{Int64}:\n 1\n 4\n 5")
@test mytest("partÎ²([0,4,5])","2-element Vector{Int64}:\n 3\n 3")
@test mytest("symbol_partition_tuple([[1,2],[1]],1)","2-element Vector{Vector{Int64}}:\n [2, 2]\n [1]")
@test mytest("symbol_partition_tuple([[1,2],[1]],0)","2-element Vector{Vector{Int64}}:\n [2, 2]\n [0, 2]")
@test mytest("symbol_partition_tuple([[1,2],[1]],-1)","2-element Vector{Vector{Int64}}:\n [2, 2]\n [0, 1, 3]")
@test mytest("ranksymbol([[1,5,6],[1,2]])","11")
@test mytest("valuation_gendeg_symbol([[1,5,6],[1,2]])","13")
@test mytest("degree_gendeg_symbol([[1,5,6],[1,2]])","91")
@test mytest("defectsymbol([[1,5,6],[1,2]])","1")
@test mytest("degree_fegsymbol([[1,5,6],[1,2]])","88")
@test mytest("valuation_fegsymbol([[1,5,6],[1,2]])","16")
@test mytest("stringsymbol.(symbols(3,2,1))","14-element Vector{String}:\n \"(12,0,0)\"\n \"(02,1,0)\"\n \"(02,0,1)\"\n \"(012,12,01)\"\n \"(01,1,1)\"\n \"(012,01,12)\"\n \"(2,,)\"\n \"(01,2,0)\"\n \"(01,0,2)\"\n \"(1,012,012)\"\n \"(,02,01)\"\n \"(,01,02)\"\n \"(0,,012)\"\n \"(0,012,)\"")
@test mytest("stringsymbol.(symbols(3,3,0))","12-element Vector{String}:\n \"(1+)\"\n \"(1E(3))\"\n \"(1E(3,2))\"\n \"(01,12,02)\"\n \"(01,02,12)\"\n \"(012,012,123)\"\n \"(0,1,2)\"\n \"(0,2,1)\"\n \"(01,01,13)\"\n \"(0,0,3)\"\n \"(012,,)\"\n \"(012,012,)\"")
@test mytest("fegsymbol([[1,5,6],[1,2]])","qÂ¹â¶Î¦â‚…Î¦â‚‡Î¦â‚ˆÎ¦â‚‰Î¦â‚â‚€Î¦â‚â‚Î¦â‚â‚„Î¦â‚â‚†Î¦â‚â‚ˆÎ¦â‚‚â‚€Î¦â‚‚â‚‚")
@test mytest("Symbols.gendeg_symbol([[1,2],[1,5,6]])","qÂ¹Â³Î¦â‚…Î¦â‚†Î¦â‚‡Î¦â‚ˆÂ²Î¦â‚‰Î¦â‚â‚€Î¦â‚â‚Î¦â‚â‚„Î¦â‚â‚†Î¦â‚â‚ˆÎ¦â‚‚â‚€Î¦â‚‚â‚‚/2")
@test mytest("tableaux([[2,1],[1]])","8-element Vector{Vector{Vector{Vector{Int64}}}}:\n [[[1, 2], [3]], [[4]]]\n [[[1, 2], [4]], [[3]]]\n [[[1, 3], [2]], [[4]]]\n [[[1, 3], [4]], [[2]]]\n [[[1, 4], [2]], [[3]]]\n [[[1, 4], [3]], [[2]]]\n [[[2, 3], [4]], [[1]]]\n [[[2, 4], [3]], [[1]]]")
@test mytest("tableaux([2,2])","2-element Vector{Vector{Vector{Int64}}}:\n [[1, 2], [3, 4]]\n [[1, 3], [2, 4]]")
end
@testset "Uch.jl" begin
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("uc=UnipotentCharacters(W)","UnipotentCharacters(Gâ‚‚)\n      Î³â”‚   Deg(Î³)  Feg Fr(Î³)    label\nâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nÏ†â‚â€šâ‚€   â”‚        1    1     1\nÏ†â‚â€šâ‚†   â”‚       qâ¶   qâ¶     1\nÏ†â€²â‚â€šâ‚ƒ  â”‚  qÎ¦â‚ƒÎ¦â‚†/3   qÂ³     1    (1,Ï)\nÏ†â€³â‚â€šâ‚ƒ  â”‚  qÎ¦â‚ƒÎ¦â‚†/3   qÂ³     1   (gâ‚ƒ,1)\nÏ†â‚‚â€šâ‚   â”‚ qÎ¦â‚‚Â²Î¦â‚ƒ/6  qÎ¦â‚ˆ     1    (1,1)\nÏ†â‚‚â€šâ‚‚   â”‚ qÎ¦â‚‚Â²Î¦â‚†/2 qÂ²Î¦â‚„     1   (gâ‚‚,1)\nGâ‚‚[-1] â”‚ qÎ¦â‚Â²Î¦â‚ƒ/2    0    -1   (gâ‚‚,Îµ)\nGâ‚‚[1]  â”‚ qÎ¦â‚Â²Î¦â‚†/6    0     1    (1,Îµ)\nGâ‚‚[Î¶â‚ƒ] â”‚qÎ¦â‚Â²Î¦â‚‚Â²/3    0    Î¶â‚ƒ  (gâ‚ƒ,Î¶â‚ƒ)\nGâ‚‚[Î¶â‚ƒÂ²]â”‚qÎ¦â‚Â²Î¦â‚‚Â²/3    0   Î¶â‚ƒÂ² (gâ‚ƒ,Î¶â‚ƒÂ²)")
@test mytest("uc.families[1]","Family(D(ğ”– â‚ƒ),[5, 6, 4, 3, 8, 7, 9, 10])\nDrinfeld double of ğ”– â‚ƒ, Lusztigâ€²s version\n   labelâ”‚eigen\nâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n(1,1)   â”‚    1 1//6  1//2  1//3  1//3  1//6  1//2  1//3  1//3\n(gâ‚‚,1)  â”‚    1 1//2  1//2  0//1  0//1 -1//2 -1//2  0//1  0//1\n(gâ‚ƒ,1)  â”‚    1 1//3  0//1  2//3 -1//3  1//3  0//1 -1//3 -1//3\n(1,Ï)   â”‚    1 1//3  0//1 -1//3  2//3  1//3  0//1 -1//3 -1//3\n(1,Îµ)   â”‚    1 1//6 -1//2  1//3  1//3  1//6 -1//2  1//3  1//3\n(gâ‚‚,Îµ)  â”‚   -1 1//2 -1//2  0//1  0//1 -1//2  1//2  0//1  0//1\n(gâ‚ƒ,Î¶â‚ƒ) â”‚   Î¶â‚ƒ 1//3  0//1 -1//3 -1//3  1//3  0//1  2//3 -1//3\n(gâ‚ƒ,Î¶â‚ƒÂ²)â”‚  Î¶â‚ƒÂ² 1//3  0//1 -1//3 -1//3  1//3  0//1 -1//3  2//3")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("T=spets(reflection_subgroup(W,Int[]),W(1,2))","Gâ‚‚â‚â‚=Î¦â‚†")
@test mytest("u=UniChar(T,1)","[Gâ‚‚â‚â‚=Î¦â‚†]:<.>")
@test mytest("LusztigInduce(W,u)","[Gâ‚‚]:<Ï†â‚â€šâ‚€>+<Ï†â‚â€šâ‚†>-<Ï†â‚‚â€šâ‚>+<Gâ‚‚[-1]>+<Gâ‚‚[Î¶â‚ƒ]>+<Gâ‚‚[Î¶â‚ƒÂ²]>")
@test mytest("v=DLChar(W,[1,2])","[Gâ‚‚]:<Ï†â‚â€šâ‚€>+<Ï†â‚â€šâ‚†>-<Ï†â‚‚â€šâ‚>+<Gâ‚‚[-1]>+<Gâ‚‚[Î¶â‚ƒ]>+<Gâ‚‚[Î¶â‚ƒÂ²]>")
@test mytest("degree(v)","Pol{Int64}: qâ¶+qâµ-qâ´-2qÂ³-qÂ²+q+1")
@test mytest("v*v","6")
@test mytest("UnipotentCharacters(ComplexReflectionGroup(4))","UnipotentCharacters(Gâ‚„)\n    Î³â”‚           Deg(Î³)    Feg Fr(Î³)   label\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nÏ†â‚â€šâ‚€ â”‚                1      1     1\nÏ†â‚â€šâ‚„ â”‚ -âˆš-3qâ´Î¦â€³â‚ƒÎ¦â‚„Î¦â€³â‚†/6     qâ´     1  1âˆ§-Î¶â‚ƒÂ²\nÏ†â‚â€šâ‚ˆ â”‚  âˆš-3qâ´Î¦â€²â‚ƒÎ¦â‚„Î¦â€²â‚†/6     qâ¸     1  -1âˆ§Î¶â‚ƒÂ²\nÏ†â‚‚â€šâ‚… â”‚        qâ´Î¦â‚‚Â²Î¦â‚†/2   qâµÎ¦â‚„     1   1âˆ§Î¶â‚ƒÂ²\nÏ†â‚‚â€šâ‚ƒ â”‚-Î¶â‚ƒâˆš-3qÎ¦â€³â‚ƒÎ¦â‚„Î¦â€²â‚†/3   qÂ³Î¦â‚„     1   1âˆ§Î¶â‚ƒÂ²\nÏ†â‚‚â€šâ‚ â”‚Î¶â‚ƒÂ²âˆš-3qÎ¦â€²â‚ƒÎ¦â‚„Î¦â€³â‚†/3    qÎ¦â‚„     1    1âˆ§Î¶â‚ƒ\nÏ†â‚ƒâ€šâ‚‚ â”‚           qÂ²Î¦â‚ƒÎ¦â‚† qÂ²Î¦â‚ƒÎ¦â‚†     1\nZâ‚ƒ:2 â”‚    -âˆš-3qÎ¦â‚Î¦â‚‚Î¦â‚„/3      0   Î¶â‚ƒÂ²  Î¶â‚ƒâˆ§Î¶â‚ƒÂ²\nZâ‚ƒ:11â”‚   -âˆš-3qâ´Î¦â‚Î¦â‚‚Î¦â‚„/3      0   Î¶â‚ƒÂ²  Î¶â‚ƒâˆ§-Î¶â‚ƒ\nGâ‚„   â”‚       -qâ´Î¦â‚Â²Î¦â‚ƒ/2      0    -1 -Î¶â‚ƒÂ²âˆ§-1")
@test mytest("W=coxgroup(:Bsym,2)","Bsymâ‚‚")
@test mytest("WF=spets(W,Perm(1,2))","Â²Bsymâ‚‚")
@test mytest("uc=UnipotentCharacters(WF)","UnipotentCharacters(Â²Bsymâ‚‚)\n       Î³â”‚   Deg(Î³)   Feg Fr(Î³) label\nâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n2       â”‚        1     1     1\n11      â”‚       qâ´    qâ´     1\nÂ²Bâ‚‚[1,3]â”‚âˆš2qÎ¦â‚Î¦â‚‚/2 qÎ¦â‚Î¦â‚‚   Î¶â‚ˆÂ³     1\nÂ²Bâ‚‚[1,5]â”‚âˆš2qÎ¦â‚Î¦â‚‚/2     0   Î¶â‚ˆâµ     2")
@test mytest("uc.families","3-element Vector{Family}:\n Family(Câ‚,[1])\n Family(Câ‚,[2])\n Family(?4,3:4)")
@test mytest("uc.families[3]","Family(?4,3:4)\nlabelâ”‚eigen    1     2\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1    â”‚  Î¶â‚ˆÂ³ âˆš2/2 -âˆš2/2\n2    â”‚  -Î¶â‚ˆ âˆš2/2  âˆš2/2")
@test mytest("uc=UnipotentCharacters(coxgroup(:G,2));","nothing")
@test mytest("charnames(uc;limit=true)","10-element Vector{String}:\n \"Ï†â‚â€šâ‚€\"\n \"Ï†â‚â€šâ‚†\"\n \"Ï†â€²â‚â€šâ‚ƒ\"\n \"Ï†â€³â‚â€šâ‚ƒ\"\n \"Ï†â‚‚â€šâ‚\"\n \"Ï†â‚‚â€šâ‚‚\"\n \"Gâ‚‚[-1]\"\n \"Gâ‚‚[1]\"\n \"Gâ‚‚[Î¶â‚ƒ]\"\n \"Gâ‚‚[Î¶â‚ƒÂ²]\"")
@test mytest("charnames(uc;TeX=true)","10-element Vector{String}:\n \"\\\\phi_{1,0}\"\n \"\\\\phi_{1,6}\"\n \"\\\\phi_{1,3}'\"\n \"\\\\phi_{1,3}''\"\n \"\\\\phi_{2,1}\"\n \"\\\\phi_{2,2}\"\n \"G_2[-1]\"\n \"G_2[1]\"\n \"G_2[\\\\zeta_3]\"\n \"G_2[\\\\zeta_3^2]\"")
@test mytest("W=coxgroup(:B,2)","Bâ‚‚")
@test mytest("uc=UnipotentCharacters(W)","UnipotentCharacters(Bâ‚‚)\n  Î³â”‚Deg(Î³) Feg Fr(Î³) label\nâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n11.â”‚ qÎ¦â‚„/2  qÂ²     1   +,-\n1.1â”‚qÎ¦â‚‚Â²/2 qÎ¦â‚„     1   +,+\n.11â”‚    qâ´  qâ´     1\n2. â”‚     1   1     1\n.2 â”‚ qÎ¦â‚„/2  qÂ²     1   -,+\nBâ‚‚ â”‚qÎ¦â‚Â²/2   0    -1   -,-")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("uc=UnipotentCharacters(W);","nothing")
@test mytest("degrees(uc)","10-element Vector{Pol{Rational{Int64}}}:\n 1//1\n (1//1)qâ¶\n (1//3)qâµ+(1//3)qÂ³+(1//3)q\n (1//3)qâµ+(1//3)qÂ³+(1//3)q\n (1//6)qâµ+(1//2)qâ´+(2//3)qÂ³+(1//2)qÂ²+(1//6)q\n (1//2)qâµ+(1//2)qâ´+(1//2)qÂ²+(1//2)q\n (1//2)qâµ+(-1//2)qâ´+(-1//2)qÂ²+(1//2)q\n (1//6)qâµ+(-1//2)qâ´+(2//3)qÂ³+(-1//2)qÂ²+(1//6)q\n (1//3)qâµ+(-2//3)qÂ³+(1//3)q\n (1//3)qâµ+(-2//3)qÂ³+(1//3)q")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("CycPolUnipotentDegrees(W)","10-element Vector{CycPol{Rational{Int64}}}:\n 1\n qâ¶\n qÎ¦â‚ƒÎ¦â‚†/3\n qÎ¦â‚ƒÎ¦â‚†/3\n qÎ¦â‚‚Â²Î¦â‚ƒ/6\n qÎ¦â‚‚Â²Î¦â‚†/2\n qÎ¦â‚Â²Î¦â‚ƒ/2\n qÎ¦â‚Â²Î¦â‚†/6\n qÎ¦â‚Â²Î¦â‚‚Â²/3\n qÎ¦â‚Â²Î¦â‚‚Â²/3")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("u=UniChar(W,7)","[Gâ‚‚]:<Gâ‚‚[-1]>")
@test mytest("v=UniChar(W,\"G2[E3]\")","[Gâ‚‚]:<Gâ‚‚[Î¶â‚ƒ]>")
@test mytest("w=UniChar(W,[1,0,0,-1,0,0,2,0,0,1])","[Gâ‚‚]:<Ï†â‚â€šâ‚€>-<Ï†â€³â‚â€šâ‚ƒ>+2<Gâ‚‚[-1]>+<Gâ‚‚[Î¶â‚ƒÂ²]>")
@test mytest("w-2u","[Gâ‚‚]:<Ï†â‚â€šâ‚€>-<Ï†â€³â‚â€šâ‚ƒ>+<Gâ‚‚[Î¶â‚ƒÂ²]>")
@test mytest("w*w","7")
@test mytest("degree(w)","Pol{Int64}: qâµ-qâ´-qÂ³-qÂ²+q+1")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("WF=spets(W)","Gâ‚‚")
@test mytest("T=subspets(WF,Int[],W(1))","Gâ‚‚â‚â‚=Î¦â‚Î¦â‚‚")
@test mytest("u=UniChar(T,1)","[Gâ‚‚â‚â‚=Î¦â‚Î¦â‚‚]:<.>")
@test mytest("LusztigInduce(WF,u)","[Gâ‚‚]:<Ï†â‚â€šâ‚€>-<Ï†â‚â€šâ‚†>-<Ï†â€²â‚â€šâ‚ƒ>+<Ï†â€³â‚â€šâ‚ƒ>")
@test mytest("DLChar(W,W(1))","[Gâ‚‚]:<Ï†â‚â€šâ‚€>-<Ï†â‚â€šâ‚†>-<Ï†â€²â‚â€šâ‚ƒ>+<Ï†â€³â‚â€šâ‚ƒ>")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("WF=spets(W)","Gâ‚‚")
@test mytest("T=subspets(WF,Int[],W(1))","Gâ‚‚â‚â‚=Î¦â‚Î¦â‚‚")
@test mytest("u=DLChar(W,W(1))","[Gâ‚‚]:<Ï†â‚â€šâ‚€>-<Ï†â‚â€šâ‚†>-<Ï†â€²â‚â€šâ‚ƒ>+<Ï†â€³â‚â€šâ‚ƒ>")
@test mytest("LusztigRestrict(T,u)","[Gâ‚‚â‚â‚=Î¦â‚Î¦â‚‚]:4<.>")
@test mytest("T=subspets(WF,Int[],W(2))","Gâ‚‚â‚â‚=Î¦â‚Î¦â‚‚")
@test mytest("LusztigRestrict(T,u)","[Gâ‚‚â‚â‚=Î¦â‚Î¦â‚‚]:0")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("DLChar(W,3)","[Gâ‚‚]:<Ï†â‚â€šâ‚€>-<Ï†â‚â€šâ‚†>-<Ï†â€²â‚â€šâ‚ƒ>+<Ï†â€³â‚â€šâ‚ƒ>")
@test mytest("DLChar(W,W(1))","[Gâ‚‚]:<Ï†â‚â€šâ‚€>-<Ï†â‚â€šâ‚†>-<Ï†â€²â‚â€šâ‚ƒ>+<Ï†â€³â‚â€šâ‚ƒ>")
@test mytest("DLChar(W,[1])","[Gâ‚‚]:<Ï†â‚â€šâ‚€>-<Ï†â‚â€šâ‚†>-<Ï†â€²â‚â€šâ‚ƒ>+<Ï†â€³â‚â€šâ‚ƒ>")
@test mytest("DLChar(W,[1,2])","[Gâ‚‚]:<Ï†â‚â€šâ‚€>+<Ï†â‚â€šâ‚†>-<Ï†â‚‚â€šâ‚>+<Gâ‚‚[-1]>+<Gâ‚‚[Î¶â‚ƒ]>+<Gâ‚‚[Î¶â‚ƒÂ²]>")
@test mytest("W=coxgroup(:B,2)","Bâ‚‚")
@test mytest("almostChar(W,3)","[Bâ‚‚]:<.11>")
@test mytest("almostChar(W,1)","[Bâ‚‚]:1//2<11.>+1//2<1.1>-1//2<.2>-1//2<Bâ‚‚>")
@test mytest("W=coxgroup(:A,2)","Aâ‚‚")
@test mytest("H=hecke(W,Pol(:q))","hecke(Aâ‚‚,q)")
@test mytest("T=Tbasis(H);","nothing")
@test mytest("DLLefschetz(T(1,2))","[Aâ‚‚]:<111>-q<21>+qÂ²<3>")
@test mytest("DLLefschetz((T(1)+T())*(T(2)+T()))","[Aâ‚‚]:q<21>+(qÂ²+2q+1)<3>")
@test mytest("H=hecke(spets(W,Perm(1,2)),Pol(:q)^2)","hecke(Â²Aâ‚‚,qÂ²)")
@test mytest("T=Tbasis(H);DLLefschetz(T(1))","[Â²Aâ‚‚]:-<11>-q<Â²Aâ‚‚>+qÂ²<2>")
@test mytest("WF=rootdatum(\"3D4\")","Â³Dâ‚„")
@test mytest("on_unipotents(Group(WF),WF.phi)","(1,7,2)(8,12,9)")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("WF=spets(W,Perm(1,2,4))","Â³Dâ‚„")
@test mytest("u=UniChar(W,2)","[Dâ‚„]:<11->")
@test mytest("Frobenius(WF)(u)","[Dâ‚„]:<.211>")
@test mytest("Frobenius(WF)(u,-1)","[Dâ‚„]:<11+>")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("cuspidal(UnipotentCharacters(W))","1-element Vector{Int64}:\n 14")
@test mytest("cuspidal(UnipotentCharacters(W),6)","8-element Vector{Int64}:\n  1\n  2\n  6\n  7\n  8\n  9\n 10\n 12")
@test mytest("cuspidal(UnipotentCharacters(ComplexReflectionGroup(4)),3)","4-element Vector{Int64}:\n  3\n  6\n  7\n 10")
@test mytest("cuspidal_pairs(coxgroup(:F,4))","9-element Vector{NamedTuple{(:levi, :cuspidal), Tuple{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}, Int64}}}:\n (levi = Fâ‚„, cuspidal = 31)\n (levi = Fâ‚„, cuspidal = 32)\n (levi = Fâ‚„, cuspidal = 33)\n (levi = Fâ‚„, cuspidal = 34)\n (levi = Fâ‚„, cuspidal = 35)\n (levi = Fâ‚„, cuspidal = 36)\n (levi = Fâ‚„, cuspidal = 37)\n (levi = Fâ‚„â‚â‚ƒâ‚‚â‚=Bâ‚‚â‚â‚‚â‚â‚Î¦â‚Â², cuspidal = 6)\n (levi = Fâ‚„â‚â‚=Î¦â‚â´, cuspidal = 1)")
@test mytest("cuspidal_pairs(ComplexReflectionGroup(4),3)","5-element Vector{NamedTuple{(:levi, :cuspidal), Tuple{Spets{PRSG{Cyc{Rational{Int64}}, Int16}}, Int64}}}:\n (levi = Gâ‚„, cuspidal = 3)\n (levi = Gâ‚„, cuspidal = 6)\n (levi = Gâ‚„, cuspidal = 7)\n (levi = Gâ‚„, cuspidal = 10)\n (levi = Gâ‚„â‚â‚=Î¦â‚Î¦â€²â‚ƒ, cuspidal = 1)")
end
@testset "Ucl.jl" begin
@test mytest("UnipotentClasses(rootdatum(:sl,4))","UnipotentClasses(Aâ‚ƒ)\n1111<211<22<31<4\n   uâ”‚D-R dBu B-C          C(u) Aâ‚ƒ(Aâ‚ƒâ‚â‚=Î¦â‚Â³) Aâ‚(Aâ‚ƒâ‚â‚â‚ƒâ‚=Aâ‚Ã—Aâ‚Î¦â‚)/-1 .(Aâ‚ƒ)/Î¶â‚„\nâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n4   â”‚222   0 222         qÂ³.Zâ‚„          1:4                  -1:2    Î¶â‚„:Id\n31  â”‚202   1 22.    qâ´.Aâ‚â‚â‚=Î¦â‚        Id:31\n22  â”‚020   2 2.2      qâ´.Aâ‚.Zâ‚‚         2:22                 11:11\n211 â”‚101   3 2.. qâµ.Aâ‚‚â‚â‚â‚=Aâ‚Î¦â‚       Id:211\n1111â”‚000   6 ...            Aâ‚ƒ      Id:1111\n\n   uâ”‚.(Aâ‚ƒ)/-Î¶â‚„\nâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n4   â”‚   -Î¶â‚„:Id\n31  â”‚\n22  â”‚\n211 â”‚\n1111â”‚")
@test mytest("UnipotentClasses(coxgroup(:A,3))","UnipotentClasses(Aâ‚ƒ)\n1111<211<22<31<4\n   uâ”‚D-R dBu B-C          C(u) Aâ‚ƒ(Aâ‚ƒâ‚â‚=Î¦â‚Â³)\nâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n4   â”‚222   0 222            qÂ³         Id:4\n31  â”‚202   1 22.    qâ´.Aâ‚â‚â‚=Î¦â‚        Id:31\n22  â”‚020   2 2.2         qâ´.Aâ‚        Id:22\n211 â”‚101   3 2.. qâµ.Aâ‚‚â‚â‚â‚=Aâ‚Î¦â‚       Id:211\n1111â”‚000   6 ...            Aâ‚ƒ      Id:1111")
@test mytest("UnipotentClasses(coxgroup(:G,2))","UnipotentClasses(Gâ‚‚)\n1<Aâ‚<AÌƒâ‚<Gâ‚‚(aâ‚)<Gâ‚‚\n     uâ”‚D-R dBu B-C  C(u)    Gâ‚‚(Gâ‚‚â‚â‚=Î¦â‚Â²)  .(Gâ‚‚)\nâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nGâ‚‚    â”‚ 22   0  22    qÂ²         Id:Ï†â‚â€šâ‚€\nGâ‚‚(aâ‚)â”‚ 20   1  20 qâ´.Sâ‚ƒ 21:Ï†â€²â‚â€šâ‚ƒ 3:Ï†â‚‚â€šâ‚ 111:Id\nAÌƒâ‚    â”‚ 01   2  .2 qÂ³.Aâ‚         Id:Ï†â‚‚â€šâ‚‚\nAâ‚    â”‚ 10   3  2. qâµ.Aâ‚        Id:Ï†â€³â‚â€šâ‚ƒ\n1     â”‚ 00   6  ..    Gâ‚‚         Id:Ï†â‚â€šâ‚†")
@test mytest("UnipotentClasses(coxgroup(:G,2),3)","UnipotentClasses(Gâ‚‚)\n1<Aâ‚,(AÌƒâ‚)â‚ƒ<AÌƒâ‚<Gâ‚‚(aâ‚)<Gâ‚‚\n     uâ”‚dBu B-C  C(u) Gâ‚‚(Gâ‚‚â‚â‚=Î¦â‚Â²) .(Gâ‚‚) .(Gâ‚‚)  .(Gâ‚‚)\nâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nGâ‚‚    â”‚  0  22 qÂ².Zâ‚ƒ       1:Ï†â‚â€šâ‚€       Î¶â‚ƒ:Id Î¶â‚ƒÂ²:Id\nGâ‚‚(aâ‚)â”‚  1  20 qâ´.Zâ‚‚       2:Ï†â‚‚â€šâ‚ 11:Id\nAÌƒâ‚    â”‚  2  .2    qâ¶      Id:Ï†â‚‚â€šâ‚‚\nAâ‚    â”‚  3  2. qâµ.Aâ‚     Id:Ï†â€³â‚â€šâ‚ƒ\n(AÌƒâ‚)â‚ƒ â”‚  3  ?? qâµ.Aâ‚     Id:Ï†â€²â‚â€šâ‚ƒ\n1     â”‚  6  ..    Gâ‚‚      Id:Ï†â‚â€šâ‚†")
@test mytest("uc=UnipotentClasses(coxgroup(:G,2));","nothing")
@test mytest("t=ICCTable(uc)","Coefficients of Xáµª on Yáµ© for Gâ‚‚\n      â”‚Gâ‚‚ Gâ‚‚(aâ‚)â½Â²Â¹â¾ Gâ‚‚(aâ‚) AÌƒâ‚ Aâ‚  1\nâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nXÏ†â‚â€šâ‚€ â”‚ 1          0      1  1  1  1\nXÏ†â€²â‚â€šâ‚ƒâ”‚ 0          1      0  1  0 qÂ²\nXÏ†â‚‚â€šâ‚ â”‚ 0          0      1  1  1 Î¦â‚ˆ\nXÏ†â‚‚â€šâ‚‚ â”‚ 0          0      0  1  1 Î¦â‚„\nXÏ†â€³â‚â€šâ‚ƒâ”‚ 0          0      0  0  1  1\nXÏ†â‚â€šâ‚† â”‚ 0          0      0  0  0  1")
@test mytest("W=coxgroup(:F,4)","Fâ‚„")
@test mytest("H=reflection_subgroup(W,[1,3])","Fâ‚„â‚â‚â‚ƒâ‚=Aâ‚Ã—AÌƒâ‚Î¦â‚Â²")
@test mytest("Ucl.induced_linear_form(W,H,[2,2])","4-element Vector{Int64}:\n 0\n 1\n 0\n 0")
@test mytest("uc=UnipotentClasses(W);","nothing")
@test mytest("uc.classes[4].prop","Dict{Symbol, Any} with 7 entries:\n  :dynkin     => [0, 1, 0, 0]\n  :dimred     => 6\n  :red        => Aâ‚Ã—Aâ‚\n  :Au         => .\n  :balacarter => [1, 3]\n  :dimunip    => 18\n  :AuAction   => Aâ‚Ã—Aâ‚")
@test mytest("uc.classes[4]","UnipotentClass(Aâ‚+AÌƒâ‚)")
@test mytest("W=rootdatum(:sl,4)","Aâ‚ƒ")
@test mytest("uc=UnipotentClasses(W);","nothing")
@test mytest("uc.classes","5-element Vector{Gapjm.Ucl.UnipotentClass}:\n UnipotentClass(1111)\n UnipotentClass(211)\n UnipotentClass(22)\n UnipotentClass(31)\n UnipotentClass(4)")
@test mytest("t=ICCTable(uc)","Coefficients of Xáµª on Yáµ© for Aâ‚ƒ\n     â”‚4 31 22 211 1111\nâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nX4   â”‚1  1  1   1    1\nX31  â”‚0  1  1  Î¦â‚‚   Î¦â‚ƒ\nX22  â”‚0  0  1   1   Î¦â‚„\nX211 â”‚0  0  0   1   Î¦â‚ƒ\nX1111â”‚0  0  0   0    1")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("special_pieces(UnipotentClasses(W))","3-element Vector{Vector{Int64}}:\n [1]\n [4, 3, 2]\n [5]")
@test mytest("special_pieces(UnipotentClasses(W,3))","3-element Vector{Vector{Int64}}:\n [1]\n [4, 3, 2, 6]\n [5]")
end
@testset "Urad.jl" begin
@test mytest("W=coxgroup(:E,6)","Eâ‚†")
@test mytest("U=UnipotentGroup(W)","UnipotentGroup(Eâ‚†)")
@test mytest("U(2=>4)","u2(4)")
@test mytest("U(2)^4","u2(4)")
@test mytest("U(2=>4)*U(4=>5)","u2(4)u4(5)")
@test mytest("U(2=>4,4=>5)","u2(4)u4(5)")
@test mytest("U(4=>5,2=>4)","u2(4)u4(5)u8(-20)")
@test mytest("W=coxgroup(:E,8);U=UnipotentGroup(W)","UnipotentGroup(Eâ‚ˆ)")
@test mytest("u=U(map(i->i=>Z(2)*Mvp(Symbol(\"x_\",i)),1:8)...)","u1(1â‚‚xâ‚)u2(1â‚‚xâ‚‚)u3(1â‚‚xâ‚ƒ)u4(1â‚‚xâ‚„)u5(1â‚‚xâ‚…)u6(1â‚‚xâ‚†)u7(1â‚‚xâ‚‡)u8(1â‚‚xâ‚ˆ)")
@test mytest("u^32","()")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("U=UnipotentGroup(W);@Mvp x,y","nothing")
@test mytest("u=U(1=>x,3=>y)","u1(x)u3(y)")
@test mytest("u^W(2,1)","u4(y)u5(x)")
@test mytest("s=SemisimpleElement(W,[E(3),2])","SemisimpleElement{Cyc{Int64}}: <Î¶â‚ƒ,2>")
@test mytest("u^s","u1(Î¶â‚ƒx)u3(2Î¶â‚ƒy)")
@test mytest("u^U(2)","u1(x)u3(x+y)u4(-x-2y)u5(x+3y)u6(xÂ²+3xy+3yÂ²)")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("U=UnipotentGroup(W)","UnipotentGroup(Gâ‚‚)")
@test mytest("U.specialPairs","10-element Vector{Vector{Int64}}:\n [1, 2, 3]\n [2, 3, 4]\n [2, 4, 5]\n [1, 5, 6]\n [3, 4, 6]\n [2, 1, 3]\n [3, 2, 4]\n [4, 2, 5]\n [5, 1, 6]\n [4, 3, 6]")
@test mytest("U.N","10-element Vector{Int64}:\n  1\n  2\n  3\n  1\n  3\n -1\n -2\n -3\n -1\n -3")
@test mytest("U.commutatorConstants","10-element Vector{Vector{Vector{Int64}}}:\n [[1, 1, 3, 1], [1, 2, 4, -1], [1, 3, 5, 1], [2, 3, 6, 2]]\n [[1, 1, 4, 2], [2, 1, 5, 3], [1, 2, 6, -3]]\n [[1, 1, 5, 3]]\n [[1, 1, 6, 1]]\n [[1, 1, 6, 3]]\n [[1, 1, 3, -1], [2, 1, 4, -1], [3, 1, 5, -1], [3, 2, 6, -1]]\n [[1, 1, 4, -2], [2, 1, 6, -3], [1, 2, 5, 3]]\n [[1, 1, 5, -3]]\n [[1, 1, 6, -1]]\n [[1, 1, 6, -3]]")
@test mytest("U=UnipotentGroup(coxgroup(:G,2))","UnipotentGroup(Gâ‚‚)")
@test mytest("l=norm(U,[2=>4,1=>2])","6-element Vector{Pair{Int64, Int64}}:\n 1 => 2\n 2 => 4\n 3 => -8\n 4 => 32\n 5 => -128\n 6 => 512")
@test mytest("norm(U,l,6:-1:1)","2-element Vector{Pair{Int64, Int64}}:\n 2 => 4\n 1 => 2")
@test mytest("U=UnipotentGroup(coxgroup(:G,2))","UnipotentGroup(Gâ‚‚)")
@test mytest("U(2)","u2(1)")
@test mytest("U(1=>2,2=>4)","u1(2)u2(4)")
@test mytest("U(2=>4,1=>2)","u1(2)u2(4)u3(-8)u4(32)u5(-128)u6(512)")
@test mytest("U=UnipotentGroup(coxgroup(:G,2));@Mvp x,y","nothing")
@test mytest("u=U(2=>y,1=>x)","u1(x)u2(y)u3(-xy)u4(xyÂ²)u5(-xyÂ³)u6(2xÂ²yÂ³)")
@test mytest("abelianpart(u)","u1(x)u2(y)")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("U=UnipotentGroup(W);@Mvp x,y","nothing")
@test mytest("u=U(2=>y,1=>x)","u1(x)u2(y)u3(-xy)u4(xyÂ²)u5(-xyÂ³)u6(2xÂ²yÂ³)")
@test mytest("decompose(W(1),u)","2-element Vector{UnipotentElement{Mvp{Int64, Int64}}}:\n u1(x)\n u2(y)u3(-xy)u4(xyÂ²)u5(-xyÂ³)u6(2xÂ²yÂ³)")
@test mytest("decompose(W(2),u)","2-element Vector{UnipotentElement{Mvp{Int64, Int64}}}:\n u2(y)\n u1(x)")
end
@testset "Weyl.jl" begin
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("cartan(W)","4Ã—4 Matrix{Int64}:\n  2   0  -1   0\n  0   2  -1   0\n -1  -1   2  -1\n  0   0  -1   2")
@test mytest("W=coxgroup(:A,2)*coxgroup(:B,2)","Aâ‚‚Ã—Bâ‚‚")
@test mytest("cartan(W)","4Ã—4 Matrix{Int64}:\n  2  -1   0   0\n -1   2   0   0\n  0   0   2  -2\n  0   0  -1   2")
@test mytest("W=coxgroup(:D,4)","Dâ‚„")
@test mytest("p=W(1,3,2,1,3)","(1,14,13,2)(3,17,8,18)(4,12)(5,20,6,15)(7,10,11,9)(16,24)(19,22,23,21)")
@test mytest("word(W,p)","5-element Vector{Int64}:\n 1\n 3\n 1\n 2\n 3")
@test mytest("cartan([1 3;3 1])","2Ã—2 Matrix{Cyc{Int64}}:\n  2  -1\n -1   2")
@test mytest("cartan(:F,4)","4Ã—4 Matrix{Int64}:\n  2  -1   0   0\n -1   2  -1   0\n  0  -2   2  -1\n  0   0  -1   2")
@test mytest("cartan(:I,2,5)","2Ã—2 Matrix{Cyc{Int64}}:\n       2  Î¶â‚…Â²+Î¶â‚…Â³\n Î¶â‚…Â²+Î¶â‚…Â³        2")
@test mytest("cartan(:Bsym,2)","2Ã—2 Matrix{Cyc{Int64}}:\n   2  -âˆš2\n -âˆš2    2")
@test mytest("Weyl.two_tree(cartan(:A,4))","4-element Vector{Int64}:\n 1\n 2\n 3\n 4")
@test mytest("Weyl.two_tree(cartan(:E,8))","(4, [2], [3, 1], [5, 6, 7, 8])")
@test mytest("W=coxgroup(:A,3)","Aâ‚ƒ")
@test mytest("inversions(W,W(1,2,1))","3-element Vector{Int64}:\n 1\n 2\n 4")
@test mytest("inversions(W,[1,2,1])","3-element Vector{Int16}:\n 1\n 4\n 2")
@test mytest("W=coxgroup(:A,2)","Aâ‚‚")
@test mytest("map(N->with_inversions(W,N),combinations(1:nref(W)))","8-element Vector{Union{Nothing, Perm{Int16}}}:\n ()\n (1,4)(2,3)(5,6)\n (1,3)(2,5)(4,6)\n nothing\n nothing\n (1,6,2)(3,5,4)\n (1,2,6)(3,4,5)\n (1,5)(2,4)(3,6)")
@test mytest("W=coxgroup(:E,6)","Eâ‚†")
@test mytest("R=reflection_subgroup(W,[20,30,19,22])","Eâ‚†â‚â‚â‚‰â€šâ‚â€šâ‚‰â€šâ‚‚â‚€â‚=Aâ‚„â‚â‚ƒâ‚â‚‚â‚„â‚Î¦â‚Â²")
@test mytest("p=standard_parabolic(W,R)","(1,4,49,12,10)(2,54,62,3,19)(5,17,43,60,9)(6,21,34,36,20)(7,24,45,41,53)(8,65,50,15,22)(11,32,31,27,28)(13,48,46,37,40)(14,51,58,44,29)(16,23,35,33,30)(18,26,39,55,38)(42,57,70,72,56)(47,68,67,63,64)(52,59,71,69,66)")
@test mytest("reflection_subgroup(W,[20,30,19,22].^p)","Eâ‚†â‚â‚‚â‚„â‚…â‚†â‚=Aâ‚„Î¦â‚Â²")
@test mytest("R=reflection_subgroup(W,[1,2,3,5,6,35])","Eâ‚†â‚â‚â€šâ‚ƒâ€šâ‚‚â€šâ‚ƒâ‚…â€šâ‚…â€šâ‚†â‚=Aâ‚‚â‚â‚â‚ƒâ‚Ã—Aâ‚‚â‚â‚‚â‚†â‚Ã—Aâ‚‚â‚â‚„â‚…â‚")
@test mytest("standard_parabolic(W,R)","nothing")
@test mytest("W=coxgroup(:E,8)","Eâ‚ˆ")
@test mytest("badprimes(W)","3-element Vector{Int64}:\n 5\n 2\n 3")
@test mytest("W=coxgroup(:A,2)","Aâ‚‚")
@test mytest("w=longest(W)","(1,5)(2,4)(3,6)")
@test mytest("describe_involution(W,w)","1-element Vector{Int64}:\n 3")
@test mytest("w==longest(reflection_subgroup(W,[3]))","true")
@test mytest("torus(3)","Î¦â‚Â³")
@test mytest("W=coxgroup(:G,2)","Gâ‚‚")
@test mytest("Diagram(W)","Oâ‡› O\n1  2")
@test mytest("H=reflection_subgroup(W,[2,6])","Gâ‚‚â‚â‚‚â‚†â‚=AÌƒâ‚Ã—Aâ‚")
@test mytest("Diagram(H)","O\n1\nO\n2")
@test mytest("inclusion(H)","4-element Vector{Int64}:\n  2\n  6\n  8\n 12")
@test mytest("restriction(H)","12-element Vector{Int64}:\n 0\n 1\n 0\n 0\n 0\n 2\n 0\n 3\n 0\n 0\n 0\n 4")
@test mytest("word(W,H(2))","5-element Vector{Int64}:\n 1\n 2\n 1\n 2\n 1")
@test mytest("elH=word.(Ref(H),elements(H))","4-element Vector{Vector{Int64}}:\n []\n [2]\n [1]\n [1, 2]")
@test mytest("elW=word.(Ref(W),elements(H))","4-element Vector{Vector{Int64}}:\n []\n [1, 2, 1, 2, 1]\n [2]\n [1, 2, 1, 2, 1, 2]")
@test mytest("map(w->H(w...),elH)==map(w->W(w...),elW)","true")
end
@testset "cheviesupport.jl" begin
@test mytest("CycPol([3,-5,6,3//7])","3qâ»âµÎ¦â‚†(q-Î¶â‚‡Â³)")
end
@testset "dSeries.jl" begin
@test mytest("W=rootdatum(\"3D4\")","Â³Dâ‚„")
@test mytest("l=cuspidal_pairs(W,3)","2-element Vector{NamedTuple{(:levi, :cuspidal), Tuple{Spets{FiniteCoxeterSubGroup{Perm{Int16},Int64}}, Int64}}}:\n (levi = Â³Dâ‚„, cuspidal = 8)\n (levi = Dâ‚„â‚â‚=Î¦â‚ƒÂ², cuspidal = 1)")
@test mytest("Series(W,l[2]...,3)","Î¶â‚ƒ-series R^{Â³Dâ‚„}_{Dâ‚„â‚â‚=Î¦â‚ƒÂ²}(Î»==.)  H_G(L,Î»)==hecke(Gâ‚„,Mvp{Cyc{Int64}, Int64}[Î¶â‚ƒqÂ², Î¶â‚ƒ, Î¶â‚ƒq])\n â”‚    Î³áµ©    Ï†  Îµ family #\nâ”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1â”‚  Ï†â‚â€šâ‚€ Ï†â‚â€šâ‚€  1        1\n2â”‚  Ï†â‚â€šâ‚† Ï†â‚â€šâ‚„  1        2\n3â”‚  Ï†â‚‚â€šâ‚‚ Ï†â‚â€šâ‚ˆ -1        5\n6â”‚ Ï†â€²â‚â€šâ‚ƒ Ï†â‚‚â€šâ‚…  1        4\n5â”‚ Ï†â€³â‚â€šâ‚ƒ Ï†â‚‚â€šâ‚ƒ -1        3\n7â”‚  Ï†â‚‚â€šâ‚ Ï†â‚‚â€šâ‚ -1        5\n4â”‚Â³Dâ‚„[1] Ï†â‚ƒâ€šâ‚‚  1        5")
@test mytest("W=ComplexReflectionGroup(4)","Gâ‚„")
@test mytest("l=cuspidal_pairs(W,3)","5-element Vector{NamedTuple{(:levi, :cuspidal), Tuple{Spets{PRSG{Cyc{Rational{Int64}}, Int16}}, Int64}}}:\n (levi = Gâ‚„, cuspidal = 3)\n (levi = Gâ‚„, cuspidal = 6)\n (levi = Gâ‚„, cuspidal = 7)\n (levi = Gâ‚„, cuspidal = 10)\n (levi = Gâ‚„â‚â‚=Î¦â‚Î¦â€²â‚ƒ, cuspidal = 1)")
@test mytest("Series(W,l[5]...,3)","Î¶â‚ƒ-series R^{Gâ‚„}_{Gâ‚„â‚â‚=Î¦â‚Î¦â€²â‚ƒ}(Î»==.)  W_G(L,Î»)==Zâ‚†\n â”‚   Î³áµ© Ï†(mod 3)  Îµ parameter family #\nâ”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1â”‚ Ï†â‚â€šâ‚€        1  1      Î¶â‚ƒqÂ²        1\n5â”‚ Ï†â‚‚â€šâ‚ƒ     -Î¶â‚ƒÂ²  1      -Î¶â‚ƒq        2\n2â”‚ Ï†â‚â€šâ‚„       Î¶â‚ƒ -1        Î¶â‚ƒ        4\n8â”‚ Zâ‚ƒ:2       -1 -1     -Î¶â‚ƒÂ²q        2\n9â”‚Zâ‚ƒ:11      Î¶â‚ƒÂ² -1       Î¶â‚ƒÂ²        4\n4â”‚ Ï†â‚‚â€šâ‚…      -Î¶â‚ƒ -1       -Î¶â‚ƒ        4")
@test mytest("cuspidal_pairs(W,Root1(;r=2//3))","5-element Vector{NamedTuple{(:levi, :cuspidal), Tuple{Spets{PRSG{Cyc{Rational{Int64}}, Int16}}, Int64}}}:\n (levi = Gâ‚„, cuspidal = 2)\n (levi = Gâ‚„, cuspidal = 5)\n (levi = Gâ‚„, cuspidal = 7)\n (levi = Gâ‚„, cuspidal = 10)\n (levi = Gâ‚„â‚â‚=Î¦â‚Î¦â€³â‚ƒ, cuspidal = 1)")
@test mytest("dSeries.ennola(rootdatum(\"3D4\"))","SPerm{Int64}: (3,-4)(5,-5)(6,-6)(7,-8)")
@test mytest("dSeries.ennola(ComplexReflectionGroup(14))","SPerm{Int64}: (2,43,-14,16,41,34)(3,35,40,18,-11,42)(4,-37,25,-17,-26,-36)(5,-6,-79)(7,-7)(8,-74)(9,-73)(10,-52,13,31,-50,29)(12,53,15,32,-51,-30)(19,71,70,21,67,68,20,69,72)(22,-39,27,-33,-28,-38)(23,24,-66,-23,-24,66)(44,46,49,-44,-46,-49)(45,48,47,-45,-48,-47)(54,-63,-55,-57,62,-56)(58,-65,-59,-61,64,-60)(75,-77)(76,-76)(78,-78)")
@test mytest("W=ComplexReflectionGroup(4)","Gâ‚„")
@test mytest("s=Series(W,3,1)[1]","Î¶â‚ƒ-series R^{Gâ‚„}_{Gâ‚„â‚â‚=Î¦â‚Î¦â€²â‚ƒ}(Î»==.)  W_G(L,Î»)==Zâ‚†\n â”‚   Î³áµ© Ï†(mod 3)  Îµ parameter family #\nâ”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n1â”‚ Ï†â‚â€šâ‚€        1  1      Î¶â‚ƒqÂ²        1\n5â”‚ Ï†â‚‚â€šâ‚ƒ     -Î¶â‚ƒÂ²  1      -Î¶â‚ƒq        2\n2â”‚ Ï†â‚â€šâ‚„       Î¶â‚ƒ -1        Î¶â‚ƒ        4\n8â”‚ Zâ‚ƒ:2       -1 -1     -Î¶â‚ƒÂ²q        2\n9â”‚Zâ‚ƒ:11      Î¶â‚ƒÂ² -1       Î¶â‚ƒÂ²        4\n4â”‚ Ï†â‚‚â€šâ‚…      -Î¶â‚ƒ -1       -Î¶â‚ƒ        4")
@test mytest("s.spets","Gâ‚„")
@test mytest("s.levi","Gâ‚„â‚â‚=Î¦â‚Î¦â€²â‚ƒ")
@test mytest("s.cuspidal","1")
@test mytest("s.d","Root1: Î¶â‚ƒ")
@test mytest("hecke(s)","hecke(Gâ‚†â€šâ‚â€šâ‚,Mvp{Cyc{Int64}, Int64}[Î¶â‚ƒqÂ², -Î¶â‚ƒq, Î¶â‚ƒ, -Î¶â‚ƒÂ²q, Î¶â‚ƒÂ², -Î¶â‚ƒ])")
@test mytest("degree(s)","Î¶â‚ƒÎ¦â‚Î¦â‚‚Â²Î¦â€³â‚ƒÎ¦â‚„Î¦â‚†")
@test mytest("dSeries.RLG(s)","[Gâ‚„]:<Ï†â‚â€šâ‚€>-<Ï†â‚â€šâ‚„>-<Ï†â‚‚â€šâ‚…>+<Ï†â‚‚â€šâ‚ƒ>-<Zâ‚ƒ:2>-<Zâ‚ƒ:11>")
@test mytest("dSeries.char_numbers(s)","6-element Vector{Int64}:\n 1\n 5\n 2\n 8\n 9\n 4")
@test mytest("dSeries.eps(s)","6-element Vector{Int64}:\n  1\n  1\n -1\n -1\n -1\n -1")
@test mytest("relative_group(s)","Gâ‚†â€šâ‚â€šâ‚")
end
@testset "mvptools.jl" begin
@test mytest("Pol(:q)","Pol{Int64}: q")
@test mytest("Mvp(q^2+q)","Mvp{Int64}: qÂ²+q")
@test mytest("@Mvp x,y","nothing")
@test mytest("factor(x^2-y^2+x+3y-2)","2-element Vector{Mvp{Int64, Int64}}:\n x-y+2\n x+y-1")
@test mytest("factor(x^2+x+1)","2-element Vector{Mvp{Cyc{Int64}, Int64}}:\n x-Î¶â‚ƒ\n x-Î¶â‚ƒÂ²")
@test mytest("factor(x*y-1)","1-element Vector{Mvp{Int64, Int64}}:\n xy-1")
@test mytest("W=CoxSym(5)","ğ”– â‚…")
@test mytest("pblocks(W,2)","2-element Vector{Vector{Int64}}:\n [1, 3, 4, 5, 7]\n [2, 6]")
@test mytest("pblocks(W,3)","3-element Vector{Vector{Int64}}:\n [1, 5, 6]\n [2, 3, 7]\n [4]")
@test mytest("pblocks(W,7)","7-element Vector{Vector{Int64}}:\n [1]\n [2]\n [3]\n [4]\n [5]\n [6]\n [7]")
end
end
